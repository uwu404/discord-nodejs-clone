(this["webpackJsonpreact-chat-app"]=this["webpackJsonpreact-chat-app"]||[]).push([[0],{100:function(e,t,n){},101:function(e,t,n){"use strict";n.r(t);var c=n(1),s=n.n(c),a=n(41),r=n.n(a),i=n(2),o=(n(49),n(3)),l=n.n(o),u=n(5),d=(n(51),n(4)),j=n(6),h=n(13),m=n(14),b=(n(52),{message:function(e,t){e((function(e){return[].concat(Object(j.a)(e),[t])}))},memberOnline:function(e,t){e((function(e){var n=Object(j.a)(e),c=n.find((function(e){return e._id===t.user}));return c&&(c.online=t.online),n}))},memberUpdate:function(e,t,n){t((function(e){var t=Object(j.a)(e);return t.forEach((function(e){if("".concat(n._id)===e.author._id){var t=Object.assign(e.author,n);e.author=t}})),t})),e((function(e){var t=Object(j.a)(e);return t.forEach((function(e){"".concat(n._id)===e._id&&(e=Object.assign(e,n))})),t}))},messageEdit:function(e,t){e((function(e){var n=Object(j.a)(e),c=n.find((function(e){return e._id===t._id}));return n[n.indexOf(c)]=Object.assign(c,t),n}))},messageDelete:function(e,t){e((function(e){return Object(j.a)(e).filter((function(e){return e._id!==t._id}))}))}}),f={channels:{},serverMembers:{},logs:[],at:function(e,t){var n=this;return function(c){var s=Object.keys(n.channels);if(s.length>9&&delete n.channels[s[Math.floor(Math.random()*s.length)]],"function"===typeof c)return n[e][t]=c(n[e][t]||[]);n[e][t]=c}},init:function(){var e=this;_e.on("message",(function(e){var t=f.at("channels",e.channel);b.message(t,e)})),_e.on("messageDelete",(function(e){var t=f.at("channels",e.channel);b.messageDelete(t,e)})),_e.on("messageEdit",(function(e){var t=f.at("channels",e.channel);b.messageEdit(t,e)})),_e.on("memberUpdate",(function(t){for(var n in e.channels){var c=f.at("channels",n);b.memberUpdate((function(){}),c,t)}for(var s in e.serverMembers){var a=f.at("serverMembers",s);b.memberUpdate(a,(function(){}),t)}})),_e.on("disconnect",this.clear)},clear:function(){for(var e in this.channels)delete this.channels[e]}},O=f,v=n(0),x=function(){function e(t,n){for(var c in Object(h.a)(this,e),t)this[c]=t[c];this.id=t._id,this.me=n}return Object(m.a)(e,[{key:"displayIcon",value:function(e,t){return this.icon?"".concat(d.a+this.icon,"?").concat(e?"width=".concat(e,"&height=").concat(t||e):""):null}},{key:"toJSX",value:function(e,t){return Object(v.jsxs)("div",{className:"server-block ".concat(e&&"clicked"),children:[Object(v.jsx)("div",{title:this.name,tabIndex:"0",role:"button",className:"server",children:this.icon?Object(v.jsx)("img",{width:"48",height:"48",onClick:t,alt:"icon",src:this.displayIcon(100),className:"server-icon"}):Object(v.jsx)("div",{onClick:t,style:{width:48,height:48},className:"server-icon default-no-img-div",children:this.name[0]})}),Object(v.jsx)("div",{className:"server-marker"})]},this.id)}},{key:"fetchMembers",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!O.serverMembers[this.id]){e.next=2;break}return e.abrupt("return",O.serverMembers[this.id]);case 2:return e.next=4,fetch("".concat(d.a,"servers/").concat(this.id,"/members"),{headers:{Authorization:this.me.token}}).then((function(e){return e.json()})).catch((function(){return[]}));case 4:return t=e.sent,O.at("serverMembers",this.id)(t),e.abrupt("return",t);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}],[{key:"LoadServers",value:function(t){var n=t.servers,c=t.click,s=t.isHome,a=t.me,r=t.index;return n.map((function(t,n){var i=new e(t,a);return i.toJSX(r===n&&!s,(function(){c(i)}))})).reverse()}}]),e}(),p=(n(54),n(55),n(42)),g=(n(56),n(7)),N=function(e){return Object(v.jsx)("svg",Object(g.a)(Object(g.a)({},e),{},{fill:"currentColor",width:e.size,height:e.size,version:"1.1",id:"Capa_1",x:"0px",y:"0px",viewBox:"0 0 60.364 60.364",children:Object(v.jsx)("g",{children:Object(v.jsx)("path",{d:"M54.454,23.18l-18.609-0.002L35.844,5.91C35.845,2.646,33.198,0,29.934,0c-3.263,0-5.909,2.646-5.909,5.91v17.269\r L5.91,23.178C2.646,23.179,0,25.825,0,29.088c0.002,3.264,2.646,5.909,5.91,5.909h18.115v19.457c0,3.267,2.646,5.91,5.91,5.91\r c3.264,0,5.909-2.646,5.91-5.908V34.997h18.611c3.262,0,5.908-2.645,5.908-5.907C60.367,25.824,57.718,23.178,54.454,23.18z"})})}))},w=(n(57),function(){return Object(v.jsxs)("div",{className:"skeleton",children:[Object(v.jsx)("div",{className:"skeleton-pfp"}),Object(v.jsx)("div",{style:{width:Math.floor(100*Math.random())+100},className:"skeleton-username"}),Object(v.jsxs)("div",{children:[Object(v.jsx)("div",{style:{width:"calc(20% - 70px/4)"},className:"skeleton-content-1 sl"}),Object(v.jsx)("div",{style:{width:"calc(30% - 70px/4)"},className:"skeleton-content-2 sl"}),Object(v.jsx)("div",{style:{width:"calc(15% - 70px/4)"},className:"skeleton-content-3 sl"}),Object(v.jsx)("div",{style:{width:"calc(25% - 70px/4)"},className:"skeleton-content-4 sl"})]}),Math.random()<.3&&Object(v.jsxs)("div",{className:"random-sl",children:[Object(v.jsx)("div",{style:{width:"calc(25% - 70px/4)",display:"inline-block"},className:"skeleton-content-1 sl"}),Object(v.jsx)("div",{style:{width:"calc(20% - 70px/4)",display:"inline-block"},className:"skeleton-content-2 sl"}),Object(v.jsx)("div",{style:{width:"calc(30% - 70px/4)",display:"inline-block"},className:"skeleton-content-3 sl"}),Object(v.jsx)("div",{style:{width:"calc(15% - 70px/4)",display:"inline-block"},className:"skeleton-content-4 sl"})]}),Math.random()<.1&&Object(v.jsx)("div",{className:"skeleton-content-a"})]})});function y(){return Object(j.a)(Array(20)).map((function(e,t){return Object(v.jsx)(w,{},t)}))}var k=n(44),C=["renderId","placeholder","defaultValue","innerRef","onPaste","onKeyDown"],S=function(e,t){var n=0,c=document.createRange();c.setStart(e,0),c.collapse(!0);for(var s,a=[e],r=!1,i=!1;!i&&(s=a.pop());)if(3===s.nodeType){var o=n+s.length;!r&&t.start>=n&&t.start<=o&&(c.setStart(s,t.start-n),r=!0),r&&t.end>=n&&t.end<=o&&(c.setEnd(s,t.end-n),i=!0),n=o}else for(var l=s.childNodes.length;l--;)a.push(s.childNodes[l]);var u=window.getSelection();u.removeAllRanges(),u.addRange(c)},E=function e(t){var n;if(t)return"auto"===(null===(n=t.style)||void 0===n?void 0:n.overflowY)||t.scrollHeight>t.clientHeight?t:e(t.parentNode)},A=function(e){var t=e.renderId,n=e.placeholder,s=e.defaultValue,a=e.innerRef,r=e.onPaste,i=e.onKeyDown,o=Object(k.a)(e,C),l=Object(c.useRef)(),u=function(e,t){var n=function(e,t){var n=window.getSelection().getRangeAt(0),c=n.cloneRange();c.selectNodeContents(e),c.setEnd(n.startContainer,n.startOffset);var s="".concat(c).length;return{start:s+t.length,end:s+"".concat(n).length+t.length,pos:[s,"".concat(n).length+s]}}(e,t);e.textContent=e.textContent.slice(0,n.pos[0])+t+e.textContent.slice(n.pos[1]),S(e,n)},d=function(e){var t=E(e);t&&(t.scrollTop=t.scrollHeight)};return Object(c.useEffect)((function(){var e=l.current.lastChild;e.focus(),S(e,{start:e.textContent.length,end:e.textContent.length})}),[t]),Object(v.jsx)("div",Object(g.a)(Object(g.a)({ref:l,className:"not-input",onPaste:function(e){e.preventDefault();var t=e.clipboardData.getData("text");t&&u(e.target,t),null===r||void 0===r||r(e),d(e.target)},onDrop:function(e){e.preventDefault();var t=e.dataTransfer.getData("text/plain");e.target.textContent=e.target.textContent+t,S(e.target,{start:e.target.textContent.length-t.length,end:e.target.textContent.length}),d(e.target)},onKeyDown:function(e){"Backspace"===e.code&&e.target.textContent.length<=1&&(e.target.innerHTML=""),"z"===e.key&&e.ctrlKey&&!e.shiftKey||"Enter"===e.code&&e.shiftKey||(null===i||void 0===i||i(e),d(e.target))},role:"textbox"},o),{},{children:Object(v.jsx)("div",{ref:a,suppressContentEditableWarning:!0,placeholder:n,contentEditable:"true",className:"plain-text",children:s})}))},L=function(e){var t=e.width,n=e.height;return Object(v.jsx)("svg",{fill:"currentColor",width:t,height:n,x:"0px",y:"0px",viewBox:"0 0 512 512",children:Object(v.jsx)("g",{children:Object(v.jsx)("g",{children:Object(v.jsx)("path",{d:"M495.304,205.913h-45.519c-4.73-18.267-11.996-35.493-21.382-51.291l33.961-33.961c6.487-6.492,6.516-17.095,0-23.611\r L414.95,49.633c-6.521-6.521-17.093-6.521-23.613,0l-33.959,33.961c-15.797-9.385-33.024-16.649-51.291-21.382V16.696\r C306.087,7.477,298.572,0,289.391,0h-66.783c-9.18,0-16.696,7.477-16.696,16.696v45.517c-18.265,4.73-35.493,11.992-51.291,21.379\r l-33.959-33.959c-6.521-6.521-17.093-6.521-23.613,0L49.635,97.05c-6.521,6.52-6.52,17.089,0,23.611l33.961,33.961\r c-9.385,15.799-16.651,33.024-21.382,51.291H16.696C7.515,205.913,0,213.39,0,222.609v66.783c0,9.214,7.482,16.693,16.696,16.693\r h45.519c4.73,18.267,11.996,35.493,21.382,51.291l-33.961,33.961c-6.521,6.52-6.52,17.089,0,23.611l47.415,47.417\r c6.527,6.527,17.084,6.525,23.613,0l33.959-33.959c15.797,9.387,33.026,16.647,51.291,21.379v45.519\r c0,9.214,7.482,16.696,16.696,16.696h66.783c9.157,0,16.696-7.463,16.696-16.696v-45.519c18.265-4.73,35.493-11.992,51.291-21.379\r l33.959,33.959c6.527,6.527,17.084,6.525,23.613,0l47.415-47.417c6.487-6.492,6.516-17.095,0-23.611l-33.961-33.961\r c9.385-15.799,16.651-33.024,21.382-51.291h45.519c9.214,0,16.696-7.481,16.696-16.693v-66.783\r C512,213.447,504.54,205.913,495.304,205.913z M256,339.476c-46.08-0.029-83.449-37.396-83.478-83.476\r c0.029-46.082,37.398-83.449,83.478-83.478c46.08,0.029,83.449,37.396,83.478,83.478C339.449,302.08,302.08,339.448,256,339.476z"})})})})};var R={Out:function(e){var t=e.click,n=e.children,s=e.getEvent,a=Object(c.useRef)(null);return function(e,t,n){Object(c.useEffect)((function(){function c(c){if(e.current&&!e.current.contains(c.target)){if(n)return t(c);null===t||void 0===t||t()}}return document.addEventListener("mousedown",c),function(){document.removeEventListener("mousedown",c)}}),[e,t,n])}(a,t,s),Object(v.jsx)("div",{className:"outer-div",ref:a,children:n})},isScolled:function(e,t){t=t||document.body;var n=e.getBoundingClientRect(),c=n.top,s=n.bottom,a=n.height,r=t.getBoundingClientRect();return c<=r.top?r.top-c<=a:s-r.bottom<=a}},T=function(e){var t=Object(c.useState)(1===e.type?"taller":"bigger"),n=Object(i.a)(t,2),s=n[0],a=n[1],r=Object(c.useContext)(Fe).setView;return Object(v.jsx)("div",{className:"".concat(e.normal?"clear-div":"dark-div"," ").concat(s),children:Object(v.jsx)(R.Out,{click:function(){var t;a(1===e.type?"shorter":"smaller"),setTimeout((function(){return r()}),100),null===(t=e.quit)||void 0===t||t.call(e)},children:e.children})})},D=(n(58),function(){var e=Object(c.useContext)(Fe).user,t=new oe(e);return Object(v.jsx)(T,{normal:!0,type:1,children:Object(v.jsx)("div",{style:{width:220,left:84,bottom:62,transformOrigin:"bottom center"},className:"status-manager generic-menu animated-popup",children:Object(v.jsx)("div",{className:"current-status option",children:t.customStatus?t.customStatus:"Set a custom status"})})})}),M=function(){var e=Object(c.useContext)(Fe),t=e.user,n=e.setView,s=e.setShowSettings,a=new oe(t);return Object(v.jsxs)("footer",{className:"footer",children:[Object(v.jsxs)("div",{className:"icon-div",children:[Object(v.jsx)("img",{onClick:function(){return n(Object(v.jsx)(D,{}))},width:"32",height:"32",className:"my-pfp",src:a.displayAvatarURL(90,"false"),alt:"icon"}),Object(v.jsx)("div",{className:"status icon-status"})]}),Object(v.jsxs)("h5",{className:"my-username",children:[a.username,Object(v.jsx)("span",{children:a.tag})]}),Object(v.jsx)("div",{title:"User Settings",onClick:function(){return s(!0)},className:"settings-button",children:Object(v.jsx)(L,{width:17,height:17})})]})},I=function(e){var t=e.invite,n=e.code,s=e.onJoin,a=e.me,r=new x(t),o=a.servers.find((function(e){return e._id===r.id}))?"Joined":"Join",l=Object(c.useState)(o),u=Object(i.a)(l,2),j=u[0],h=u[1];return Object(v.jsxs)("div",{className:"message-invite",children:[Object(v.jsx)("img",{width:"40",height:"40",className:"server-invite-icon",src:r.displayIcon(57),alt:"icon"}),Object(v.jsxs)("div",{className:"name-and-members",children:[Object(v.jsx)("h4",{className:"server-invite-name",children:r.name}),Object(v.jsxs)("div",{className:"member-count",children:[t.members.length," member",1!==t.members.length&&"s"]})]}),Object(v.jsx)("button",{onClick:function(){"Joined"!==o&&"..."!==j&&(h("..."),fetch("".concat(d.a,"servers/").concat(n),{method:"POST",headers:{Authorization:a.token}}).then((function(e){return e.json()})).then((function(e){h("Joined"),s(e)})))},className:"server-invite-join",children:j})]})};var U=function(e){var t=e.size;return Object(v.jsxs)("svg",{width:t,height:t,viewBox:"0 0 24 24",children:[Object(v.jsx)("rect",{id:"view-box",width:"24",height:"24",fill:"currentColor",opacity:"0"}),Object(v.jsx)("path",{id:"Shape",d:"M12,1.5A1.5,1.5,0,1,1,13.5,3,1.5,1.5,0,0,1,12,1.5Zm-6,0A1.5,1.5,0,1,1,7.5,3,1.5,1.5,0,0,1,6,1.5Zm-6,0A1.5,1.5,0,1,1,1.5,3,1.5,1.5,0,0,1,0,1.5Z",transform:"translate(4.5 11)",fill:"currentColor"})]})},z=function(e){var t=e.message,n=e.onCancel;return Object(v.jsx)(T,{children:Object(v.jsxs)("div",{className:"dlt animated-popup",children:[Object(v.jsx)("h2",{className:"some-text",children:"Delete message"}),Object(v.jsx)("h4",{className:"dumb-question",children:"Are you sure you want to delete this message?"}),Object(v.jsx)("div",{className:"preview-message",children:Object(v.jsx)(V,{full:!0,message:t})}),Object(v.jsxs)("div",{className:"lower-section",children:[Object(v.jsx)("button",{onClick:n,className:"generic-button cancel",children:"Cancel"}),Object(v.jsx)("button",{className:"generic-button error",onClick:function(){t.delete(),n()},children:"Delete"})]})]})})},F=function(e){var t=e.style,n=e.message,s=e.clickOut,a=e.edit,r=Object(c.useContext)(Fe),o=r.user,l=r.setView,u=Object(c.useState)(t.top),d=Object(i.a)(u,2),j=d[0],h=d[1],m=Object(c.useRef)();Object(c.useLayoutEffect)((function(){var e=m.current.getBoundingClientRect();t.top>window.innerHeight-e.height-10&&h(window.innerHeight-e.height-10),t.top<10&&h(10)}),[t.top]);var b=function(){s(),l(Object(v.jsx)(z,{onCancel:function(){return l()},message:n}))};return Object(v.jsx)(R.Out,{click:s,children:Object(v.jsxs)("div",{ref:m,style:Object(g.a)(Object(g.a)({},t),{},{top:j}),className:"message-menu",children:[o._id===n.author.id&&Object(v.jsx)("div",{onClick:function(){s(),a(b)},className:"editor option",children:"Edit"}),Object(v.jsx)("div",{onClick:b,className:"deletor option",children:"Delete"}),Object(v.jsx)("div",{className:"option",onClick:function(){if("speechSynthesis"in window){var e=new SpeechSynthesisUtterance;e.text="".concat(n.author.username," said ").concat(n.content),speechSynthesis.speak(e)}s()},children:"Speak Message"}),Object(v.jsx)("div",{className:"option",onClick:function(){navigator.clipboard.writeText(n.id),s()},children:"Copy ID"})]})})},_=function(e){var t,n=e.message,s=Object(c.useContext)(Fe).setView,a=Object(c.useState)(Object(v.jsxs)("div",{className:"rotating",children:[Object(v.jsx)("div",{className:"rotating-div-1"}),Object(v.jsx)("div",{className:"rotating-div-2"})]})),r=Object(i.a)(a,2),o=r[0],l=r[1];return(null===(t=n.attachment)||void 0===t?void 0:t.URL)?Object(v.jsxs)("div",{className:"image-div",children:[o,Object(v.jsx)("img",{onLoad:function(){return l()},loading:"lazy",width:n.calculateImage.width,height:n.calculateImage.height,src:n.displayAttachmentURL,className:"message-attachment",alt:"attachment",onClick:function(){return s(Object(v.jsx)(T,{children:Object(v.jsx)("img",{className:"view-attachment animated-popup",src:d.a+n.attachment.URL,alt:"attachment"})}))}})]}):null},P=(n(59),function(e){var t=e.message,n=e.isBeingEdited,c=e.edit,s=e.input,a=e.setIsBeingEdited,r=e.edited;return n?Object(v.jsxs)("div",{className:"message-editor",children:[Object(v.jsx)("div",{style:{overflowY:"auto",maxHeight:"40vh"},className:"text-content",children:Object(v.jsx)(A,{defaultValue:t.content,onKeyDown:function(e){return"Enter"===e.code&&c(e)},innerRef:s,className:"message-edit not-input"})}),Object(v.jsxs)("div",{className:"editor-text",children:["escape to ",Object(v.jsx)("span",{onClick:function(){return a(!1)},children:"cancel"})," or enter to ",Object(v.jsx)("span",{onClick:c,children:"save"})," "]})]}):Object(v.jsxs)("span",{className:"text ".concat((t.unsent?"unsent-message ":" ")+(t.failed?"failed-tosend":"")),children:[t.content,r&&Object(v.jsx)("span",{title:new Date(t.updatedAt).toDateString(),className:"edited",children:"(edited)"})]})}),V=function(e){var t,n,s=e.message,a=e.full,r=Object(c.useState)(!1),o=Object(i.a)(r,2),d=o[0],j=o[1],h=Object(c.useState)(null),m=Object(i.a)(h,2),b=m[0],f=m[1],O=Object(c.useState)("false"),x=Object(i.a)(O,2),p=x[0],g=x[1],N=Object(c.useContext)(Fe).setView,w=Object(c.useRef)(),y=function(){j(!1),N.apply(void 0,arguments)},k=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!d){e.next=2;break}return e.abrupt("return",y());case 2:j(!0),n=t.target.getBoundingClientRect(),c={left:n.left+n.width+7<window.innerWidth-275?n.left+n.width+7:window.innerWidth-275,top:n.top-60},N(Object(v.jsx)(R.Out,{getEvent:!0,click:function(e){return e.target.id!=="avatar-".concat(s.id)&&y()},children:Object(v.jsx)(ae,{setView:y,user:s.author,server:s.server,style:c})}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(e){document.dispatchEvent(new KeyboardEvent("keydown",{code:"Escape"})),f((function(){return e}))},S=new Date(s.updatedAt).getTime()!==new Date(s.timestamp).getTime();return Object(c.useEffect)((function(){var e=function(e){"Escape"===e.code&&f(null)};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}),[s.author]),Object(v.jsxs)("div",{onMouseLeave:function(){return g("false")},onMouseOver:function(){return g(null)},id:s.id,className:"message-div ".concat(s.unsent?"unsent":""," ").concat((d||!!b)&&"clicked"),style:{marginTop:a?"0.4em":0},children:[a?Object(v.jsx)("img",{id:"avatar-".concat(s.id),onClick:k,width:"40",height:"40",className:"author-icon",src:s.author.displayAvatarURL(90,(null===(t=s.author.flags)||void 0===t?void 0:t.hasDynamicAvatar)?d||b?null:p:null),alt:"avatar"}):Object(v.jsxs)("span",{className:"timestamp",children:["".concat(s.timestamp.getHours()).padStart(2,"0"),":","".concat(s.timestamp.getMinutes()).padStart(2,"0")]}),Object(v.jsxs)("div",{className:"message-content",children:[a&&Object(v.jsxs)("span",{className:"author-name",children:[Object(v.jsx)("span",{onClick:k,className:"exact-author",children:s.author.username}),Object(v.jsx)("span",{className:"exact-time",children:s.createdAt})]}),Object(v.jsx)(P,{input:w,isBeingEdited:b,setIsBeingEdited:f,edited:S,edit:function(e){var t;if(!(null===(t=w.current)||void 0===t?void 0:t.innerText.trim()))return e.preventDefault(),b();w.current&&s.edit(w.current.innerText),f()},message:s}),Object(v.jsx)(_,{message:s}),(null===(n=s.invite)||void 0===n?void 0:n._id)&&Object(v.jsx)(I,{me:s.me,onJoin:function(e){return s.onJoin(e)},invite:s.invite,code:s.inviteCode}),Object(v.jsx)("div",{onClick:function(e){var t=e.target.getBoundingClientRect(),n={top:t.top,left:t.left,zIndex:4};N(Object(v.jsx)(F,{clickOut:function(){N(),j(!1)},edit:C,style:n,message:s})),j(!0)},tabIndex:"0",className:"message-params",children:Object(v.jsx)(U,{size:22})})]})]})},B=function(e){var t=e.messages,n=e.setMessages,c=e.me,a=e.onJoin,r=e.server;return t.map((function(e,i){var o,l=new le(Object.assign(e,{setMessages:n}),c,a,r),u=l.author.id===(null===(o=t[i-1])||void 0===o?void 0:o.author._id),d=l.timestamp.toDateString()!==new le(t[i-1]||l).timestamp.toDateString();return Object(v.jsxs)(s.a.Fragment,{children:[d&&!!i&&Object(v.jsxs)("div",{className:"new-day",children:[Object(v.jsx)("div",{}),Object(v.jsx)("span",{children:l.timestamp.toDateString()}),Object(v.jsx)("div",{})]}),Object(v.jsx)("li",{children:Object(v.jsx)(V,{full:!u||d,message:l})})]},l.id)}))},H=function(e){var t=e.size;return Object(v.jsx)("svg",{height:t,viewBox:"0 0 24 24",width:t,children:Object(v.jsx)("path",{d:"M11.03 8h3.94l1.06-4.24a1 1 0 1 1 1.94.48L17.03 8H20a1 1 0 0 1 0 2h-3.47l-1 4H18a1 1 0 1 1 0 2h-2.97l-1.06 4.25a1 1 0 1 1-1.94-.49l.94-3.76H9.03l-1.06 4.25a1 1 0 1 1-1.94-.49L6.97 16H4a1 1 0 0 1 0-2h3.47l1-4H6a1 1 0 0 1 0-2h2.97l1.06-4.24a1 1 0 1 1 1.94.48L11.03 8zm-.5 2l-1 4h3.94l1-4h-3.94z"})})},J=(n(60),function(e){var t=e.logs,n=e.click;return t.map((function(e){var t=new oe(e);return Object(v.jsxs)("li",{onClick:function(){return n(t)},className:"search-result",children:[Object(v.jsx)("img",{alt:t.username,src:t.displayAvatarURL(90),className:"icon-avatar",style:{width:20,height:20,borderRadius:"50%"}}),Object(v.jsx)("span",{children:t.username})]},t.id)}))}),q=function(e){return e.server.channels.map((function(e){var t=new he(e);return Object(v.jsxs)("li",{className:"search-result",children:[Object(v.jsx)(H,{size:20}),Object(v.jsx)("span",{children:t.name})]},t.id)}))},K=function(e){var t=e.filter,n=e.click,s=Object(c.useContext)(Fe),a=s.user,r=s.setServer;return a.servers.map((function(e){var s=new x(e,a);if(!s.name.includes(t))return null;return Object(v.jsxs)(c.Fragment,{children:[Object(v.jsx)(q,{server:s}),Object(v.jsxs)("li",{onClick:function(){n(),r(s)},className:"search-result",children:[Object(v.jsx)("img",{alt:s.name,src:s.displayIcon(100),className:"icon-avatar",style:{width:20,height:20,borderRadius:5}}),Object(v.jsx)("span",{children:s.name})]})]},s.id)}))},W=function(e){var t=e.logs,n=e.clickUser,s=Object(c.useState)(""),a=Object(i.a)(s,2),r=a[0],o=a[1],l=Object(c.useContext)(Fe).setView;return Object(v.jsx)(T,{children:Object(v.jsxs)("div",{className:"generic-popup find-conversation animated-popup",children:[Object(v.jsx)("input",{placeholder:"Where would you like to go?",onChange:function(e){return o(e.target.value)},className:"big-input"}),Object(v.jsx)("div",{className:"list",children:Object(v.jsxs)("ul",{children:[Object(v.jsx)(J,{click:function(e){l(),n(e)},logs:t.filter((function(e){return e.username.includes(r)}))}),Object(v.jsx)(K,{click:function(){return l()},filter:r})]})})]})})},Y=function(e,t,n,c,s,a){var r,i;"Enter"===e.code&&(null===(r=e.preventDefault)||void 0===r||r.call(e),(e.target.textContent.trim()||s.length)&&(!function(e,t,n,c,s){(null===s||void 0===s?void 0:s.length)&&(null===n||void 0===n||n([])),c((function(t){return[].concat(Object(j.a)(t),[e])})),t.send(e).then((function(t){var n,s=Object.assign(e,{_id:t.id,unsent:!1,invite:t.invite,content:t.content});(null===(n=t.attachment)||void 0===n?void 0:n.URL)&&(s.attachment=t.attachment),c((function(t){var n=Object(j.a)(t),c=n.find((function(t){return t._id===e._id}));return n[n.indexOf(c)]=s,n})),s.author.online=t.author.online})).catch((function(t){console.error(t),c((function(t){var n=Object(j.a)(t);return n.find((function(t){return t._id===e._id})).failed=!0,n}))}))}({author:t,content:e.target.innerText.trim(),_id:"m".concat(Date.now()),createdAt:Date.now(),unsent:!0,channel:n.id,updatedAt:Date.now(),attachment:null===s||void 0===s||null===(i=s[0])||void 0===i?void 0:i.data},n,a,c,s),e.target.textContent=""))},G=function(e){var t=e.users,n=e.onClick,c=e.type;return t.map((function(e){if(!e)return null;var t=new oe(e);return Object(v.jsxs)("div",{className:"friend",children:[Object(v.jsx)("img",{width:"35",height:"35",alt:"uwu",src:t.displayAvatarURL(45),className:"friend-pfp"}),Object(v.jsxs)("div",{children:[Object(v.jsxs)("h5",{className:"friend-name",children:[t.username,Object(v.jsx)("span",{children:t.tag})]}),Object(v.jsx)("p",{className:"state",children:"requests"===c&&e.received&&"Incoming friend request"}),Object(v.jsx)("p",{className:"state",children:"requests"===c&&!e.received&&"Ongoing friend request"}),Object(v.jsx)("p",{className:"state",children:"friends"===c&&(e.online?"Online":"Offline")})]}),"requests"===c&&e.received&&Object(v.jsx)("div",{onClick:function(){return null===n||void 0===n?void 0:n(t)},className:"accept",children:Object(v.jsx)(N,{size:15})}),"friends"===c&&Object(v.jsx)("div",{onClick:function(){return null===n||void 0===n?void 0:n(t)},className:"accept",children:"DM"})]},t.id)}))},X=function(e){var t=e.online,n=e.user,s=e.click,a=Object(c.useState)([]),r=Object(i.a)(a,2),o=r[0],l=r[1];return Object(c.useEffect)((function(){var e=!0;return fetch("".concat(d.a,"friends"),{headers:{Authorization:n.token}}).then((function(e){return e.json()})).then((function(n){e&&l(t?n.filter((function(e){return e.online})):n)})),function(){e=!1,l([])}}),[n,t]),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)("h5",{className:"home-title",children:[t?"ONLINE":"ALL","\u2014",o.length]}),Object(v.jsx)("div",{className:"list",children:Object(v.jsx)(G,{onClick:s,type:"friends",users:o})})]})},Z=function(e){var t=e.user,n=Object(c.useState)(""),s=Object(i.a)(n,2),a=s[0],r=s[1],o=Object(c.useState)(Object(v.jsx)("p",{className:"dumb-text-3",children:"You can add a friend by their tag. It's CaSe SeNsiTive!"})),j=Object(i.a)(o,2),h=j[0],m=j[1],b=function(){var e=Object(u.a)(l.a.mark((function e(){var n,c,s,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.split("#"),c=Object(i.a)(n,2),s=c[0],r=c[1],s&&r){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,fetch("".concat(d.a,"users/").concat(s,"&").concat(r,"/request"),{method:"POST",headers:{Authorization:t.token,"Content-Type":"application/json"}});case 5:if(!e.sent.ok){e.next=8;break}return e.abrupt("return",m(Object(v.jsxs)("p",{style:{color:"var(--green)"},className:"dumb-text-3",children:["You send a friend request to ",s+"#"+r]})));case 8:m(Object(v.jsxs)("p",{style:{color:"var(--red)"},className:"dumb-text-3",children:["Failed to send a friend request to ",s+"#"+r]}));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(v.jsxs)("div",{className:"invite",children:[Object(v.jsx)("h3",{className:"h3-add",children:"ADD FRIEND"}),h,Object(v.jsxs)("div",{className:"add-friend-input",children:[Object(v.jsx)("input",{autoComplete:"off",maxLength:"35",onChange:function(e){return r(e.target.value)},placeholder:"Enter a username#0000"}),Object(v.jsx)("div",{className:"fake-after",children:!a.includes("#")&&a}),Object(v.jsx)("button",{onClick:b,className:"send-friend-request ".concat(a&&"valid"),children:"Send friend request"})]})]})},$=function(e){var t=e.user,n=Object(c.useState)([]),s=Object(i.a)(n,2),a=s[0],r=s[1];Object(c.useEffect)((function(){var e=!0;return fetch("".concat(d.a,"friends/pending"),{headers:{Authorization:t.token}}).then((function(e){return e.json()})).then((function(t){e&&r(t)})),function(){e=!1}}),[t]);return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)("h5",{className:"home-title",children:["PENDING\u2014",a.length]}),Object(v.jsx)("div",{className:"list",children:Object(v.jsx)(G,{type:"requests",onClick:function(e){r((function(t){return Object(j.a)(t).filter((function(t){return t._id!==e.id}))})),fetch("".concat(d.a,"accept/").concat(e.id),{method:"POST",headers:{Authorization:t.token}})},users:a})})]})},Q=function(e){var t=e.dm,n=e.me,s=e.onJoin,a=e.setLogs,r=Object(c.useState)([]),o=Object(i.a)(r,2),l=o[0],u=o[1],h=Object(c.useState)(),m=Object(i.a)(h,2),f=m[0],O=m[1],x=Object(c.useCallback)((function(e){Y(e,n,new oe(t.user),u),a((function(e){var n=Object(j.a)(e);return n.splice(0,0,n.splice(n.findIndex((function(e){return e._id===t.user._id})),1)[0]),n}))}),[n,t,a]);return Object(c.useLayoutEffect)((function(){var e=!0;return O(Object(v.jsx)(y,{})),fetch("".concat(d.a,"dm/").concat(t.user.id),{headers:{Authorization:n.token}}).then((function(e){return e.json()})).then((function(n){var c;e&&(u(n),O(),(null===(c=t.message)||void 0===c?void 0:c.target.textContent)&&x(t.message))})),_e.on("dm",(function(n){e&&n.channel===t.user.id&&b.message(u,n)})),_e.on("messageDelete",(function(c){e&&(c.user!==t.user.id&&c.user!==n._id||b.messageDelete(u,c))})),_e.on("messageEdit",(function(e){console.log(e.user),b.messageEdit(u,e)})),function(){e=!1,_e.off("dm").off("messageDelete").off("messageEdit"),u([])}}),[n.token,n._id,t,x]),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)("div",{className:"chat",children:[f,Object(v.jsxs)("ul",{className:"fetched-messages",children:[Object(v.jsxs)("div",{className:"dm-start",children:[Object(v.jsx)("img",{height:"85",width:"85",className:"dm-avatar",alt:"icon",src:t.user.displayAvatarURL(90)}),Object(v.jsx)("h3",{className:"dm-username",children:t.user.username}),Object(v.jsxs)("p",{className:"dumb-text-2",children:["This is the beginning of your direct message history with ",Object(v.jsx)("span",{children:t.user.username})]})]}),Object(v.jsx)(B,{onJoin:s,setMessages:u,messages:l,me:n})]})]}),Object(v.jsx)("form",{className:"send-message",children:Object(v.jsx)("div",{className:"controll",children:Object(v.jsx)("div",{className:"text-content",children:Object(v.jsx)(A,{placeholder:"Send a message to ".concat(t.user.username),onKeyDown:x})})})})]})},ee=function(e){var t=e.user,n=e.dm,s=e.onJoin,a=Object(c.useContext)(Fe).setView,r=Object(c.useState)("online"),o=Object(i.a)(r,2),l=o[0],u=o[1],h=Object(c.useState)(n),m=Object(i.a)(h,2),f=m[0],O=m[1],x=Object(c.useState)([]),p=Object(i.a)(x,2),g=p[0],N=p[1],w=function(e){return O({user:e})},y=Object(c.useState)(Object(v.jsx)(X,{click:w,online:!0,user:t})),k=Object(i.a)(y,2),C=k[0],S=k[1];Object(c.useEffect)((function(){n&&O(n)}),[n]);var E=Object(c.useContext)(Fe),A=Object(i.a)(E.not,2),L=A[0],R=A[1];Object(c.useLayoutEffect)((function(){(null===f||void 0===f?void 0:f.user.id)&&(L.find((function(e){return e.user._id===f.user.id}))&&R((function(e){return Object(j.a)(e).filter((function(e){return e.user._id!==f.user.id}))})),fetch("".concat(d.a,"notifications?id=").concat(f.user.id),{method:"DELETE",headers:{Authorization:t.token}}).catch(console.log))}),[L,R,null===f||void 0===f?void 0:f.user.id,t.token]),Object(c.useEffect)((function(){var e=!0;return fetch("".concat(d.a,"dms/logs"),{headers:{Authorization:t.token}}).then((function(e){return e.json()})).then((function(t){e&&N(t)})),_e.on("online",(function(e){return b.memberOnline(N,e)})),function(){_e.off("online"),e=!1}}),[t]),Object(c.useEffect)((function(){f&&(S(Object(v.jsx)(Q,{setLogs:N,onJoin:s,dm:f,me:t})),u(f.user.id),g.some((function(e){return e._id===f.user.id}))||N((function(e){return[f.user].concat(Object(j.a)(e))})))}),[f,t,s,g]);var T=function(e){return function(){u(e),"online"===e&&S(Object(v.jsx)(X,{click:w,online:!0,user:t})),"add"===e&&S(Object(v.jsx)(Z,{user:t})),"pending"===e&&S(Object(v.jsx)($,{user:t})),"all"===e&&S(Object(v.jsx)(X,{click:w,user:t}))}};return Object(v.jsxs)("main",{className:"flexible-container",children:[Object(v.jsxs)("section",{className:"left-part",children:[Object(v.jsx)("header",{className:"server-name home-search",children:Object(v.jsx)("input",{onClick:function(){return a(Object(v.jsx)(W,{clickUser:function(e){return O({user:e})},logs:g}))},value:"Find or start conversation",className:"home-search-input generic-input-type-button",type:"button"})}),Object(v.jsxs)("div",{className:"channels",children:[Object(v.jsx)("div",{onClick:function(){u("online"),O(),S(Object(v.jsx)(X,{click:w,online:!0,user:t}))},className:"friends-click ".concat(!f&&"friends-clicked"),children:"Friends"}),Object(v.jsx)("h4",{className:"direct-messages",children:"DIRECT MESSAGES"}),g.map((function(e){var t=new oe(e);return Object(v.jsxs)("div",{onClick:function(){return O({user:t})},style:{opacity:1},className:"member ".concat((null===f||void 0===f?void 0:f.user.id)===t.id&&"member-clicked"," ").concat(!t.online&&"member-offline"),children:[Object(v.jsxs)("div",{className:"member-avatar",children:[Object(v.jsx)("img",{width:"32",height:"32",src:t.displayAvatarURL(90,"false"),alt:"avatar",className:"member-icon"}),Object(v.jsx)("div",{className:"member-is-online"})]}),Object(v.jsxs)("div",{className:"nice-div",children:[Object(v.jsx)("h4",{className:"member-name",children:t.username}),Object(v.jsx)("p",{className:"is-online",children:t.online?"Online":"Offline"})]})]},t.id)}))]}),Object(v.jsx)(M,{setView:a})]}),Object(v.jsxs)("section",{className:"messages messages-home",children:[Object(v.jsx)("div",{className:"name name-".concat(l),children:f?Object(v.jsxs)("div",{className:"dm-title",children:[Object(v.jsx)("img",{className:"who-am-i-talking-to",height:"20",width:"20",alt:"pfp",src:f.user.displayAvatarURL(80)}),Object(v.jsx)("div",{className:"channel-title",children:Object(v.jsx)("span",{children:f.user.username})})]}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)("h3",{className:"h3-title",children:["Friends ",Object(v.jsx)("span",{children:"|"})]}),Object(v.jsxs)("div",{className:"home-buttons",children:[Object(v.jsx)("button",{onClick:T("online"),className:"online",children:"Online"}),Object(v.jsx)("button",{onClick:T("all"),className:"all",children:"All"}),Object(v.jsx)("button",{onClick:T("pending"),className:"pending",children:"Pending"}),Object(v.jsx)("button",{onClick:T("add"),className:"add-friend",children:"Add friend"})]})]})}),Object(v.jsx)("div",{className:"messages-main",children:C})]})]})},te=(n(61),function(e){var t=e.servers;return Object(v.jsx)("div",{className:"list",style:{marginTop:10,height:"100%"},children:t.map((function(e){var t=new x(e);return Object(v.jsxs)("div",{className:"mutual-server friend",children:[e.icon?Object(v.jsx)("img",{width:"40",height:"40",alt:"uwu",src:t.displayIcon(100),className:"friend-pfp server-ico"}):Object(v.jsx)("div",{style:{width:40,height:40,background:"var(--blue)"},className:"default-no-img-div server-ico friend-pfp",children:e.name[0]}),Object(v.jsx)("h5",{className:"friend-name",children:t.name})]},t.id)}))})}),ne=function(e){var t=e.user;return Object(v.jsxs)("div",{style:{padding:"0 15px",boxSizing:"border-box"},className:"note",children:[Object(v.jsx)("h5",{children:"NOTE"}),Object(v.jsx)("textarea",{defaultValue:localStorage.getItem(t.id),onChange:function(e){return localStorage.setItem(t.id,e.target.value)},placeholder:"Click to add note"})]})},ce=function(e){var t=e.button,n=e.servers,c=e.user;switch(t){case 1:return Object(v.jsx)(ne,{user:c});case 2:return Object(v.jsx)(te,{servers:n});case 3:return Object(v.jsx)("div",{style:{marginTop:10},className:"list"});default:return null}},se=function(e){var t=e.user,n=e.dm,s=e.online,a=Object(c.useState)(1),r=Object(i.a)(a,2),o=r[0],l=r[1],u=Object(c.useContext)(Fe).user,d=u.servers.filter((function(e){return e.members.includes(t.id)})),j=function(e){return function(){return l(e)}},h=!t.profileColor&&"url(".concat(t.displayAvatarURL(90),")");return Object(v.jsx)(T,{children:Object(v.jsxs)("div",{className:"view-profile animated-popup ".concat(!s&&"not-online"),children:[Object(v.jsx)("div",{style:{backgroundColor:t.profileColor||"#000000",backgroundImage:h},className:"user-bg"}),Object(v.jsxs)("div",{className:"pfp-wrapper",children:[Object(v.jsx)("img",{height:"120",width:"120",src:t.displayAvatarURL(120),alt:":p",className:"pfp-2"}),Object(v.jsx)("div",{className:"status profile-status"})]}),u._id!==t.id&&Object(v.jsx)("button",{onClick:function(){return n({code:"Enter"})},className:"send-req",children:"Send Message"}),Object(v.jsxs)("h3",{className:"uwu-20",children:[t.username,Object(v.jsx)("span",{children:t.tag})]}),Object(v.jsx)("div",{className:"more-with-border",children:Object(v.jsxs)("div",{className:"more",children:[Object(v.jsx)("div",{onClick:j(1),className:"more-div user-info-2 ".concat(1===o&&"clicked"),children:"User Info"}),Object(v.jsx)("div",{onClick:j(2),className:"more-div mutual-servers ".concat(2===o&&"clicked"),children:"Mutual Servers"}),Object(v.jsx)("div",{onClick:j(3),className:"more-div mutual-friends ".concat(3===o&&"clicked"),children:"Mutual Friends"})]})}),Object(v.jsx)("div",{className:"even-more",children:Object(v.jsx)(ce,{button:o,servers:d,user:t})})]})})},ae=function(e){var t=e.user,n=e.server,s=e.style,a=e.setView,r=e.editable,o=e.onClick,l=Object(c.useContext)(Fe),u=l.setScreen,d=l.setServer,j=l.user,h=Object(c.useContext)(Je),m=Object(c.useState)(s.top),b=Object(i.a)(m,2),f=b[0],O=b[1],x=Object(c.useState)(0),p=Object(i.a)(x,2),N=p[0],w=p[1],y=Object(c.useState)(t.online),k=Object(i.a)(y,2),C=k[0],S=k[1],E=Object(c.useRef)();Object(c.useLayoutEffect)((function(){var e=E.current.getBoundingClientRect();s.top>window.innerHeight-e.height-20&&O(window.innerHeight-e.height-20),s.top<10&&O(10);var t=function(e){return S(e.online)};return _e.on("online",t),function(){return _e.off("online",t)}}),[s.top]),Object(c.useEffect)((function(){var e=setInterval((function(){return w((function(e){return++e}))}),1e3);return function(){return clearInterval(e)}}),[]);var A=function(e){var n,c;if("Enter"===e.code){d();var s={code:"Enter",target:{textContent:null===(n=e.target)||void 0===n?void 0:n.value,innerText:null===(c=e.target)||void 0===c?void 0:c.value}};u(Object(v.jsx)(ee,{update:h,dm:{user:t,message:s},user:j})),a()}};return Object(v.jsxs)("div",{ref:E,style:Object(g.a)(Object(g.a)({},s),{},{top:f}),className:"user-div ".concat(!C&&"not-online"),children:[Object(v.jsx)("div",{style:{backgroundColor:t.profileColor||"#000"},className:"user-bg-1"}),Object(v.jsxs)("div",{"data-text":r?"CHANGE AVATAR":"VIEW PROFILE",onClick:function(){if(o)return o();a(Object(v.jsx)(se,{dm:A,user:t,online:C}))},className:"avatar-wrapper",children:[Object(v.jsx)("img",{width:"80",height:"80",src:t.displayAvatarURL(90),alt:"avatar",className:"user-avatar"}),Object(v.jsx)("div",{className:"".concat(!r&&"status"),title:t.online?"online":"offline"})]}),Object(v.jsxs)("h5",{className:"user-username",children:[t.username,Object(v.jsx)("span",{children:t.tag})]}),Object(v.jsx)("div",{className:"line first"}),n&&Object(v.jsxs)("div",{className:"roles",children:[Object(v.jsx)("h5",{children:"ROLES"}),Object(v.jsx)("div",{className:"role",children:"Member"}),n.owner===t.id&&Object(v.jsx)("div",{className:"role",children:"Owner"}),Object(v.jsx)("div",{className:"line last"})]}),r?Object(v.jsxs)("div",{className:"customizing-my-profile",children:[Object(v.jsx)("h5",{children:"CUSTOMIZING MY PROFILE"}),Object(v.jsxs)("div",{style:{height:70},className:"flex-line",children:[Object(v.jsx)("div",{className:"activity-icon",children:Object(v.jsx)(L,{height:50,width:50})}),Object(v.jsxs)("div",{className:"activity-name",children:[Object(v.jsx)("h5",{children:"User Profile"}),Object(v.jsxs)("span",{children:[(~~(N/60)).toFixed().padStart(2,"0"),":",(N-60*~~(N/60)).toFixed().padStart(2,"0")," elapsed"]})]})]})]}):Object(v.jsxs)("div",{className:"note",children:[Object(v.jsx)("h5",{children:"NOTE"}),Object(v.jsx)("textarea",{onChange:function(e){return localStorage.setItem(t.id,e.target.value)},defaultValue:localStorage.getItem(t.id),placeholder:"Click to add a note"})]}),j._id!==t.id&&Object(v.jsx)("input",{onKeyDown:A,placeholder:"Message ".concat(t.username).concat(t.tag),className:"dm-user"})]})},re=function(e){var t=e.size;return Object(v.jsxs)("svg",{height:t,width:t,version:"1.1",id:"crown",x:"0px",y:"0px",viewBox:"0 0 512 512",style:{enableBackground:"new 0 0 512 512"},xmlSpace:"preserve",children:[Object(v.jsx)("circle",{style:{fill:"#F95FF2"},cx:"50.637",cy:"264.44",r:"50.637"}),Object(v.jsx)("circle",{style:{fill:"#AB15A4"},cx:"461.363",cy:"264.44",r:"50.637"}),Object(v.jsx)("polygon",{style:{fill:"#E7C05C"},points:"405.099,416.352 461.363,393.846 495.121,50.637 458.844,76.244 "}),Object(v.jsx)("polygon",{style:{fill:"#FFD875"},points:"375.557,135.033 255.993,50.637 136.434,135.033 16.879,50.637 50.637,416.352 \r 425.391,416.352 458.844,76.244 "}),Object(v.jsx)("circle",{style:{fill:"#D0A842"},cx:256,cy:"264.44",r:"84.396"}),Object(v.jsx)("path",{style:{fill:"#FEDFFD"},d:"M461.363,393.846h-33.758v67.517h33.758c18.645,0,33.758-15.114,33.758-33.758\r C495.121,408.96,480.007,393.846,461.363,393.846z"}),Object(v.jsx)("path",{style:{fill:"#FFF3EE"},d:"M461.363,427.604c0-18.645-15.114-33.758-33.758-33.758H50.637\r c-18.645,0-33.758,15.114-33.758,33.758c0,18.645,15.114,33.758,33.758,33.758h376.967\r C446.249,461.363,461.363,446.249,461.363,427.604z"}),Object(v.jsx)("path",{style:{fill:"#AB15A4"},d:"M256,213.802v101.275c27.966,0,50.637-22.671,50.637-50.637S283.966,213.802,256,213.802z"}),Object(v.jsx)("path",{style:{fill:"#D23ACB"},d:"M272.879,264.44c0-27.966-7.557-50.637-16.879-50.637c-27.966,0-50.637,22.671-50.637,50.637\r s22.671,50.637,50.637,50.637C265.322,315.077,272.879,292.406,272.879,264.44z"}),Object(v.jsxs)("g",{children:[Object(v.jsx)("circle",{style:{fill:"#E7C05C"},cx:"89.673",cy:"317.89",r:"8.44"}),Object(v.jsx)("circle",{style:{fill:"#E7C05C"},cx:"123.431",cy:"351.648",r:"8.44"})]})]})},ie=function(e){var t=e.server,n=e.member,s=Object(c.useState)(!1),a=Object(i.a)(s,2),r=a[0],o=a[1],l=Object(c.useContext)(Fe).setView;return Object(v.jsxs)("div",{onClick:function(e){o(!0);var c=e.target.getBoundingClientRect().top-40;l(Object(v.jsx)(R.Out,{click:function(){o(!1),l()},children:Object(v.jsx)(ae,{user:n,setView:function(){o(!1),l.apply(void 0,arguments)},style:{right:245,top:c,animationName:"reverseShift"},server:t})}))},className:"member ".concat(r&&"member-clicked"," ").concat(!n.online&&"member-offline"),children:[Object(v.jsxs)("div",{className:"member-avatar",children:[Object(v.jsx)("img",{width:"32",height:"32",src:n.displayAvatarURL(90,"false"),alt:"avatar",className:"member-icon"}),Object(v.jsx)("div",{className:"member-is-online"})]}),Object(v.jsxs)("div",{className:"nice-div",children:[Object(v.jsxs)("span",{className:"member-name ".concat((null===t||void 0===t?void 0:t.owner)===n.id&&"owner"),children:[n.username," ",(null===t||void 0===t?void 0:t.owner)===n.id&&Object(v.jsx)(re,{size:16})]}),Object(v.jsx)("span",{className:"is-online",children:n.online?"Online":"Offline"})]})]},n.id)},oe=function(){function e(t){for(var n in Object(h.a)(this,e),t)this[n]=t[n];this.id=t._id}return Object(m.a)(e,[{key:"displayAvatarURL",value:function(e,t){return"".concat(d.a+this.avatarURL,"?").concat(e?"width=".concat(e,"&height=").concat(e):"").concat(t?"&dynamic=".concat(t):"")}},{key:"toJSX",value:function(e,t,n){return Object(v.jsx)(ae,{user:this,setView:n,style:e,server:t})}},{key:"fetch",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(Object(u.a)(l.a.mark((function t(){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(d.a,"fetch/").concat(this.id)).then((function(e){return e.json()}));case 2:return n=t.sent,this.avatarURL=n.avatarURL,this.username=n.username,t.abrupt("return",new e(Object.assign({_id:this.id},n)));case 6:case"end":return t.stop()}}),t,this)}))))},{key:"edit",value:function(){var e=Object(u.a)(l.a.mark((function e(t,n,c){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(d.a,"user/edit"),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:this.token},body:JSON.stringify({username:t,data:n,profileColor:c})}).then((function(e){return e.json()})).catch(console.log);case 2:return s=e.sent,this.avatarURL=s.avatarURL,this.username=s.username,e.abrupt("return",s);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,c){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=Object(u.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(d.a,"dm/").concat(this.id),{method:"POST",headers:{Authorization:t.author.token,"Content-Type":"application/json"},body:JSON.stringify({content:t.content})}).then((function(e){return e.json()}));case 2:return n=e.sent,e.abrupt("return",new le(n));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"MapMembers",value:function(t){var n,c=t.members,s=t.server,a=t.setView,r=t.me,i=c.filter((function(e){return null===e||void 0===e?void 0:e.online})).length,o=c.length-i,l=[Object(v.jsxs)("h5",{className:"members-title",children:["ONLINE \u2014 ",i]},"online")],u=[Object(v.jsxs)("h5",{className:"members-title",children:["OFFLINE \u2014 ",o]},"offline")],d=c.sort((function(e,t){return e.username.localeCompare(t.username)})),j=Object(p.a)(d);try{for(j.s();!(n=j.n()).done;){var h=n.value,m=new e(Object.assign(h,{view:a})),b=Object(v.jsx)(ie,{member:m,server:s,me:r},m.id);h.online?l.push(b):u.push(b)}}catch(f){j.e(f)}finally{j.f()}return 1===u.length&&(u.length=0),1===l.length&&(l.length=0),l.concat(u)}}]),e}(),le=(n(62),function(){function e(t,n,c,s){Object(h.a)(this,e),this.author=new oe(t.author),this.content=t.content,this.attachment=t.attachment,this.timestamp=new Date(t.createdAt),this.createdAt=function(e){var t="".concat("".concat(e.getHours()).padStart(2,"0"),":").concat("".concat(e.getMinutes()).padStart(2,"0")),n=new Date,c=36e5*n.getHours()+6e4*n.getMinutes()+1e3*n.getSeconds()+n.getMilliseconds();return Date.now()-e.getTime()<=c?"Today at ".concat(t):Date.now()-e.getTime()<=c+864e5?"Yesterday at ".concat(t):e.toLocaleDateString()}(new Date(t.createdAt)),this.id=t._id,this.invite=t.invite,this.unsent=t.unsent,this.server=s,this.channel=t.channel,this.Authorization=null===n||void 0===n?void 0:n.token,this.me=n,this.setMessages=t.setMessages,this.onJoin=c,this.failed=t.failed,this.updatedAt=t.updatedAt}return Object(m.a)(e,[{key:"calculateImage",get:function(){return this.attachment.height<300&&this.attachment.width<400?{height:this.attachment.height,width:this.attachment.width}:this.attachment.height>=this.attachment.width||this.attachment.height/this.attachment.width*400>300?{height:300,width:this.attachment.width/this.attachment.height*300}:{width:400,height:this.attachment.height/this.attachment.width*400}}},{key:"displayAttachmentURL",get:function(){var e=this.calculateImage.height!==this.attachment.height&&this.calculateImage.width!==this.attachment.width?"?width=".concat(Math.trunc(this.calculateImage.width),"&height=").concat(Math.trunc(this.calculateImage.height)):"";return d.a+this.attachment.URL+e}},{key:"delete",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(d.a,"channels/").concat(this.channel,"/messages/").concat(this.id),{method:"DELETE",headers:{Authorization:this.Authorization}}).then((function(e){return e.json()}));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"edit",value:function(){var e=Object(u.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(d.a,"channels/").concat(this.channel,"/messages/").concat(this.id),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:this.Authorization},body:JSON.stringify({content:t})}).then((function(e){return e.json()}));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"inviteCode",get:function(){var e,t=null===(e=this.content.match(/(^|\s)server\/.{8}(?=\s|$)/g))||void 0===e?void 0:e[0];return t?t.split("/")[1]:null}}]),e}()),ue=function(e){var t=e.isClicked,n=e.onClick,c=e.channel;return Object(v.jsxs)("div",{onClick:n,className:"channel ".concat(t?"c-clicked":""),children:[Object(v.jsx)(H,{size:25}),Object(v.jsx)("span",{children:c.name})]})},de=function(e,t,n){var s=Object(c.useState)(0),a=Object(i.a)(s,2),r=a[0],o=a[1];return Object(c.useEffect)((function(){return o(0)}),[e]),e.map((function(e,c){var s=new je(e,t);return s.toJSX(r===c,(function(){n(s),o(c)}))}))},je=function(){function e(t,n){Object(h.a)(this,e),this.name=t.name,this.id=t._id,this.server=n}return Object(m.a)(e,[{key:"toJSX",value:function(e,t){return Object(v.jsx)(ue,{isClicked:e,onClick:t,channel:this},this.id)}},{key:"toTitle",value:function(){return Object(v.jsxs)("div",{className:"channel-title",children:[Object(v.jsx)(H,{size:28}),Object(v.jsx)("span",{children:this.name})]})}},{key:"join",value:function(e,t){e.emit("join",{channel:this.id,Authorization:t})}},{key:"fetchMessages",value:function(){var e=Object(u.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!O.channels[this.id]){e.next=2;break}return e.abrupt("return",{messages:O.channels[this.id]});case 2:return e.next=4,fetch("".concat(d.a,"channels/").concat(this.id,"/messages"),{headers:{Authorization:t}}).then((function(e){return e.json()})).catch((function(){return[]}));case 4:return n=e.sent,O.at("channels",this.id)(n.messages),e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=Object(u.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(d.a,"channels/").concat(this.id,"/messages"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:t.author.token},body:JSON.stringify(t)}).then((function(e){return e.json()}));case 2:return n=e.sent,e.abrupt("return",new le(n));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();je.LoadChannels=de;var he=je,me=function(){return Object(v.jsxs)("div",{className:"member-skeleton",children:[Object(v.jsx)("div",{className:"member-skeleton-pfp"}),Object(v.jsxs)("div",{className:"nice-div",children:[Object(v.jsx)("div",{className:"member-skeleton-name"}),Math.random()>.5&&Object(v.jsx)("div",{className:"member-skeleton-status"})]})]})};function be(e){var t=e.times;return Object(j.a)(Array(t)).map((function(e,t){return Object(v.jsx)(me,{},t)}))}var fe=function(e){var t=e.size;return Object(v.jsx)("svg",{width:t,height:t,viewBox:"0 0 48 48",fill:"none",children:Object(v.jsx)("path",{d:"M37 18L25 30L13 18",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"})})},Oe=(n(63),function(e){var t=e.server,n=e.quit,s=e.animation,a=Object(c.useState)(),r=Object(i.a)(a,2),o=r[0],l=r[1],u=Object(c.useState)([]),h=Object(i.a)(u,2),m=h[0],b=h[1],f=Object(c.useState)(""),O=Object(i.a)(f,2),x=O[0],p=O[1],g=Object(c.useState)(!1),w=Object(i.a)(g,2),y=w[0],k=w[1],C=Object(c.useContext)(Fe).user;Object(c.useEffect)((function(){var e=!0;return fetch("".concat(d.a,"friends"),{headers:{Authorization:C.token}}).then((function(e){return e.json()})).then((function(t){e&&l(t)})),function(){e=!1}}),[C]);return Object(v.jsxs)("div",{className:"invite-people-div ".concat(s),children:[Object(v.jsxs)("div",{className:"part-1",children:[Object(v.jsxs)("h3",{children:["INVITE PEOPLE TO ",t.name.toUpperCase()]}),Object(v.jsx)("input",{onChange:function(e){return p(e.target.value)},placeholder:"Search for friends"}),Object(v.jsx)(N,{onClick:n,size:25})]}),Object(v.jsxs)("div",{className:"part-2",children:[!o&&Object(v.jsx)("p",{className:"searching",children:"SEARCHING FOR FRIENDS"}),o&&!o.some((function(e){return e.username.toLowerCase().includes(x.toLowerCase())}))&&Object(v.jsx)("p",{className:"searching",children:"NO RESULTS WERE FOUND"}),o&&o.map((function(e){var n=new oe(e);return x&&!n.username.toLowerCase().includes(x.toLowerCase())?null:Object(v.jsxs)("div",{className:"invite-friend",children:[Object(v.jsx)("img",{alt:n.id,width:"34",height:"34",src:n.displayAvatarURL(80)}),Object(v.jsx)("h5",{children:n.username}),Object(v.jsx)("button",{className:"".concat(m.includes(n.id)&&"invited"),onClick:function(){m.includes(n.id)||(b((function(e){return[].concat(Object(j.a)(e),[n.id])})),fetch("".concat(d.a,"dm/").concat(n.id),{method:"POST",headers:{Authorization:C.token,"Content-Type":"application/json"},body:JSON.stringify({content:"server/"+t.invites[0]})}).catch(console.error))},children:m.includes(n.id)?"Sent":"Invite"})]},n.id)}))]}),Object(v.jsxs)("div",{className:"part-3",children:[Object(v.jsx)("h4",{children:"OR, SEND A SERVER INVITE LINK TO A FRIEND"}),Object(v.jsxs)("div",{children:[Object(v.jsx)("button",{className:"".concat(y?"copied":"copy"),onClick:function(){return navigator.clipboard.writeText("server/"+t.invites[0]).then((function(){k(!0),setTimeout((function(){return k(!1)}),5e3)}))},children:y?"Copied":"Copy"}),Object(v.jsx)("input",{readOnly:!0,value:"server/"+t.invites[0]})]})]})]})}),ve=function(e){return new Promise((function(t,n){var c=new FileReader;c.readAsDataURL(e),c.onload=function(){var e=new Image;e.onload=function(){return t(c.result)},e.src=c.result},c.onerror=function(e){return n(e)}}))},xe=function(e){var t=e.server,n=e.animation,s=e.quit,a=Object(c.useState)(t.displayIcon(100,100)),r=Object(i.a)(a,2),o=r[0],j=r[1],h=Object(c.useState)(""),m=Object(i.a)(h,2),b=m[0],f=m[1],O=Object(c.useContext)(Fe).user,x=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.target.files[0],e.next=3,ve(n).catch((function(){return 0}));case 3:(c=e.sent)&&j(c);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsx)("div",{className:"dark-div ".concat(n),children:Object(v.jsx)(R.Out,{click:s,children:Object(v.jsxs)("div",{className:"edit-server ".concat(n),children:[Object(v.jsxs)("div",{className:"server-edit-icon",children:[Object(v.jsx)("img",{height:"100",width:"100",src:o,alt:"icon"}),Object(v.jsx)("label",{className:"upload-button",htmlFor:"xx3",children:"Upload Image"}),Object(v.jsx)("input",{id:"xx3",name:"upload",className:"upload-file",onChange:x,type:"file"})]}),Object(v.jsxs)("div",{className:"server-info",children:[Object(v.jsx)("h3",{children:"Edit Server"}),Object(v.jsx)("label",{htmlFor:"bruh",children:"SERVER NAME"}),Object(v.jsx)("input",{className:"change-server-name",onChange:function(e){return f(e.target.value)},name:"bruh",defaultValue:t.name}),Object(v.jsx)("button",{onClick:function(){fetch("".concat(d.a,"server/").concat(t.id),{method:"PATCH",body:JSON.stringify({icon:o,name:b}),headers:{"Content-Type":"application/json",Authorization:O.token}})},children:"Save"})]})]})})})},pe=function(e){var t=e.server,n=e.quit,s=Object(c.useContext)(Fe).user,a=Object(c.useState)({name:"",type:"text"}),r=Object(i.a)(a,2),o=r[0],j=r[1],h=Object(c.useState)(""),m=Object(i.a)(h,2),b=m[0],f=m[1],O=function(){f("self-smaller"),setTimeout((function(){return n()}),100)},x=function(){var e=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o.name){e.next=2;break}return e.abrupt("return");case 2:return f("waiting"),e.next=5,fetch("".concat(d.a,"servers/").concat(t.id,"/channels"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:s.token},body:JSON.stringify(o)});case 5:O();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(v.jsx)(T,{children:Object(v.jsxs)("div",{className:"invite-people-div animated-popup ".concat(b),children:[Object(v.jsxs)("div",{style:{textAlign:"center"},className:"part-1",children:[Object(v.jsx)("h3",{style:{fontSize:"20px",marginTop:30},children:"Create Text Channel"}),Object(v.jsx)(N,{onClick:O,size:25})]}),Object(v.jsxs)("div",{className:"check-boxes",children:[Object(v.jsx)("h5",{children:"CHANNEL TYPE"}),Object(v.jsxs)("div",{className:"check",children:[Object(v.jsx)("div",{className:"checker"}),Object(v.jsx)(H,{size:28}),Object(v.jsxs)("div",{className:"channel-type",children:[Object(v.jsx)("h4",{children:"Text Channel"}),Object(v.jsx)("p",{children:"Post images, GIFs, opinions and puns"})]})]}),Object(v.jsx)("h5",{children:"CHANNEL NAME"}),Object(v.jsx)("input",{onChange:function(e){return j((function(t){return{name:e.target.value,type:t.type}}))},style:{marginTop:0,height:35},className:"change-server-name"})]}),Object(v.jsxs)("div",{className:"lower-section",children:[Object(v.jsx)("button",{onClick:O,className:"generic-button cancel",children:"Cancel"}),Object(v.jsx)("button",{onClick:x,className:"generic-button success ".concat(!o.name&&"cant-click"),children:"Create Channel"})]})]})})},ge=function(e,t){for(var n=window.atob(e),c=new Array(n.length),s=0;s<n.length;s++)c[s]=n.charCodeAt(s);var a=new Uint8Array(c);return new Blob([a],{type:t})},Ne=(n(64),function(e){var t=e.attachments,n=e.setAttachments;return t.map((function(e,t){var c=e.data,s=e.fileName,a=ge(c.split(",")[1],"image/"+s.split(".").pop()),r=URL.createObjectURL(a);return Object(v.jsxs)("li",{className:"attachment-item",style:{position:"relative"},children:[Object(v.jsx)("button",{onClick:function(){return e=t,n((function(t){return Object(j.a)(t).filter((function(t,n){return n!==e}))}));var e},className:"attachment-delete",children:Object(v.jsx)(N,{size:15})}),Object(v.jsx)("img",{src:r,className:"attachment-2",alt:"attachment"}),Object(v.jsx)("span",{className:"attachment-name",children:s})]},t)}))}),we=function(e){return new Promise((function(t,n){var c=new FileReader;c.readAsDataURL(e),c.onload=function(){var e=new Image;e.onload=function(){return t(c.result)},e.src=c.result},c.onerror=function(e){return n(e)}}))},ye=function(e){var t,n=e.user,s=e.server,a=e.onJoin,r=Object(c.useContext)(Fe).setView,o=new oe(n),j=Object(c.useState)(),h=Object(i.a)(j,2),m=h[0],f=h[1],x=Object(c.useState)(),p=Object(i.a)(x,2),g=p[0],w=p[1],k=Object(c.useState)([]),C=Object(i.a)(k,2),S=C[0],E=C[1],L=Object(c.useState)([]),D=Object(i.a)(L,2),I=D[0],U=D[1];Object(c.useLayoutEffect)((function(){var e=!0;w();try{var t=new he(s.channels[0],s);t&&f(t)}catch(c){var n=new he({name:"unknown"});w([]),f(n)}return E([]),s.fetchMembers("no-cache").then((function(t){e&&(E(t),_e.on("online",(function(e){return b.memberOnline(E,e)})))})),function(){_e.off("online"),e=!1}}),[s,o.token]),Object(c.useLayoutEffect)((function(){if(m&&(null===m||void 0===m?void 0:m.id)){var e=!0;O.channels[m.id]||w(),m.join(_e,o.token),m.fetchMessages(o.token).then((function(t){var n=t.messages;e&&w(n)})),O.init();var t=function(t){e&&t.author._id!==o.id&&m.id===t.channel&&b.message(w,t)},n=function(t){e&&t.channel===m.id&&b.messageDelete(w,t)},c=function(e){return e.channel===m.id&&b.messageEdit(w,e)},s=function(e){return b.memberUpdate(E,w,e)};return _e.on("message",t),_e.on("messageDelete",n),_e.on("messageEdit",c),_e.on("memberUpdate",s),function(){e=!1,_e.off("message",t).off("messageDelete",n).off("memberUpdate",s).off("messageEdit",c)}}}),[m,o.id,o.token]);var z=function(e){e.data&&U([e])},F=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,we(t.target.files[0]).catch((function(){return 0}));case 2:c=e.sent,z({data:c,fileName:null===(n=t.target.files[0])||void 0===n?void 0:n.name}),t.target.value="";case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,c,s,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.clipboardData.items,s=null===(n=c[1])||void 0===n?void 0:n.getAsFile(),e.next=4,we(s).catch((function(){return 0}));case 4:a=e.sent,z({data:a,fileName:null===s||void 0===s?void 0:s.name});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,c,s,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.stopPropagation(),t.preventDefault(),c=t.dataTransfer.items,s=null===(n=c[0])||void 0===n?void 0:n.getAsFile(),e.next=6,we(s).catch((function(){return 0}));case 6:a=e.sent,z({data:a,fileName:null===s||void 0===s?void 0:s.name});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=Object(c.useState)(),J=Object(i.a)(V,2),q=J[0],K=J[1];Object(c.useLayoutEffect)((function(){g||O.channels[null===m||void 0===m?void 0:m.id]?K():K(Object(v.jsx)(y,{}))}),[g,m]);var W=Object(c.useState)(),G=Object(i.a)(W,2),X=G[0],Z=G[1],$=function(){Z(!1);var e=function(){r(Object(v.jsx)(t,{animation:"smaller"})),setTimeout((function(){return r()}),100)},t=function(t){var n=t.animation;return Object(v.jsx)("div",{className:"dark-div ".concat(n),children:Object(v.jsx)(R.Out,{click:e,children:Object(v.jsx)(Oe,{animation:n,quit:e,server:s})})})};r(Object(v.jsx)(t,{animation:"bigger"}))},Q=function(){fetch("".concat(d.a,"leave/").concat(s.id),{method:"PATCH",headers:{Authorization:o.token}})},ee=function(){Z(!1),r(Object(v.jsx)(pe,{server:s,quit:function(){return r()},animation:"bigger"}))},te=function(){Z(!1);r(Object(v.jsx)(xe,{server:s,quit:function e(){r(Object(v.jsx)(xe,{server:s,quit:e,animation:"smaller"})),setTimeout((function(){return r()}),100)},animation:"bigger"}))};return Object(v.jsxs)("main",{onDragOver:function(e){return e.preventDefault()},onDrop:P,className:"flexible-container",children:[Object(v.jsxs)("section",{className:"left-part",children:[Object(v.jsxs)("header",{onClick:function(){Z(!0),r(Object(v.jsx)(T,{quit:function(){return Z(!1)},normal:!0,type:1,children:Object(v.jsxs)("div",{className:"server-menu animated-popup",children:[s.owner===n._id&&Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("p",{onClick:te,children:"Server Settings"}),Object(v.jsx)("p",{onClick:ee,children:"Create Channel"})]}),Object(v.jsx)("p",{onClick:$,className:"invite-people",children:"Invite People"}),s.owner!==n._id&&Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("div",{className:"separator"}),Object(v.jsx)("p",{onClick:Q,className:"leave-server",children:"Leave Server"})]})]})}))},className:"server-name ".concat(X&&"server-name-2"),children:[Object(v.jsx)("span",{children:s.name}),Object(v.jsx)(fe,{size:"23"})]}),X,Object(v.jsxs)("div",{className:"channels",children:[Object(v.jsx)("div",{style:{marginBottom:10}}),Object(v.jsx)("h4",{className:"direct-messages",children:"TEXT CHANNELS"}),he.LoadChannels((null===s||void 0===s?void 0:s.channels)||[],s,(function(e){m.id!==e.id&&f(e)}))]}),Object(v.jsx)(M,{setView:r})]}),Object(v.jsxs)("section",{className:"messages",children:[Object(v.jsx)("div",{className:"name",children:null===m||void 0===m?void 0:m.toTitle()}),Object(v.jsxs)("div",{className:"messages-main",children:[Object(v.jsxs)("div",{className:"chat",children:[q,Object(v.jsxs)("ul",{className:"fetched-messages",children:[Object(v.jsxs)("div",{className:"dm-start",children:[Object(v.jsx)("div",{className:"dm-avatar channel-icon",children:Object(v.jsx)(H,{size:"50"})}),Object(v.jsx)("h3",{className:"dm-username",children:null===m||void 0===m?void 0:m.name}),Object(v.jsxs)("p",{className:"dumb-text-2",children:["This is the start of ",Object(v.jsxs)("span",{children:["#",null===m||void 0===m?void 0:m.name]})," message history."]})]}),g&&Object(v.jsx)(B,{server:s,onJoin:a,me:n,messages:g,setView:r,setMessages:w})]})]}),Object(v.jsx)("form",{onSubmit:function(e){return e.preventDefault()},className:"send-message",children:Object(v.jsx)("div",{className:"controll",children:Object(v.jsxs)("div",{className:"message-manager",children:[Object(v.jsx)("ul",{className:"attachment-list ".concat(I.length&&"has-children"),children:Object(v.jsx)(Ne,{setAttachments:U,attachments:I})}),Object(v.jsxs)("div",{className:"text-content",children:[Object(v.jsx)("div",{className:"file",children:Object(v.jsxs)("button",{className:"attach-file",children:[Object(v.jsx)("input",{type:"file",onChange:F}),Object(v.jsx)(N,{size:10})]})}),Object(v.jsx)(A,{renderId:null===m||void 0===m?void 0:m.id,placeholder:"Send a message to ".concat(null===m||void 0===m?void 0:m.name),onPaste:_,onKeyDown:function(e){return Y(e,n,m,w,I,U)}})]})]})})})]}),Object(v.jsxs)("div",{className:"users",children:[0===S.length&&Object(v.jsx)("div",{style:{marginTop:20},children:Object(v.jsx)(be,{times:(null===s||void 0===s||null===(t=s.members)||void 0===t?void 0:t.length)||10})}),Object(v.jsx)(oe.MapMembers,{me:n,setView:r,members:S,server:s})]})]})]})},ke=n(43);var Ce=function(){return Object(v.jsxs)("svg",{width:"36",height:"36",version:"1.1",id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 24 24",children:[Object(v.jsxs)("linearGradient",{id:"svg-gradient",gradientUnits:"userSpaceOnUse",x1:"2.8461",y1:"11.7055",x2:"22.1588",y2:"11.7055",children:[Object(v.jsx)("stop",{offset:"0",style:{stopColor:"var(--purple-no-gradient)"}}),Object(v.jsx)("stop",{offset:"1",style:{stopColor:"var(--blue)"}})]}),Object(v.jsx)("path",{className:"st0",d:"M12.5,7.1l-6.9,5.7c0,0,0,0,0,0c0,0,0,0,0,0v5.7c0,0.2,0.1,0.4,0.2,0.5c0.2,0.2,0.3,0.2,0.5,0.2H11v-4.6H14v4.6\r h4.6c0.2,0,0.4-0.1,0.5-0.2c0.2-0.2,0.2-0.3,0.2-0.5v-5.7c0,0,0-0.1,0-0.1L12.5,7.1z M22,11.5l-2.6-2.2V4.4c0-0.1,0-0.2-0.1-0.3\r c-0.1-0.1-0.2-0.1-0.3-0.1h-2.3c-0.1,0-0.2,0-0.3,0.1c-0.1,0.1-0.1,0.2-0.1,0.3v2.3l-2.9-2.4C13.2,4.1,12.9,4,12.5,4\r c-0.4,0-0.7,0.1-0.9,0.3L3,11.5c-0.1,0.1-0.1,0.1-0.1,0.3c0,0.1,0,0.2,0.1,0.3l0.7,0.9C3.7,13,3.8,13,3.9,13.1c0.1,0,0.2,0,0.3-0.1\r l8.3-6.9l8.3,6.9c0.1,0.1,0.1,0.1,0.3,0.1h0c0.1,0,0.2-0.1,0.3-0.1l0.7-0.9c0.1-0.1,0.1-0.2,0.1-0.3C22.1,11.7,22.1,11.6,22,11.5z"})]})},Se=(n(96),function(e){var t=e.view,n=e.onCreate,s=e.user,a=Object(c.useState)(""),r=Object(i.a)(a,2),o=r[0],j=r[1],h=function(e){return new Promise((function(t,n){var c=new FileReader;c.readAsDataURL(e),c.onload=function(){return t(c.result)},c.onerror=function(e){return n(e)}}))},m=function(){var e="".concat(s.username,"'s server"),a=Object(c.useState)(e),r=Object(i.a)(a,2),o=r[0],m=r[1],b=Object(c.useState)(""),f=Object(i.a)(b,2),O=f[0],x=f[1],p=Object(c.useState)("bigger"),g=Object(i.a)(p,2),w=g[0],y=g[1],k=function(){var e=Object(u.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h(t.target.files[0]).then((function(e){return x(e)})).catch(console.log);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){j(""),y("self-smaller"),setTimeout((function(){return t()}),100)},S=function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(d.a,"servers"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:s.token},body:JSON.stringify({icon:O,name:o})}).then((function(e){return e.json()}));case 2:t=e.sent,C(),null===n||void 0===n||n(t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(v.jsx)(T,{quit:function(){return j("")},children:Object(v.jsxs)("div",{className:"creator animated-popup ".concat(w),children:[Object(v.jsxs)("div",{className:"view-server",children:[Object(v.jsx)(N,{onClick:C,size:25}),Object(v.jsx)("h2",{children:"Create a new Server"}),Object(v.jsx)("p",{className:"dummy-text",children:"Create a new Server, customize it! Invite your friends to it. And have a good time."}),Object(v.jsxs)("div",{className:"selector",children:[Object(v.jsx)("img",{className:"my-icon",alt:"",src:O}),Object(v.jsx)("input",{onChange:k,className:"select-icon",type:"file"})]})]}),Object(v.jsx)("label",{htmlFor:"server",children:"SERVER NAME"}),Object(v.jsx)("input",{required:!0,name:"server",defaultValue:e,onChange:function(e){return m(e.target.value)},className:"select-server-name"}),Object(v.jsxs)("div",{style:{backgroundColor:"rgb(231, 239, 247)"},className:"lower-section",children:[Object(v.jsx)("button",{style:{color:"black",marginRight:"auto",marginLeft:0},onClick:C,className:"generic-button cancel",children:"Back"}),Object(v.jsx)("button",{onClick:S,className:"generic-button primary",children:"Create"})]})]})})};return Object(v.jsxs)("div",{className:"server-block ".concat(o),children:[Object(v.jsx)("div",{onClick:function(){j("clicked"),t(Object(v.jsx)(m,{}))},className:"server",children:Object(v.jsx)("div",{title:"Add a Server",className:"add-server",children:Object(v.jsx)(N,{size:23})})}),Object(v.jsx)("div",{className:"server-marker"})]})}),Ee=(n(97),function(e){var t=e.src,n=e.onChange,s=Object(c.useRef)(),a=Object(c.useRef)(),r={x:0,y:0},o=Object(c.useState)([0,0,1]),l=Object(i.a)(o,2),u=l[0],d=l[1],j=Object(c.useMemo)((function(){return{width:568,height:361}}),[]),h=Object(c.useMemo)((function(){return[0,0]}),[]),m=!1,b=function(){return(a.current.value/100+10)*u[2]*.65};Object(c.useEffect)((function(){var e=!0,c=new Image,r=s.current;return c.onload=function(){var t=Math.min(c.width,c.height),s=t/j.height;r.height=j.height*s,r.width=j.width*s,e&&d([c.width/s,c.height/s,s]);var i=r.getContext("2d");!function e(){if(r&&a.current){var s=a.current.value/100,o=c.width-c.width*s,l=c.height-c.height*s,u=t/2,d=c.width/2-u,j=c.height/2-u,m=Math.min(h[0],d+c.width*(s-1)),b=-1*m<d?m:-1*d;h[0]=b;var f=Math.min(h[1],j+c.height*(s-1)),O=-1*f<j?f:-1*j;h[1]=O;var v=[o+b+(r.width-c.width)/2,l+O+(r.height-c.height)/2];i.clearRect(0,0,r.width,r.height),i.beginPath(),i.drawImage(c,v[0],v[1],c.width*s+1,c.height*s+1),n(r),requestAnimationFrame(e)}}()},c.src=t,function(){return e=!1}}),[t,h,n,j]);var f=function(){return m=!1};return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)("div",{className:"cropper",children:[Object(v.jsx)("canvas",{style:Object(g.a)({background:"black"},j),onMouseOut:f,onMouseUp:f,onMouseDown:function(){return m=!0},onMouseMove:function(e){m&&(e.clientX>r.x&&(h[0]+=b()),e.clientX<r.x&&(h[0]-=b()),e.clientY>r.y&&(h[1]+=b()),e.clientY<r.y&&(h[1]-=b()),r.y=e.clientY,r.x=e.clientX)},ref:s}),Object(v.jsx)("div",{style:{width:Math.min(u[0],u[1]),height:Math.min(u[0],u[1])},className:"circle-border"})]}),Object(v.jsx)("input",{className:"zoom-range",defaultValue:100,ref:a,max:200,min:100,type:"range"})]})}),Ae=(n(98),function(e){var t=e.src,n=e.onComplete,s=e.cancel,a=Object(c.useState)(),r=Object(i.a)(a,2),o=r[0],l=r[1];return Object(v.jsx)(T,{children:Object(v.jsxs)("div",{className:"edit-image animated-popup",children:[Object(v.jsx)("h2",{children:"Edit Image"}),Object(v.jsx)(Ee,{style:{maxHeight:400,maxWidth:400},onChange:l,src:t}),Object(v.jsxs)("div",{className:"lower-section",children:[Object(v.jsx)("button",{style:{marginLeft:10},onClick:function(){return n(t)},className:"skip generic-button cancel",children:"Skip"}),Object(v.jsx)("button",{style:{marginLeft:"auto"},onClick:s,className:"edit-image-cancel generic-button cancel",children:"Cancel"}),Object(v.jsx)("button",{style:{marginRight:1},onClick:function(){n(o.toDataURL("image/webp"))},className:"edit-image-complete generic-button primary",children:"Apply"})]})]})})}),Le=function(e){for(var t=window.atob(e.split(",")[1]),n=new Array(t.length),c=0;c<t.length;c++)n[c]=t.charCodeAt(c);var s=new Uint8Array(n);return 71===s[0]&&73===s[1]&&70===s[2]&&56===s[3]},Re=(n(99),function(e){return new Promise((function(t,n){var c=new FileReader;c.readAsDataURL(e),c.onload=function(){var e=new Image;e.onload=function(){return t(c.result)},e.src=c.result},c.onerror=function(e){return n(e)}}))}),Te=function(e){var t=e.user,n=e.onChange,s=Object(c.useContext)(Fe).setView,a=Object(c.useState)(t.username),r=Object(i.a)(a,2),o=r[0],l=r[1];return Object(v.jsx)(T,{children:Object(v.jsxs)("div",{style:{width:450,overflow:"hidden",borderRadius:5},className:"edit-username generic-popup animated-popup",children:[Object(v.jsx)("h2",{style:{marginBottom:"0.5em"},children:"Change your username"}),Object(v.jsx)("span",{style:{color:"var(--font-secondary)",marginBottom:"0.6em"},className:"dumb-text-2",children:"Enter a new username and your current password"}),Object(v.jsxs)("form",{style:{display:"flex",flexDirection:"column",width:"100%"},children:[Object(v.jsxs)("div",{className:"content-wrapper",children:[Object(v.jsx)("label",{className:"generic-label",htmlFor:"new-username",children:"USERNAME"}),Object(v.jsx)("input",{onChange:function(e){return l(e.target.value)},autoComplete:"off",style:{marginBottom:"0.8em"},type:"text",defaultValue:t.username,id:"new-username",className:"new-username generic-input"}),Object(v.jsx)("label",{className:"generic-label",htmlFor:"current-password",children:"PASSWORD"}),Object(v.jsx)("input",{autoComplete:"off",type:"password",id:"current-password",className:"generic-input current-password"})]}),Object(v.jsxs)("div",{className:"lower-section",children:[Object(v.jsx)("button",{type:"button",className:"generic-button cancel",children:"Cancel"}),Object(v.jsx)("button",{onClick:function(e){e.preventDefault(),n((function(e){return Object.assign({},e,{username:o})})),s()},type:"submit",className:"generic-button primary",children:"Done"})]})]})]})})},De=function(e){var t=e.user,n=e.setButton,s=e.onChange,a=e.changes,r=Object(c.useContext)(Fe).setView;return Object(v.jsxs)("div",{className:"my-account",children:[Object(v.jsx)("h2",{className:"my-account-header",children:"My Account"}),Object(v.jsxs)("div",{className:"my-settings",children:[Object(v.jsx)("div",{style:{backgroundColor:t.profileColor},className:"profile-color"}),Object(v.jsxs)("div",{className:"section-17",children:[Object(v.jsxs)("div",{className:"section-721",children:[Object(v.jsxs)("div",{className:"my-avatar-wrapper",children:[Object(v.jsx)("img",{height:"80",width:"80",className:"avatar-352",src:t.displayAvatarURL(90),alt:"my-icon"}),Object(v.jsx)("div",{className:"status"})]}),Object(v.jsx)("h5",{className:"username-382",children:a.username||t.username}),Object(v.jsx)("button",{onClick:n(1),style:{marginLeft:"auto"},className:"generic-button primary button-121",children:"Edit User Profile"})]}),Object(v.jsxs)("div",{className:"section-832",children:[Object(v.jsxs)("div",{className:"username-77 flex-line",children:[Object(v.jsxs)("div",{children:[Object(v.jsx)("h5",{className:"field-title",children:"USERNAME"}),Object(v.jsxs)("div",{className:"div-410",children:[Object(v.jsx)("span",{children:a.username||t.username}),Object(v.jsx)("span",{className:"text-info",children:t.tag})]})]}),Object(v.jsx)("button",{onClick:function(){return r(Object(v.jsx)(Te,{onChange:s,user:t}))},style:{color:"var(--font-primary)",marginLeft:"auto"},className:"generic-button secondary",children:"Edit"})]}),Object(v.jsx)("div",{className:"email-10 flex-line",children:Object(v.jsxs)("div",{children:[Object(v.jsx)("h5",{className:"field-title",children:"EMAIL"}),Object(v.jsx)("div",{className:"div-410",children:t.email})]})}),Object(v.jsx)("div",{className:"phone-number-47 flex-line",children:Object(v.jsxs)("div",{children:[Object(v.jsx)("h5",{className:"field-title",children:"PHONE NUMBER"}),Object(v.jsx)("div",{className:"text-info",children:"This app doesn't support phone numbers"})]})})]})]})]})]})},Me=function(e){var t=e.user,n=e.onChange,s=e.changes,a=Object(c.useContext)(Fe),r=a.setView,o=a.user,d=Object(c.useState)(t.displayAvatarURL(90)),j=Object(i.a)(d,2),h=j[0],m=j[1],b=Object(c.useState)(t.profileColor),f=Object(i.a)(b,2),O=f[0],x=f[1],p=Object(c.useRef)(),g=Object(c.useRef)(),N=function(){var e=Object(u.a)(l.a.mark((function e(c){var s,a,i,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=c.target.files[0],e.next=3,Re(s).catch((function(){return 0}));case 3:if(a=e.sent,c.target.value="",a){e.next=7;break}return e.abrupt("return");case 7:if(!Le(a)){e.next=10;break}return n((function(e){return Object.assign({},e,{src:a})})),e.abrupt("return",m(a));case 10:a&&(i=function(e){r(),m(e),n((function(t){return Object.assign({},t,{src:e})}))},o=function(){r(),m(t.displayAvatarURL(150))},r(Object(v.jsx)(Ae,{src:a,cancel:o,onComplete:i})));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){var e=new oe(o);s.src||m(e.displayAvatarURL(80)),s.profileColor||x(e.profileColor)}),[s,o]);return Object(v.jsxs)("div",{className:"user-profile",children:[Object(v.jsx)("h2",{className:"my-account-header",children:"User Profile"}),Object(v.jsxs)("div",{className:"section-559",children:[Object(v.jsxs)("div",{className:"section-560",children:[Object(v.jsxs)("div",{className:"section-700",children:[Object(v.jsx)("h5",{className:"preview-2",children:"AVATAR"}),Object(v.jsx)("button",{onClick:function(){var e;return null===(e=p.current)||void 0===e?void 0:e.click()},style:{marginLeft:0},className:"generic-button primary",children:"Change Avatar"})]}),Object(v.jsxs)("div",{className:"user-color",children:[Object(v.jsx)("h5",{className:"preview-2",children:"PROFILE COLOR"}),Object(v.jsxs)("div",{className:"profile-color-selector",children:[Object(v.jsxs)("div",{className:"profile-color-option",children:[Object(v.jsx)("div",{onClick:function(){return n((function(e){return Object.assign({},e,{profileColor:"#000"})}))},className:"default-profileColor"}),Object(v.jsx)("span",{children:"Default"})]}),Object(v.jsxs)("div",{className:"profile-color-option",children:[Object(v.jsx)("div",{onClick:function(){var e;return null===(e=g.current)||void 0===e?void 0:e.click()},style:{backgroundColor:O},className:"custom-profileColor",children:Object(v.jsx)("input",{defaultValue:t.profileColor,onChange:function(e){x(e.target.value),n((function(t){return Object.assign({},t,{profileColor:e.target.value})}))},ref:g,style:{visibility:"hidden"},type:"color"})}),Object(v.jsx)("span",{children:"Custom"})]})]})]})]}),Object(v.jsxs)("div",{className:"section-561",children:[Object(v.jsx)("h5",{className:"preview-2",children:"PREVIEW"}),Object(v.jsx)(ae,{onClick:function(){var e;return null===(e=p.current)||void 0===e?void 0:e.click()},editable:!0,style:{position:"relative",animation:"none"},user:Object.assign({},t,{displayAvatarURL:function(){return h},profileColor:O})})]}),Object(v.jsx)("input",{accept:"image/gif,image/png,image/jpeg,image/webp",style:{display:"none"},ref:p,onChange:N,type:"file"})]})]})},Ie=function(){var e=Object(c.useContext)(Fe).setTheme,t=Object(c.useState)(localStorage.getItem("theme")||"light"),n=Object(i.a)(t,2),s=n[0],a=n[1],r=function(t){return function(){e(t),localStorage.setItem("theme",t),a(t)}};return Object(v.jsxs)("div",{children:[Object(v.jsx)("h2",{className:"my-account-header",children:"Appearance"}),Object(v.jsx)("h5",{className:"preview-2",children:"THEME"}),Object(v.jsxs)("div",{className:"check-list",children:[Object(v.jsxs)("div",{className:"check",onClick:r("dark"),children:[Object(v.jsx)("div",{className:"checker ".concat("dark"!==s&&"unchecked")}),Object(v.jsx)("h5",{className:"generic-header-5",children:"Dark"})]}),Object(v.jsxs)("div",{className:"check",onClick:r("light"),children:[Object(v.jsx)("div",{className:"checker ".concat("light"!==s&&"unchecked")}),Object(v.jsx)("h5",{className:"generic-header-5",children:"Light"})]})]})]})},Ue=function(e){var t=e.componentId,n=e.user,c=e.setButton,s=e.onChange,a=e.changes;switch(t){case 0:return Object(v.jsx)(De,{changes:a,onChange:s,setButton:c,user:n});case 1:return Object(v.jsx)(Me,{changes:a,onChange:s,user:n});case 2:return Object(v.jsx)(Ie,{});default:return null}};var ze=function(){var e=Object(c.useContext)(Fe),t=e.setShowSettings,n=e.setUser,s=e.user,a=Object(c.useMemo)((function(){return new oe(s)}),[s]),r=Object(c.useState)({}),o=Object(i.a)(r,2),l=o[0],u=o[1],d=Object(c.useState)(0),j=Object(i.a)(d,2),h=j[0],m=j[1],b=Object(c.useState)(""),f=Object(i.a)(b,2),O=f[0],x=f[1],p=Object(c.useContext)(Je),g=function(e){return function(){return!Object.keys(l).length&&m(e)}},w=function(e){return"generic-button ".concat(e===h&&"clicked")};return Object(v.jsxs)("div",{className:"settings ".concat(O),children:[Object(v.jsx)("div",{className:"settings-left",children:Object(v.jsx)("div",{className:"scrollable-content",children:Object(v.jsx)("nav",{className:"navigate-settings",children:Object(v.jsxs)("div",{children:[Object(v.jsx)("h5",{className:"generic-label header-82",children:"USER SETTINGS"}),Object(v.jsx)("button",{onClick:g(0),className:w(0),children:"My Account"}),Object(v.jsx)("button",{onClick:g(1),className:w(1),children:"User Profile"}),Object(v.jsx)("div",{className:"seperator"}),Object(v.jsx)("h5",{className:"generic-label header-82",children:"APP SETTINGS"}),Object(v.jsx)("button",{onClick:g(2),className:w(2),children:"Appearance"}),Object(v.jsx)("button",{onClick:function(){return p(Object(v.jsx)(He,{update:p}))},className:"generic-button error",children:"Logout"})]})})})}),Object(v.jsxs)("div",{className:"main-content",children:[Object(v.jsxs)("div",{className:"parameters",children:[Object(v.jsx)(Ue,{changes:l,onChange:u,setButton:g,componentId:h,user:a}),Object(v.jsx)("div",{className:"edit-check",children:Object(v.jsx)("div",{style:{overflow:"hidden"},children:Object(v.jsxs)("div",{className:"confirm-edit ".concat(!!Object.keys(l).length&&"is-edited"),children:[Object(v.jsx)("span",{className:"dumb-text",children:"Careful - you have unsaved changes!"}),Object(v.jsx)("button",{onClick:function(){return u({})},className:"reset generic-button cancel",children:"Reset"}),Object(v.jsx)("button",{className:"generic-button success",onClick:function(){Object.keys(l).length&&a.edit(l.username,l.src,l.profileColor).then((function(e){n(Object.assign({},a,e)),u({})}))},children:"Save Changes"})]})})})]}),Object(v.jsx)("div",{onClick:function(){x("is-being-removed"),t(""),setTimeout((function(){return t(!1)}),150)},className:"return",children:Object(v.jsx)(N,{size:17})})]})]})},Fe=Object(c.createContext)(),_e=Object(ke.io)(d.a,{transports:["websocket","polling","flashsocket"]}),Pe=new Audio("./notification.mp3"),Ve=function(e){var t,n=e.user,s=e.update,a=e.dm,r=Object(c.useState)(!1),o=Object(i.a)(r,2),l=o[0],u=o[1],d=Object(c.useState)(n),h=Object(i.a)(d,2),m=h[0],b=h[1],f=Object(c.useState)(),p=Object(i.a)(f,2),g=p[0],N=p[1];null===(t=m.notifications)||void 0===t||t.forEach((function(e){return e.saved=!0}));var w=Object(c.useState)(m.notifications||[]),y=Object(i.a)(w,2),k=y[0],C=y[1],S=Object(c.useState)(m.servers),E=Object(i.a)(S,2),A=E[0],L=E[1];Object(c.useEffect)((function(){return _e.connect(),_e.emit("online",n.token),_e.on("disconnect",(function(){s(Object(v.jsx)(He,{update:s}))})),_e.on("notification",(function(e){Pe.play(),"dm"===e.type&&C((function(t){return[].concat(Object(j.a)(t),[e])}))})),_e.on("leave",(function(e){N(),b((function(t){return Object.assign(t,{servers:Object(j.a)(t.servers).filter((function(t){return t._id!=="".concat(e._id)}))})})),L((function(t){return Object(j.a)(t).filter((function(t){return t._id!=="".concat(e._id)}))}))})),_e.on("channelCreate",(function(e){L((function(t){var n=Object(j.a)(t);return n.find((function(t){return t._id===e.server})).channels.push(e),n}))})),function(){_e.off("disconnect").off("notification").off("channelCreate"),_e.disconnect(),O.clear()}}),[n,s]);var R=Object(c.useState)(localStorage.getItem("theme")||"light"),T=Object(i.a)(R,2),D=T[0],M=T[1],I=Object(c.useState)(Object(v.jsx)(ee,{user:m,update:s})),U=Object(i.a)(I,2),z=U[0],F=U[1],_=function(e,t){e.servers.push(t),L(e.servers);var n=new x(t,e);N(n)},P=function(e){return _(m,e)},V=Object(c.useState)(),B=Object(i.a)(V,2),H=B[0],J=B[1];Object(c.useEffect)((function(){var e=function(e){return _(m,e)};return F(g?Object(v.jsx)(ye,{socket:_e,onJoin:e,update:s,server:g,user:m}):Object(v.jsx)(ee,{onJoin:e,dm:a,user:m,update:s})),_e.on("serverUpdate",(function(e){L((function(t){var n=Object(j.a)(t),c=n.find((function(t){return t._id===e._id.toString()}));return c.icon=e.icon,c.name=e.name,n}))})),function(){return _e.off("serverUpdate")}}),[g,s,m,a]);var q={setScreen:F,setServer:N,setUser:b,not:[k,C],user:m,setTheme:M,setView:J,setShowSettings:u};return Object(v.jsx)(Fe.Provider,{value:q,children:Object(v.jsxs)("div",{className:"platform ".concat(l&&"is-showing-settings"," ").concat(D),children:[H,(l||""===l)&&Object(v.jsx)(ze,{user:new oe(m)}),Object(v.jsxs)("div",{className:"screen",children:[Object(v.jsxs)("nav",{className:"navigate",children:[Object(v.jsxs)("div",{style:{marginTop:10,marginBottom:3},className:"server-block ".concat(!g&&"clicked"),children:[Object(v.jsx)("div",{title:"Home",className:"server",children:Object(v.jsx)("div",{onClick:function(){return g&&N()},className:"home-button server-icon ".concat(!g&&"isclicked"),children:Object(v.jsx)(Ce,{})})}),Object(v.jsx)("div",{className:"server-marker"})]}),k.map((function(e,t){var n=new oe(e.user);if(k.findIndex((function(e){return e.user._id===n.id}))!==t)return null;return Object(v.jsxs)("div",{className:"server-block",children:[Object(v.jsxs)("div",{className:"server nt ".concat(!e.saved&&"nta"),children:[Object(v.jsx)("img",{onClick:function(){N(),F(Object(v.jsx)(ee,{onJoin:function(e){return P(m)},update:s,dm:{user:n},user:m}))},width:"48",height:"48",alt:"icon",src:n.displayAvatarURL(90),className:"server-icon"}),Object(v.jsx)("div",{className:"notification",children:k.filter((function(e){return e.user._id===n.id})).length})]}),Object(v.jsx)("div",{className:"server-marker"})]},n.id)})),Object(v.jsx)("div",{className:"border-bottom"}),Object(v.jsx)(x.LoadServers,{index:function(){var e=m.servers.find((function(e){return e._id===(null===g||void 0===g?void 0:g.id)}));return m.servers.indexOf(e)}(),me:m,servers:A,click:function(e){(null===g||void 0===g?void 0:g.id)!==e.id&&N(e)},isHome:!g}),Object(v.jsx)(Se,{user:m,onCreate:P,view:J})]}),z]})]})})};var Be=function(e){var t=e.update,n=Object(c.useState)(""),s=Object(i.a)(n,2),a=s[0],r=s[1],o=Object(c.useState)(""),j=Object(i.a)(o,2),h=j[0],m=j[1],b=Object(c.useRef)(),f=Object(c.useRef)(),O=Object(c.useRef)(),x=Object(c.useRef)();return Object(v.jsxs)("div",{className:"login signup ".concat(a),children:[Object(v.jsx)("h2",{className:"login-text signup-text",children:"Create an account"}),Object(v.jsxs)("form",{name:"sign-up",children:[Object(v.jsx)("input",{autoComplete:"off",ref:b,className:"login-input username",placeholder:"Username"}),Object(v.jsx)("input",{autoComplete:"email",ref:O,className:"login-input signup-email",placeholder:"Email"}),Object(v.jsx)("input",{autoComplete:"off",ref:f,className:"login-input signup-password",type:"password",placeholder:"Password"}),Object(v.jsx)("input",{autoComplete:"off",type:"password",ref:x,className:"login-input confirm",placeholder:"Confirm password"}),Object(v.jsxs)("p",{className:"no-account",children:["Already have an account? ",Object(v.jsx)("span",{onClick:function(){r("shrink-me"),setTimeout((function(){return t(Object(v.jsx)(He,{update:t}))}),200)},children:"login"})]}),Object(v.jsx)("button",{onClick:function(e){if(e.preventDefault(),f.current.value!==x.current.value)return m("Passwords don't match");fetch("".concat(d.a,"createuser"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:b.current.value,email:O.current.value,password:f.current.value})}).then((function(e){return e.json()})).catch((function(e){console.log(e),m("Error")})).then(function(){var e=Object(u.a)(l.a.mark((function e(n){var c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.error){e.next=2;break}return e.abrupt("return",m(n.error));case 2:return e.next=4,fetch("".concat(d.a,"user?password=").concat(n.password,"&email=").concat(n.email)).then((function(e){return e.json()}));case 4:c=e.sent,sessionStorage.setItem("user",JSON.stringify(c)),t(Object(v.jsx)(Ve,{user:c}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},className:"button-login sign-up",children:"Create an account"})]}),Object(v.jsx)("p",{className:"error-message",children:h})]})};var He=function(e){var t=e.update,n=Object(c.useState)(""),s=Object(i.a)(n,2),a=s[0],r=s[1],o=Object(c.useState)(""),l=Object(i.a)(o,2),u=l[0],j=l[1],h=Object(c.useRef)(),m=Object(c.useRef)();return Object(v.jsxs)("div",{className:"login ".concat(a),children:[Object(v.jsx)("h2",{className:"login-text",children:"Login to continue"}),Object(v.jsxs)("form",{name:"login",children:[Object(v.jsx)("input",{id:"email",ref:m,className:"login-input email",required:!0,autoComplete:"on",type:"email",placeholder:"Email"}),Object(v.jsx)("input",{id:"password",ref:h,autoComplete:"on",required:!0,className:"login-input password",type:"password",placeholder:"Password"}),Object(v.jsxs)("p",{className:"no-account",children:["Don't have an account? ",Object(v.jsx)("span",{onClick:function(){r("expand-me"),setTimeout((function(){return t(Object(v.jsx)(Be,{update:t}))}),200)},children:"create one"})]}),Object(v.jsx)("button",{type:"submit",onClick:function(e){e.preventDefault(),h.current.value&&m.current.value&&(r("waiting"),fetch("".concat(d.a,"user?password=").concat(h.current.value,"&email=").concat(m.current.value)).then((function(e){return e.json()})).then((function(e){if(e.error)return j(e.error);r("expand-all"),setTimeout((function(){return t(Object(v.jsx)(Ve,{user:e,update:t}))}),300)})).catch((function(e){r(""),j(e.toString())})))},className:"button-login sign-up",children:"Login"})]}),Object(v.jsx)("p",{className:"error-message",children:u})]})},Je=(n(100),Object(c.createContext)());var qe=function(){var e=Object(c.useState)(Object(v.jsx)(a,{})),t=Object(i.a)(e,2),n=t[0],s=t[1];function a(){return Object(v.jsx)(He,{update:s})}return Object(v.jsx)(Je.Provider,{value:s,children:Object(v.jsxs)("div",{className:"main",children:[Object(v.jsx)("a",{className:"github-link",href:"https://github.com/uwu404/discord-clone-client",children:"view source code"}),n]})})};r.a.render(Object(v.jsx)(s.a.StrictMode,{children:Object(v.jsx)(qe,{})}),document.getElementById("root"))},4:function(e){e.exports=JSON.parse('{"a":"https://discordbotyes.herokuapp.com/"}')},49:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){},57:function(e,t,n){},58:function(e,t,n){},59:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){},63:function(e,t,n){},64:function(e,t,n){},96:function(e,t,n){},97:function(e,t,n){},98:function(e,t,n){},99:function(e,t,n){}},[[101,1,2]]]);
//# sourceMappingURL=main.f39500e9.chunk.js.map