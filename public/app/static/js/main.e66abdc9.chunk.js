(this["webpackJsonpreact-chat-app"]=this["webpackJsonpreact-chat-app"]||[]).push([[0],{100:function(e,t,n){},101:function(e,t,n){},102:function(e,t,n){},103:function(e,t,n){"use strict";n.r(t);var c=n(1),s=n.n(c),a=n(44),r=n.n(a),i=n(2),o=(n(53),n(3)),l=n.n(o),u=n(5),d=(n(55),n(4)),j=n(6),h=n(13),b=n(14),m=(n(56),n(20)),f={message:function(e,t){e((function(e){return[].concat(Object(j.a)(e),[t])}))},memberOnline:function(e,t){e((function(e){var n=Object(j.a)(e),c=n.find((function(e){return e._id===t.user}));return c&&(c.online=t.online),n}))},memberUpdate:function(e,t,n){t((function(e){var t=Object(j.a)(e);return t.forEach((function(e){if("".concat(n._id)===e.author._id){var t=Object.assign(e.author,n);e.author=t}})),t})),e((function(e){var t=Object(j.a)(e);return t.forEach((function(e){"".concat(n._id)===e._id&&(e=Object.assign(e,n))})),t}))},messageEdit:function(e,t){e((function(e){var n=Object(j.a)(e),c=n.find((function(e){return e._id===t._id}));return n[n.indexOf(c)]=Object.assign(c,t),n}))},messageDelete:function(e,t){e((function(e){return Object(j.a)(e).filter((function(e){return e._id!==t._id}))}))}},O=new Map,v=function(e,t){"channels"===t&&function(e){var t,n=Object(m.a)(e);try{for(n.s();!(t=n.n()).done;){var c=t.value;O.has(c.author._id)||O.set(c.author._id,c.author)}}catch(s){n.e(s)}finally{n.f()}}(e),"serverMembers"!==t&&"logs"!==t||function(e){var t,n=Object(m.a)(e);try{for(n.s();!(t=n.n()).done;){var c=t.value;O.has(c._id)||O.set(c._id,c)}}catch(s){n.e(s)}finally{n.f()}}(e)},x={channels:{},serverMembers:{},logs:[],setLogs:function(e){if("function"===typeof e)return v(e(x.logs||[]),"serverMembers"),x.logs=e(x.logs||[]);v(e,"serverMembers"),x.logs=e},at:function(e,t){var n=this;return function(c){var s=Object.keys(n.channels);if(s.length>9&&delete n.channels[s[Math.floor(Math.random()*s.length)]],"function"===typeof c)return v(c(n[e][t]||[]),e),n[e][t]=Object(j.a)(new Set(c(n[e][t]||[])));v(c,e),n[e][t]=c}},init:function(){var e=this,t=function(e){var t=x.at("channels",e.channel);f.message(t,e)},n=function(t){var n=Object.keys(e.channels).find((function(n){return e.channels[n].some((function(e){return e._id===t._id}))}));if(n){var c=x.at("channels",n);f.messageDelete(c,t)}},c=function(t){var n=Object.keys(e.channels).find((function(n){return e.channels[n].some((function(e){return e._id===t._id}))}));n&&function(e){var n=x.at("channels",e);f.messageEdit(n,t)}(n)},s=function(t){var n=Object.keys(e.channels),c=t.dmFor.find((function(e){return n.includes(e)})),s=x.at("channels",c);f.message(s,t)},a=function(e){if(O.has(e._id)){var t=O.get(e._id);O.set(e._id,Object.assign(t,e))}},r=function(e){O.has(e.user)&&(O.get(e.user).online=e.online)},i=function(){return e.clear()};return Ke.on("message",t),Ke.on("messageDelete",n),Ke.on("dm",s),Ke.on("messageEdit",c),Ke.on("memberUpdate",a),Ke.on("online",r),Ke.on("disconnect",i),function(){Ke.off("message",t).off("messageDelete",n).off("dm",s).off("messageEdit",c).off("memberUpdate",a).off("online",r).off("disconnect",i)}},clear:function(){this.channels={},this.logs=[],this.serverMembers={}},userCache:O},p=x,g=n(0),N=function(){function e(t,n){for(var c in Object(h.a)(this,e),t)this[c]=t[c];this.id=t._id,this.me=n}return Object(b.a)(e,[{key:"displayIcon",value:function(e,t){return this.icon?"".concat(d.a+this.icon,"?").concat(e?"width=".concat(e,"&height=").concat(t||e):""):"".concat(d.a,"images/default")}},{key:"toJSX",value:function(e,t){return Object(g.jsxs)("div",{className:"server-block ".concat(e&&"clicked"),children:[Object(g.jsx)("div",{title:this.name,tabIndex:"0",role:"button",className:"server",children:this.icon?Object(g.jsx)("img",{width:"48",height:"48",onClick:t,alt:"icon",src:this.displayIcon(100),className:"server-icon"}):Object(g.jsx)("div",{onClick:t,style:{width:48,height:48},className:"server-icon default-no-img-div",children:this.name[0]})}),Object(g.jsx)("div",{className:"server-marker"})]},this.id)}},{key:"fetchMembers",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!p.serverMembers[this.id]){e.next=2;break}return e.abrupt("return",p.serverMembers[this.id]);case 2:return e.next=4,fetch("".concat(d.a,"servers/").concat(this.id,"/members"),{headers:{Authorization:this.me.token}}).then((function(e){return e.json()})).catch((function(){return[]}));case 4:return t=e.sent,p.at("serverMembers",this.id)(t),e.abrupt("return",t);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}],[{key:"LoadServers",value:function(t){var n=t.servers,c=t.click,s=t.isHome,a=t.me,r=t.index;return n.map((function(t,n){var i=new e(t,a);return i.toJSX(r===n&&!s,(function(){c(i)}))})).reverse()}}]),e}(),y=(n(58),n(59),n(60),n(7)),w=function(e){return Object(g.jsx)("svg",Object(y.a)(Object(y.a)({},e),{},{fill:"currentColor",width:e.size,height:e.size,version:"1.1",id:"Capa_1",x:"0px",y:"0px",viewBox:"0 0 60.364 60.364",children:Object(g.jsx)("g",{children:Object(g.jsx)("path",{d:"M54.454,23.18l-18.609-0.002L35.844,5.91C35.845,2.646,33.198,0,29.934,0c-3.263,0-5.909,2.646-5.909,5.91v17.269\r L5.91,23.178C2.646,23.179,0,25.825,0,29.088c0.002,3.264,2.646,5.909,5.91,5.909h18.115v19.457c0,3.267,2.646,5.91,5.91,5.91\r c3.264,0,5.909-2.646,5.91-5.908V34.997h18.611c3.262,0,5.908-2.645,5.908-5.907C60.367,25.824,57.718,23.178,54.454,23.18z"})})}))},k=(n(61),function(){return Object(g.jsxs)("div",{className:"skeleton",children:[Object(g.jsx)("div",{className:"skeleton-pfp"}),Object(g.jsx)("div",{style:{width:Math.floor(100*Math.random())+100},className:"skeleton-username"}),Object(g.jsxs)("div",{children:[Object(g.jsx)("div",{style:{width:"calc(20% - 70px/4)"},className:"skeleton-content-1 sl"}),Object(g.jsx)("div",{style:{width:"calc(30% - 70px/4)"},className:"skeleton-content-2 sl"}),Object(g.jsx)("div",{style:{width:"calc(15% - 70px/4)"},className:"skeleton-content-3 sl"}),Object(g.jsx)("div",{style:{width:"calc(25% - 70px/4)"},className:"skeleton-content-4 sl"})]}),Math.random()<.4&&Object(g.jsxs)("div",{className:"random-sl",children:[Object(g.jsx)("div",{style:{width:"calc(25% - 70px/4)",display:"inline-block"},className:"skeleton-content-1 sl"}),Object(g.jsx)("div",{style:{width:"calc(20% - 70px/4)",display:"inline-block"},className:"skeleton-content-2 sl"}),Object(g.jsx)("div",{style:{width:"calc(30% - 70px/4)",display:"inline-block"},className:"skeleton-content-3 sl"}),Object(g.jsx)("div",{style:{width:"calc(15% - 70px/4)",display:"inline-block"},className:"skeleton-content-4 sl"})]}),Math.random()<.1&&Object(g.jsx)("div",{className:"skeleton-content-a"})]})});function C(){return Object(j.a)(Array(20)).map((function(e,t){return Object(g.jsx)(k,{},t)}))}var S=n(23),E=["renderId","placeholder","defaultValue","innerRef","onPaste","onKeyDown"],A=function(e,t){var n=0,c=document.createRange();c.setStart(e,0),c.collapse(!0);for(var s,a=[e],r=!1,i=!1;!i&&(s=a.pop());)if(3===s.nodeType){var o=n+s.length;!r&&t.start>=n&&t.start<=o&&(c.setStart(s,t.start-n),r=!0),r&&t.end>=n&&t.end<=o&&(c.setEnd(s,t.end-n),i=!0),n=o}else for(var l=s.childNodes.length;l--;)a.push(s.childNodes[l]);var u=window.getSelection();u.removeAllRanges(),u.addRange(c)},L=function e(t){var n;if(t)return"auto"===(null===(n=t.style)||void 0===n?void 0:n.overflowY)||t.scrollHeight>t.clientHeight?t:e(t.parentNode)},R=function(e){var t=e.renderId,n=e.placeholder,s=e.defaultValue,a=e.innerRef,r=e.onPaste,i=e.onKeyDown,o=Object(S.a)(e,E),l=Object(c.useRef)(),u=function(e,t){var n=function(e,t){var n=window.getSelection().getRangeAt(0),c=n.cloneRange();c.selectNodeContents(e),c.setEnd(n.startContainer,n.startOffset);var s="".concat(c).length;return{start:s+t.length,end:s+"".concat(n).length+t.length,pos:[s,"".concat(n).length+s]}}(e,t);e.textContent=e.textContent.slice(0,n.pos[0])+t+e.textContent.slice(n.pos[1]),A(e,n)},d=function(e){var t=L(e);t&&(t.scrollTop=t.scrollHeight)};return Object(c.useEffect)((function(){var e=l.current.lastChild;e.focus(),A(e,{start:e.textContent.length,end:e.textContent.length})}),[t]),Object(g.jsx)("div",Object(y.a)(Object(y.a)({ref:l,className:"not-input",onPaste:function(e){e.preventDefault();var t=e.clipboardData.getData("text");t&&u(e.target,t),null===r||void 0===r||r(e),d(e.target)},onDrop:function(e){e.preventDefault();var t=e.dataTransfer.getData("text/plain");e.target.textContent=e.target.textContent+t,A(e.target,{start:e.target.textContent.length-t.length,end:e.target.textContent.length}),d(e.target)},onKeyDown:function(e){"Backspace"===e.code&&e.target.textContent.length<=1&&(e.target.innerHTML=""),"z"===e.key&&e.ctrlKey&&!e.shiftKey||"Enter"===e.code&&e.shiftKey||(null===i||void 0===i||i(e),d(e.target))},role:"textbox"},o),{},{children:Object(g.jsx)("div",{ref:a,suppressContentEditableWarning:!0,placeholder:n,contentEditable:"true",className:"plain-text",children:s})}))},T=function(e){var t=e.width,n=e.height;return Object(g.jsx)("svg",{fill:"currentColor",width:t,height:n,x:"0px",y:"0px",viewBox:"0 0 512 512",children:Object(g.jsx)("g",{children:Object(g.jsx)("g",{children:Object(g.jsx)("path",{d:"M495.304,205.913h-45.519c-4.73-18.267-11.996-35.493-21.382-51.291l33.961-33.961c6.487-6.492,6.516-17.095,0-23.611\r L414.95,49.633c-6.521-6.521-17.093-6.521-23.613,0l-33.959,33.961c-15.797-9.385-33.024-16.649-51.291-21.382V16.696\r C306.087,7.477,298.572,0,289.391,0h-66.783c-9.18,0-16.696,7.477-16.696,16.696v45.517c-18.265,4.73-35.493,11.992-51.291,21.379\r l-33.959-33.959c-6.521-6.521-17.093-6.521-23.613,0L49.635,97.05c-6.521,6.52-6.52,17.089,0,23.611l33.961,33.961\r c-9.385,15.799-16.651,33.024-21.382,51.291H16.696C7.515,205.913,0,213.39,0,222.609v66.783c0,9.214,7.482,16.693,16.696,16.693\r h45.519c4.73,18.267,11.996,35.493,21.382,51.291l-33.961,33.961c-6.521,6.52-6.52,17.089,0,23.611l47.415,47.417\r c6.527,6.527,17.084,6.525,23.613,0l33.959-33.959c15.797,9.387,33.026,16.647,51.291,21.379v45.519\r c0,9.214,7.482,16.696,16.696,16.696h66.783c9.157,0,16.696-7.463,16.696-16.696v-45.519c18.265-4.73,35.493-11.992,51.291-21.379\r l33.959,33.959c6.527,6.527,17.084,6.525,23.613,0l47.415-47.417c6.487-6.492,6.516-17.095,0-23.611l-33.961-33.961\r c9.385-15.799,16.651-33.024,21.382-51.291h45.519c9.214,0,16.696-7.481,16.696-16.693v-66.783\r C512,213.447,504.54,205.913,495.304,205.913z M256,339.476c-46.08-0.029-83.449-37.396-83.478-83.476\r c0.029-46.082,37.398-83.449,83.478-83.478c46.08,0.029,83.449,37.396,83.478,83.478C339.449,302.08,302.08,339.448,256,339.476z"})})})})};var D={Out:function(e){var t=e.click,n=e.children,s=e.getEvent,a=Object(c.useRef)(null);return function(e,t,n){Object(c.useEffect)((function(){function c(c){if(e.current&&!e.current.contains(c.target)){if(n)return t(c);null===t||void 0===t||t()}}return document.addEventListener("mousedown",c),function(){document.removeEventListener("mousedown",c)}}),[e,t,n])}(a,t,s),Object(g.jsx)("div",{className:"outer-div",ref:a,children:n})},isScolled:function(e,t){t=t||document.body;var n=e.getBoundingClientRect(),c=n.top,s=n.bottom,a=n.height,r=t.getBoundingClientRect();return c<=r.top?r.top-c<=a:s-r.bottom<=a}},M=function(e){var t=Object(c.useState)(1===e.type?"taller":"bigger"),n=Object(i.a)(t,2),s=n[0],a=n[1],r=Object(c.useContext)(qe).setView;return Object(g.jsx)("div",{className:"".concat(e.normal?"clear-div":"dark-div"," ").concat(s),children:Object(g.jsx)(D.Out,{click:function(){var t;a(1===e.type?"shorter":"smaller"),setTimeout((function(){return r()}),100),null===(t=e.quit)||void 0===t||t.call(e)},children:e.children})})},z=(n(62),function(){var e=Object(c.useContext)(qe),t=e.user,n=e.setView,s=Object(c.useRef)(),a=Object(c.useRef)();return Object(g.jsx)(M,{children:Object(g.jsxs)("div",{className:"generic-popup animated-popup custom-status",children:[Object(g.jsx)("h2",{className:"h2-82",children:"Set a custom status"}),Object(g.jsxs)("form",{className:"set-custom-status",onSubmit:function(e){e.preventDefault(),a.current.click()},children:[Object(g.jsxs)("label",{htmlFor:"9288",className:"generic-label",children:["WHAT'S COOKIN', ",t.username.toUpperCase()]}),Object(g.jsx)("input",{ref:s,style:{marginBottom:15},type:"text",id:"9288",className:"generic-input",placeholder:"Support has arrived!"}),Object(g.jsx)("label",{htmlFor:"8292",className:"generic-label",children:"CLEAR AFTER"}),Object(g.jsx)("select",{className:"generic-input",id:"8292",children:Object(g.jsx)("option",{children:"Don't clear"})})]}),Object(g.jsxs)("div",{className:"lower-section",children:[Object(g.jsx)("button",{onClick:function(){return n()},type:"button",className:"generic-button cancel",children:"Cancel"}),Object(g.jsx)("button",{ref:a,onClick:function(){!function(e,t){fetch("".concat(d.a,"customstatus"),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:e.token},body:JSON.stringify({customStatus:t})})}(t,s.current.value),n()},type:"submit",className:"generic-button primary",children:"Save"})]})]})})}),I=function(){var e=Object(c.useContext)(qe),t=e.user,n=e.setView,s=new Oe(t);return Object(g.jsx)(M,{normal:!0,type:1,children:Object(g.jsx)("div",{style:{width:220,left:84,bottom:62,transformOrigin:"bottom center"},className:"status-manager generic-menu animated-popup",children:Object(g.jsx)("div",{onClick:function(){return n(Object(g.jsx)(z,{}))},className:"current-status option",children:s.customStatus?s.customStatus:"Set a custom status"})})})},U=["src","status","className","size"],_=function(e){var t=e.status,n=e.size,c=n<60?22:n<100?60:88,s=n<60?10:n<100?16:24,a=n<60?2.5:n<100?4:6;switch(t){case"online":return Object(g.jsx)("rect",{width:s,height:s,x:c,y:c,fill:"var(--green)",rx:"200"});default:return Object(g.jsx)("circle",{r:s/2-a/2,cx:c+s/2,cy:c+s/2,strokeWidth:a,stroke:"var(--font-secondary)",fill:"transparent"})}},F=function(e){var t=e.src,n=e.status,c=e.className,s=e.size,a=Object(S.a)(e,U),r=s<60?32:s<100?80:120;return Object(g.jsxs)("svg",Object(y.a)(Object(y.a)({},a),{},{height:s,width:s,children:[Object(g.jsx)("foreignObject",{className:"user-av ".concat(c),height:s,width:s,y:"0",x:"0",mask:"url(#mask-round-".concat(r,")"),children:Object(g.jsx)("img",{style:{width:s,height:s},className:"avatar-icon",alt:"avatar",src:t})}),Object(g.jsx)(_,{size:s,status:n})]}))},P=function(){var e=Object(c.useContext)(qe),t=e.user,n=e.setView,s=e.setShowSettings,a=new Oe(t);return Object(g.jsxs)("footer",{className:"footer",children:[Object(g.jsx)("div",{className:"icon-div",children:Object(g.jsx)(F,{onClick:function(){return n(Object(g.jsx)(I,{}))},className:"my-pfp",status:"online",src:a.displayAvatarURL(90),size:32})}),Object(g.jsxs)("h5",{className:"my-username",children:[a.username,Object(g.jsx)("span",{children:a.tag})]}),Object(g.jsx)("div",{title:"User Settings",onClick:function(){return s(!0)},className:"settings-button",children:Object(g.jsx)(T,{width:17,height:17})})]})},B=function(e){var t=e.invite,n=e.code,s=e.onJoin,a=e.me,r=new N(t),o=a.servers.find((function(e){return e._id===r.id}))?"Joined":"Join",l=Object(c.useState)(o),u=Object(i.a)(l,2),j=u[0],h=u[1];return Object(g.jsxs)("div",{className:"message-invite",children:[Object(g.jsx)("img",{width:"40",height:"40",className:"server-invite-icon",src:r.displayIcon(57),alt:"icon"}),Object(g.jsxs)("div",{className:"name-and-members",children:[Object(g.jsx)("h4",{className:"server-invite-name",children:r.name}),Object(g.jsxs)("div",{className:"member-count",children:[t.members.length," member",1!==t.members.length&&"s"]})]}),Object(g.jsx)("button",{onClick:function(){"Joined"!==o&&"..."!==j&&(h("..."),fetch("".concat(d.a,"servers/").concat(n),{method:"POST",headers:{Authorization:a.token}}).then((function(e){return e.json()})).then((function(e){h("Joined"),s(e)})))},className:"server-invite-join",children:j})]})};var V=function(e){var t=e.size;return Object(g.jsxs)("svg",{width:t,height:t,viewBox:"0 0 24 24",children:[Object(g.jsx)("rect",{id:"view-box",width:"24",height:"24",fill:"currentColor",opacity:"0"}),Object(g.jsx)("path",{id:"Shape",d:"M12,1.5A1.5,1.5,0,1,1,13.5,3,1.5,1.5,0,0,1,12,1.5Zm-6,0A1.5,1.5,0,1,1,7.5,3,1.5,1.5,0,0,1,6,1.5Zm-6,0A1.5,1.5,0,1,1,1.5,3,1.5,1.5,0,0,1,0,1.5Z",transform:"translate(4.5 11)",fill:"currentColor"})]})},H=function(e){var t=e.message,n=e.onCancel;return Object(g.jsx)(M,{children:Object(g.jsxs)("div",{className:"dlt animated-popup",children:[Object(g.jsx)("h2",{className:"some-text",children:"Delete message"}),Object(g.jsx)("h4",{className:"dumb-question",children:"Are you sure you want to delete this message?"}),Object(g.jsx)("div",{className:"preview-message",children:Object(g.jsx)(W,{full:!0,message:t})}),Object(g.jsxs)("div",{className:"lower-section",children:[Object(g.jsx)("button",{onClick:n,className:"generic-button cancel",children:"Cancel"}),Object(g.jsx)("button",{className:"generic-button error",onClick:function(){t.delete(),n()},children:"Delete"})]})]})})},J=function(e){var t=e.style,n=e.message,s=e.clickOut,a=e.edit,r=Object(c.useContext)(qe),o=r.user,l=r.setView,u=Object(c.useState)(t.top),d=Object(i.a)(u,2),j=d[0],h=d[1],b=Object(c.useRef)();Object(c.useLayoutEffect)((function(){var e=b.current.getBoundingClientRect();t.top>window.innerHeight-e.height-10&&h(window.innerHeight-e.height-10),t.top<10&&h(10)}),[t.top]);var m=function(){s(),l(Object(g.jsx)(H,{onCancel:function(){return l()},message:n}))};return Object(g.jsx)(D.Out,{click:s,children:Object(g.jsxs)("div",{ref:b,style:Object(y.a)(Object(y.a)({},t),{},{top:j}),className:"message-menu",children:[o._id===n.author.id&&Object(g.jsx)("div",{onClick:function(){s(),a(m)},className:"editor option",children:"Edit"}),Object(g.jsx)("div",{onClick:m,className:"deletor option",children:"Delete"}),Object(g.jsx)("div",{className:"option",onClick:function(){if("speechSynthesis"in window){var e=new SpeechSynthesisUtterance;e.text="".concat(n.author.username," said ").concat(n.content),speechSynthesis.speak(e)}s()},children:"Speak Message"}),Object(g.jsx)("div",{className:"option",onClick:function(){navigator.clipboard.writeText(n.id),s()},children:"Copy ID"})]})})},q=function(e){var t,n=e.message,s=Object(c.useContext)(qe).setView,a=Object(c.useState)(Object(g.jsxs)("div",{className:"rotating",children:[Object(g.jsx)("div",{className:"rotating-div-1"}),Object(g.jsx)("div",{className:"rotating-div-2"})]})),r=Object(i.a)(a,2),o=r[0],l=r[1];return(null===(t=n.attachment)||void 0===t?void 0:t.URL)?Object(g.jsxs)("div",{className:"image-div",children:[o,Object(g.jsx)("img",{onLoad:function(){return l()},loading:"lazy",width:n.calculateImage.width,height:n.calculateImage.height,src:n.displayAttachmentURL,className:"message-attachment",alt:"attachment",onClick:function(){return s(Object(g.jsx)(M,{children:Object(g.jsx)("img",{className:"view-attachment animated-popup",src:d.a+n.attachment.URL,alt:"attachment"})}))}})]}):null},K=(n(63),function(e){var t=e.message,n=e.isBeingEdited,c=e.edit,s=e.input,a=e.setIsBeingEdited,r=e.edited;return n?Object(g.jsxs)("div",{className:"message-editor",children:[Object(g.jsx)("div",{style:{overflowY:"auto",maxHeight:"40vh"},className:"text-content",children:Object(g.jsx)(R,{defaultValue:t.content,onKeyDown:function(e){return"Enter"===e.code&&c(e)},innerRef:s,className:"message-edit not-input"})}),Object(g.jsxs)("div",{className:"editor-text",children:["escape to ",Object(g.jsx)("span",{onClick:function(){return a(!1)},children:"cancel"})," or enter to ",Object(g.jsx)("span",{onClick:c,children:"save"})," "]})]}):Object(g.jsxs)("span",{className:"text ".concat((t.unsent?"unsent-message ":" ")+(t.failed?"failed-tosend":"")),children:[t.content,r&&Object(g.jsx)("span",{title:new Date(t.updatedAt).toDateString(),className:"edited",children:"(edited)"})]})}),W=function(e){var t,n=e.message,s=e.full,a=Object(c.useState)(!1),r=Object(i.a)(a,2),o=r[0],d=r[1],j=Object(c.useState)(null),h=Object(i.a)(j,2),b=h[0],m=h[1],f=Object(c.useContext)(qe).setView,O=p.userCache.has(n.author.id)?new Oe(p.userCache.get(n.author.id)):n.author,v=Object(c.useRef)(),x=function(){d(!1),f.apply(void 0,arguments)},N=function(){var e=Object(u.a)(l.a.mark((function e(t){var c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=2;break}return e.abrupt("return",x());case 2:d(!0),c=t.target.getBoundingClientRect(),s={left:c.left+c.width+7<window.innerWidth-275?c.left+c.width+7:window.innerWidth-275,top:c.top-60},f(Object(g.jsx)(D.Out,{getEvent:!0,click:function(e){return e.target.id!=="avatar-".concat(n.id)&&x()},children:Object(g.jsx)(be,{setView:x,user:n.author,server:n.server,style:s})}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(e){document.dispatchEvent(new KeyboardEvent("keydown",{code:"Escape"})),m((function(){return e}))},w=new Date(n.updatedAt).getTime()!==new Date(n.timestamp).getTime();return Object(c.useEffect)((function(){var e=function(e){"Escape"===e.code&&m(null)};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}),[n.author]),Object(g.jsxs)("div",{id:n.id,className:"message-div ".concat(n.unsent?"unsent":""," ").concat((o||!!b)&&"clicked"),style:{marginTop:s?"0.4em":0},children:[s?Object(g.jsx)("img",{id:"avatar-".concat(n.id),onClick:N,width:"40",height:"40",className:"author-icon",src:O.displayAvatarURL(90),alt:"avatar"}):Object(g.jsxs)("span",{className:"timestamp",children:["".concat(n.timestamp.getHours()).padStart(2,"0"),":","".concat(n.timestamp.getMinutes()).padStart(2,"0")]}),Object(g.jsxs)("div",{className:"message-content",children:[s&&Object(g.jsxs)("span",{className:"author-name",children:[Object(g.jsx)("span",{onClick:N,className:"exact-author",children:O.username}),Object(g.jsx)("span",{className:"exact-time",children:n.createdAt})]}),Object(g.jsx)(K,{input:v,isBeingEdited:b,setIsBeingEdited:m,edited:w,edit:function(e){var t;if(!(null===(t=v.current)||void 0===t?void 0:t.innerText.trim()))return e.preventDefault(),b();v.current&&n.edit(v.current.innerText),m()},message:n}),Object(g.jsx)(q,{message:n}),(null===(t=n.invite)||void 0===t?void 0:t._id)&&Object(g.jsx)(B,{me:n.me,onJoin:function(e){return n.onJoin(e)},invite:n.invite,code:n.inviteCode}),Object(g.jsx)("div",{onClick:function(e){var t=e.target.getBoundingClientRect(),c={top:t.top,left:t.left,zIndex:4};f(Object(g.jsx)(J,{clickOut:function(){f(),d(!1)},edit:y,style:c,message:n})),d(!0)},tabIndex:"0",className:"message-params",children:Object(g.jsx)(V,{size:22})})]})]})},Y=function(e){var t=e.messages,n=e.setMessages,c=e.me,a=e.onJoin,r=e.server;return t.map((function(e,i){var o,l=new ve(Object.assign(e,{setMessages:n}),c,a,r),u=l.author.id===(null===(o=t[i-1])||void 0===o?void 0:o.author._id),d=l.timestamp.toDateString()!==new ve(t[i-1]||l).timestamp.toDateString();return Object(g.jsxs)(s.a.Fragment,{children:[d&&!!i&&Object(g.jsxs)("div",{className:"new-day",children:[Object(g.jsx)("div",{}),Object(g.jsx)("span",{children:l.timestamp.toDateString()}),Object(g.jsx)("div",{})]}),Object(g.jsx)("li",{children:Object(g.jsx)(W,{full:!u||d,message:l})})]},l.id)}))},G=function(e){var t=e.size;return Object(g.jsx)("svg",{height:t,viewBox:"0 0 24 24",width:t,children:Object(g.jsx)("path",{d:"M11.03 8h3.94l1.06-4.24a1 1 0 1 1 1.94.48L17.03 8H20a1 1 0 0 1 0 2h-3.47l-1 4H18a1 1 0 1 1 0 2h-2.97l-1.06 4.25a1 1 0 1 1-1.94-.49l.94-3.76H9.03l-1.06 4.25a1 1 0 1 1-1.94-.49L6.97 16H4a1 1 0 0 1 0-2h3.47l1-4H6a1 1 0 0 1 0-2h2.97l1.06-4.24a1 1 0 1 1 1.94.48L11.03 8zm-.5 2l-1 4h3.94l1-4h-3.94z"})})},X=(n(64),function(e){var t=e.logs,n=e.click;return t.map((function(e){var t=new Oe(e);return Object(g.jsxs)("li",{onClick:function(){return n(t)},className:"search-result",children:[Object(g.jsx)("img",{alt:t.username,src:t.displayAvatarURL(90),className:"icon-avatar",style:{width:20,height:20,borderRadius:"50%"}}),Object(g.jsx)("span",{children:t.username})]},t.id)}))}),Z=function(e){return e.server.channels.map((function(e){var t=new Ne(e);return Object(g.jsxs)("li",{className:"search-result",children:[Object(g.jsx)(G,{size:20}),Object(g.jsx)("span",{children:t.name})]},t.id)}))},$=function(e){var t=e.filter,n=e.click,s=Object(c.useContext)(qe),a=s.user,r=s.setServer;return a.servers.map((function(e){var s=new N(e,a);if(!s.name.includes(t))return null;return Object(g.jsxs)(c.Fragment,{children:[Object(g.jsx)(Z,{server:s}),Object(g.jsxs)("li",{onClick:function(){n(),r(s)},className:"search-result",children:[Object(g.jsx)("img",{alt:s.name,src:s.displayIcon(100),className:"icon-avatar",style:{width:20,height:20,borderRadius:5}}),Object(g.jsx)("span",{children:s.name})]})]},s.id)}))},Q=function(e){var t=e.logs,n=e.clickUser,s=Object(c.useState)(""),a=Object(i.a)(s,2),r=a[0],o=a[1],l=Object(c.useContext)(qe).setView;return Object(g.jsx)(M,{children:Object(g.jsxs)("div",{className:"generic-popup find-conversation animated-popup",children:[Object(g.jsx)("input",{placeholder:"Where would you like to go?",onChange:function(e){return o(e.target.value)},className:"big-input"}),Object(g.jsx)("div",{className:"list",children:Object(g.jsxs)("ul",{children:[Object(g.jsx)(X,{click:function(e){l(),n(e)},logs:t.filter((function(e){return e.username.includes(r)}))}),Object(g.jsx)($,{click:function(){return l()},filter:r})]})})]})})},ee=function(){var e=Object(u.a)(l.a.mark((function e(t,n,c,s,a,r,i){var o,u,d;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"===t.code){e.next=2;break}return e.abrupt("return");case 2:if(null===(o=t.preventDefault)||void 0===o||o.call(t),t.target.textContent.trim()||a.length){e.next=5;break}return e.abrupt("return");case 5:d={author:n,content:t.target.innerText.trim(),_id:"m".concat(Date.now()),createdAt:Date.now(),unsent:!0,channel:c.id,updatedAt:Date.now(),attachment:null===a||void 0===a||null===(u=a[0])||void 0===u?void 0:u.data},s((function(e){return[].concat(Object(j.a)(e),[d])})),(null===a||void 0===a?void 0:a.length)&&r([]),c.send(d).then((function(e){var t,n=Object.assign(d,{_id:e.id,unsent:!1,invite:e.invite,content:e.content});(null===(t=e.attachment)||void 0===t?void 0:t.URL)&&(n.attachment=e.attachment),s((function(e){var t=Object(j.a)(e),c=t.find((function(e){return e._id===d._id}));return t[t.indexOf(c)]=n,t})),n.author.online=e.author.online})).catch((function(e){console.error(e),s((function(e){var t=Object(j.a)(e),n=t.find((function(e){return e._id===d._id}));return n&&(n.failed=!0),t}))})),null===i||void 0===i||i(),t.target.textContent="";case 11:case"end":return e.stop()}}),e)})));return function(t,n,c,s,a,r,i){return e.apply(this,arguments)}}(),te=function(e,t){for(var n=window.atob(e),c=new Array(n.length),s=0;s<n.length;s++)c[s]=n.charCodeAt(s);var a=new Uint8Array(c);return new Blob([a],{type:t})},ne=(n(65),function(e){var t=e.attachments,n=e.setAttachments;return t.map((function(e,t){var c=e.data,s=e.fileName,a=te(c.split(",")[1],"image/"+s.split(".").pop()),r=URL.createObjectURL(a);return Object(g.jsxs)("li",{className:"attachment-item",style:{position:"relative"},children:[Object(g.jsx)("button",{onClick:function(){return e=t,n((function(t){return Object(j.a)(t).filter((function(t,n){return n!==e}))}));var e},className:"attachment-delete",children:Object(g.jsx)(w,{size:15})}),Object(g.jsx)("img",{src:r,className:"attachment-2",alt:"attachment"}),Object(g.jsx)("span",{className:"attachment-name",children:s})]},t)}))}),ce=function(e){return new Promise((function(t,n){var c=new FileReader;c.readAsDataURL(e),c.onload=function(){var e=new Image;e.onload=function(){return t(c.result)},e.src=c.result},c.onerror=function(e){return n(e)}}))},se=function(e){var t=e.users,n=e.onClick,c=e.type;return t.map((function(e){if(!e)return null;var t=new Oe(e);return Object(g.jsxs)("div",{className:"friend",children:[Object(g.jsx)("img",{width:"35",height:"35",alt:"uwu",src:t.displayAvatarURL(45),className:"friend-pfp"}),Object(g.jsxs)("div",{children:[Object(g.jsxs)("h5",{className:"friend-name",children:[t.username,Object(g.jsx)("span",{children:t.tag})]}),Object(g.jsx)("p",{className:"state",children:"requests"===c&&e.received&&"Incoming friend request"}),Object(g.jsx)("p",{className:"state",children:"requests"===c&&!e.received&&"Ongoing friend request"}),Object(g.jsx)("p",{className:"state",children:"friends"===c&&(e.online?"Online":"Offline")})]}),"requests"===c&&e.received&&Object(g.jsx)("div",{onClick:function(){return null===n||void 0===n?void 0:n(t)},className:"accept",children:Object(g.jsx)(w,{size:15})}),"friends"===c&&Object(g.jsx)("div",{onClick:function(){return null===n||void 0===n?void 0:n(t)},className:"accept",children:"DM"})]},t.id)}))},ae=function(e){var t=e.online,n=e.user,s=e.click,a=Object(c.useState)([]),r=Object(i.a)(a,2),o=r[0],l=r[1];return Object(c.useEffect)((function(){var e=!0;return fetch("".concat(d.a,"friends"),{headers:{Authorization:n.token}}).then((function(e){return e.json()})).then((function(n){e&&l(t?n.filter((function(e){return e.online})):n)})),function(){e=!1,l([])}}),[n,t]),Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("h5",{className:"home-title",children:[t?"ONLINE":"ALL","\u2014",o.length]}),Object(g.jsx)("div",{className:"list",children:Object(g.jsx)(se,{onClick:s,type:"friends",users:o})})]})},re=function(e){var t=e.user,n=Object(c.useState)(""),s=Object(i.a)(n,2),a=s[0],r=s[1],o=Object(c.useState)(Object(g.jsx)("p",{className:"dumb-text-3",children:"You can add a friend by their tag. It's CaSe SeNsiTive!"})),j=Object(i.a)(o,2),h=j[0],b=j[1],m=function(){var e=Object(u.a)(l.a.mark((function e(){var n,c,s,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.split("#"),c=Object(i.a)(n,2),s=c[0],r=c[1],s&&r){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,fetch("".concat(d.a,"users/").concat(s,"&").concat(r,"/request"),{method:"POST",headers:{Authorization:t.token,"Content-Type":"application/json"}});case 5:if(!e.sent.ok){e.next=8;break}return e.abrupt("return",b(Object(g.jsxs)("p",{style:{color:"var(--green)"},className:"dumb-text-3",children:["You send a friend request to ",s+"#"+r]})));case 8:b(Object(g.jsxs)("p",{style:{color:"var(--red)"},className:"dumb-text-3",children:["Failed to send a friend request to ",s+"#"+r]}));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(g.jsxs)("div",{className:"invite",children:[Object(g.jsx)("h3",{className:"h3-add",children:"ADD FRIEND"}),h,Object(g.jsxs)("div",{className:"add-friend-input",children:[Object(g.jsx)("input",{autoComplete:"off",maxLength:"35",onChange:function(e){return r(e.target.value)},placeholder:"Enter a username#0000"}),Object(g.jsx)("div",{className:"fake-after",children:!a.includes("#")&&a}),Object(g.jsx)("button",{onClick:m,className:"send-friend-request ".concat(a&&"valid"),children:"Send friend request"})]})]})},ie=function(e){var t=e.user,n=Object(c.useState)([]),s=Object(i.a)(n,2),a=s[0],r=s[1];Object(c.useEffect)((function(){var e=!0;return fetch("".concat(d.a,"friends/pending"),{headers:{Authorization:t.token}}).then((function(e){return e.json()})).then((function(t){e&&r(t)})),function(){e=!1}}),[t]);return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("h5",{className:"home-title",children:["PENDING\u2014",a.length]}),Object(g.jsx)("div",{className:"list",children:Object(g.jsx)(se,{type:"requests",onClick:function(e){r((function(t){return Object(j.a)(t).filter((function(t){return t._id!==e.id}))})),fetch("".concat(d.a,"accept/").concat(e.id),{method:"POST",headers:{Authorization:t.token}})},users:a})})]})},oe=function(e){var t=e.dm,n=e.me,s=e.onJoin,a=e.setLogs,r=Object(c.useState)(),o=Object(i.a)(r,2),h=o[0],b=o[1],m=Object(c.useState)([]),O=Object(i.a)(m,2),v=O[0],x=O[1],N=Object(c.useState)(),y=Object(i.a)(N,2),k=y[0],S=y[1],E=Object(c.useCallback)((function(e){ee(e,n,new Oe(t.user),b,v,x,(function(){var e=function(e){var n=Object(j.a)(e);return n.splice(0,0,n.splice(n.findIndex((function(e){return e._id===t.user._id})),1)[0]),n};a(e),p.setLogs(e)}))}),[t.user,n,v,a]);Object(c.useLayoutEffect)((function(){var e=!0;p.channels[t.user.id]?b(p.channels[t.user.id]):(b(),fetch("".concat(d.a,"dm/").concat(t.user.id),{headers:{Authorization:n.token}}).then((function(e){return e.json()})).then((function(n){e&&(b(n),p.at("channels",t.user.id)(n),S())})));var c=function(n){e&&n.channel===t.user.id&&f.message(b,n)},s=function(c){e&&(c.user!==t.user.id&&c.user!==n._id||f.messageDelete(b,c))},a=function(e){return f.messageEdit(b,e)};return Ke.on("dm",c),Ke.on("messageDelete",s),Ke.on("messageEdit",a),function(){e=!1,Ke.off("dm",c).off("messageDelete",s).off("messageEdit",a)}}),[n.token,n._id,t]),Object(c.useLayoutEffect)((function(){h||p.channels[t.user.id]?S(!1):S(Object(g.jsx)(C,{}))}),[h,t.user.id]),Object(c.useEffect)((function(){var e;h&&(null===(e=t.message)||void 0===e?void 0:e.target.textContent)&&E(t.message)}),[h,t.message,E]);var A=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(t.target.files[0]).catch((function(){return 0}));case 2:c=e.sent,(s={data:c,fileName:null===(n=t.target.files[0])||void 0===n?void 0:n.name}).data&&x([s]),t.target.value="";case 5:case"end":return e.stop()}var s}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("div",{className:"chat",children:[k,Object(g.jsxs)("ul",{className:"fetched-messages",children:[Object(g.jsxs)("div",{className:"dm-start",children:[Object(g.jsx)("img",{height:"85",width:"85",className:"dm-avatar",alt:"icon",src:t.user.displayAvatarURL(90)}),Object(g.jsx)("h3",{className:"dm-username",children:t.user.username}),Object(g.jsxs)("p",{className:"dumb-text-2",children:["This is the beginning of your direct message history with ",Object(g.jsx)("span",{children:t.user.username})]})]}),h&&Object(g.jsx)(Y,{onJoin:s,setMessages:b,messages:h,me:n})]})]}),Object(g.jsx)("form",{className:"send-message",children:Object(g.jsx)("div",{className:"controll",children:Object(g.jsxs)("div",{className:"message-manager",children:[Object(g.jsx)("ul",{className:"attachment-list ".concat(v.length&&"has-children"),children:Object(g.jsx)(ne,{setAttachments:x,attachments:v})}),Object(g.jsxs)("div",{className:"text-content",children:[Object(g.jsx)("div",{className:"file",children:Object(g.jsxs)("button",{className:"attach-file",children:[Object(g.jsx)("input",{type:"file",onChange:A}),Object(g.jsx)(w,{size:10})]})}),Object(g.jsx)(R,{placeholder:"Send a message to ".concat(t.user.username),onKeyDown:E})]})]})})})]})},le=function(e){var t=e.user,n=e.dm,s=e.onJoin,a=Object(c.useContext)(qe).setView,r=Object(c.useState)("online"),o=Object(i.a)(r,2),l=o[0],u=o[1],h=Object(c.useState)(n),b=Object(i.a)(h,2),m=b[0],O=b[1],v=Object(c.useState)(p.logs),x=Object(i.a)(v,2),N=x[0],y=x[1],w=function(e){return O({user:e})},k=Object(c.useState)(Object(g.jsx)(ae,{click:w,online:!0,user:t})),C=Object(i.a)(k,2),S=C[0],E=C[1];Object(c.useEffect)((function(){n&&O(n)}),[n]);var A=Object(c.useContext)(qe),L=Object(i.a)(A.not,2),R=L[0],T=L[1];Object(c.useLayoutEffect)((function(){(null===m||void 0===m?void 0:m.user.id)&&(R.find((function(e){return e.user._id===m.user.id}))&&T((function(e){return Object(j.a)(e).filter((function(e){return e.user._id!==m.user.id}))})),fetch("".concat(d.a,"notifications?id=").concat(m.user.id),{method:"DELETE",headers:{Authorization:t.token}}).catch(console.log))}),[R,T,null===m||void 0===m?void 0:m.user.id,t.token]),Object(c.useEffect)((function(){var e=!0;p.logs.length?y(p.logs):fetch("".concat(d.a,"dms/logs"),{headers:{Authorization:t.token}}).then((function(e){return e.json()})).then((function(t){e&&(y(t),p.setLogs(t))}));var n=function(e){return f.memberOnline(y,e)};return Ke.on("online",n),function(){Ke.off("online",n),e=!1}}),[t]),Object(c.useEffect)((function(){m&&(E(Object(g.jsx)(oe,{setLogs:y,onJoin:s,dm:m,me:t})),u(m.user.id),N.some((function(e){return e._id===m.user.id}))||p.logs.some((function(e){return e._id===m.user.id}))||(y((function(e){return[m.user].concat(Object(j.a)(e))})),p.setLogs((function(e){return[m.user].concat(Object(j.a)(e))}))))}),[m,t,s,N]);var D=function(e){return function(){u(e),"online"===e&&E(Object(g.jsx)(ae,{click:w,online:!0,user:t})),"add"===e&&E(Object(g.jsx)(re,{user:t})),"pending"===e&&E(Object(g.jsx)(ie,{user:t})),"all"===e&&E(Object(g.jsx)(ae,{click:w,user:t}))}};return Object(g.jsxs)("main",{className:"flexible-container",children:[Object(g.jsxs)("section",{className:"left-part",children:[Object(g.jsx)("header",{className:"server-name home-search",children:Object(g.jsx)("input",{onClick:function(){return a(Object(g.jsx)(Q,{clickUser:function(e){return O({user:e})},logs:N}))},value:"Find or start conversation",className:"home-search-input generic-input-type-button",type:"button"})}),Object(g.jsxs)("div",{className:"channels",children:[Object(g.jsx)("div",{onClick:function(){u("online"),O(),E(Object(g.jsx)(ae,{click:w,online:!0,user:t}))},className:"friends-click ".concat(!m&&"friends-clicked"),children:"Friends"}),Object(g.jsx)("h4",{className:"direct-messages",children:"DIRECT MESSAGES"}),N.map((function(e){var t=p.userCache.has(e._id)?new Oe(p.userCache.get(e._id)):new Oe(e);return Object(g.jsxs)("div",{onClick:function(){return O({user:t})},style:{opacity:1},className:"member ".concat((null===m||void 0===m?void 0:m.user.id)===t.id&&"member-clicked"," ").concat(!t.online&&"member-offline"),children:[Object(g.jsx)("div",{className:"member-avatar",children:Object(g.jsx)(F,{size:32,status:!!t.online&&"online",src:t.displayAvatarURL(90)})}),Object(g.jsxs)("div",{className:"nice-div",children:[Object(g.jsx)("h4",{className:"member-name",children:t.username}),Object(g.jsx)("p",{className:"is-online",children:t.online&&t.customStatus})]})]},t.id)}))]}),Object(g.jsx)(P,{setView:a})]}),Object(g.jsxs)("section",{className:"messages messages-home",children:[Object(g.jsx)("div",{className:"name name-".concat(l),children:m?Object(g.jsxs)("div",{className:"dm-title",children:[Object(g.jsx)("img",{className:"who-am-i-talking-to",height:"20",width:"20",alt:"pfp",src:m.user.displayAvatarURL(80)}),Object(g.jsx)("div",{className:"channel-title",children:Object(g.jsx)("span",{children:m.user.username})})]}):Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("h3",{className:"h3-title",children:["Friends ",Object(g.jsx)("span",{children:"|"})]}),Object(g.jsxs)("div",{className:"home-buttons",children:[Object(g.jsx)("button",{onClick:D("online"),className:"online",children:"Online"}),Object(g.jsx)("button",{onClick:D("all"),className:"all",children:"All"}),Object(g.jsx)("button",{onClick:D("pending"),className:"pending",children:"Pending"}),Object(g.jsx)("button",{onClick:D("add"),className:"add-friend",children:"Add friend"})]})]})}),Object(g.jsx)("div",{className:"messages-main",children:S})]})]})},ue=(n(66),function(e){var t=e.servers;return Object(g.jsx)("div",{className:"list",style:{marginTop:10,height:"100%"},children:t.map((function(e){var t=new N(e);return Object(g.jsxs)("div",{className:"mutual-server friend",children:[e.icon?Object(g.jsx)("img",{width:"40",height:"40",alt:"uwu",src:t.displayIcon(100),className:"friend-pfp server-ico"}):Object(g.jsx)("div",{style:{width:40,height:40,background:"var(--blue)"},className:"default-no-img-div server-ico friend-pfp",children:e.name[0]}),Object(g.jsx)("h5",{className:"friend-name",children:t.name})]},t.id)}))})}),de=function(e){var t=e.user;return Object(g.jsxs)("div",{style:{padding:"0 15px",boxSizing:"border-box"},className:"note",children:[Object(g.jsx)("h5",{children:"NOTE"}),Object(g.jsx)("textarea",{defaultValue:localStorage.getItem(t.id),onChange:function(e){return localStorage.setItem(t.id,e.target.value)},placeholder:"Click to add note"})]})},je=function(e){var t=e.button,n=e.servers,c=e.user;switch(t){case 1:return Object(g.jsx)(de,{user:c});case 2:return Object(g.jsx)(ue,{servers:n});case 3:return Object(g.jsx)("div",{style:{marginTop:10},className:"list"});default:return null}},he=function(e){var t=e.user,n=e.dm,s=e.online,a=Object(c.useState)(1),r=Object(i.a)(a,2),o=r[0],l=r[1],u=Object(c.useContext)(qe).user,d=u.servers.filter((function(e){return e.members.includes(t.id)})),j=function(e){return function(){return l(e)}},h=!t.profileColor&&"url(".concat(t.displayAvatarURL(90),")");return Object(g.jsx)(M,{children:Object(g.jsxs)("div",{className:"view-profile animated-popup ".concat(!s&&"not-online"),children:[Object(g.jsx)("div",{style:{backgroundColor:t.profileColor||"#000000",backgroundImage:h},className:"user-bg"}),Object(g.jsx)("div",{className:"pfp-wrapper",children:Object(g.jsx)(F,{src:t.displayAvatarURL(120),status:t.online?"online":"offline",size:120,className:"bruhbruh"})}),u._id!==t.id&&Object(g.jsx)("button",{onClick:function(){return n({code:"Enter"})},className:"send-req",children:"Send Message"}),Object(g.jsxs)("h3",{className:"uwu-20",children:[t.username,Object(g.jsx)("span",{children:t.tag})]}),Object(g.jsx)("div",{className:"more-with-border",children:Object(g.jsxs)("div",{className:"more",children:[Object(g.jsx)("div",{onClick:j(1),className:"more-div user-info-2 ".concat(1===o&&"clicked"),children:"User Info"}),Object(g.jsx)("div",{onClick:j(2),className:"more-div mutual-servers ".concat(2===o&&"clicked"),children:"Mutual Servers"}),Object(g.jsx)("div",{onClick:j(3),className:"more-div mutual-friends ".concat(3===o&&"clicked"),children:"Mutual Friends"})]})}),Object(g.jsx)("div",{className:"even-more",children:Object(g.jsx)(je,{button:o,servers:d,user:t})})]})})},be=function(e){var t=e.user,n=e.server,s=e.style,a=e.setView,r=e.editable,o=e.onClick,l=p.userCache.has(t.id)?new Oe(p.userCache.get(t.id)):t,u=Object(c.useContext)(qe),d=u.setScreen,j=u.setServer,h=u.user,b=Object(c.useContext)(Ze),m=Object(c.useState)(s.top),f=Object(i.a)(m,2),O=f[0],v=f[1],x=Object(c.useState)(0),N=Object(i.a)(x,2),w=N[0],k=N[1],C=Object(c.useState)(t.online),S=Object(i.a)(C,2),E=S[0],A=S[1],L=Object(c.useRef)();Object(c.useLayoutEffect)((function(){var e=L.current.getBoundingClientRect();s.top>window.innerHeight-e.height-20&&v(window.innerHeight-e.height-20),s.top<10&&v(10);var t=function(e){return A(e.online)};return Ke.on("online",t),function(){return Ke.off("online",t)}}),[s.top]),Object(c.useEffect)((function(){var e=setInterval((function(){return k((function(e){return++e}))}),1e3);return function(){return clearInterval(e)}}),[]);var R=function(e){var n,c;if("Enter"===e.code){j();var s={code:"Enter",target:{textContent:null===(n=e.target)||void 0===n?void 0:n.value,innerText:null===(c=e.target)||void 0===c?void 0:c.value}};d(Object(g.jsx)(le,{update:b,dm:{user:t,message:s},user:h})),a()}};return Object(g.jsxs)("div",{ref:L,style:Object(y.a)(Object(y.a)({},s),{},{top:O}),className:"user-div ".concat(!E&&"not-online"),children:[Object(g.jsx)("div",{style:{backgroundColor:l.profileColor||"#000"},className:"user-bg-1"}),Object(g.jsxs)("div",{onClick:function(){if(o)return o();a(Object(g.jsx)(he,{dm:R,user:t,online:E}))},className:"avatar-wrapper",children:[Object(g.jsx)(F,{status:l.online?"online":"offline",className:"bruhbruh",src:l.displayAvatarURL(90),size:80}),Object(g.jsx)("svg",{viewBox:"0 0 80 80",className:"hidden-text",height:"80",width:"80",children:Object(g.jsx)("foreignObject",{overflow:"visible",height:"80",width:"80",y:"0",x:"0",mask:"url(#mask-round-80)",children:Object(g.jsx)("div",{className:"change-929",children:r?"CHANGE AVATAR":"VIEW PROFILE"})})})]}),Object(g.jsxs)("h5",{className:"user-username",children:[l.username,Object(g.jsx)("span",{children:l.tag})]}),Object(g.jsx)("span",{className:"user-custom-status",children:l.online&&l.customStatus}),Object(g.jsx)("div",{className:"line first"}),n&&Object(g.jsxs)("div",{className:"roles",children:[Object(g.jsx)("h5",{children:"ROLES"}),Object(g.jsx)("div",{className:"role",children:"Member"}),n.owner===l.id&&Object(g.jsx)("div",{className:"role",children:"Owner"}),Object(g.jsx)("div",{className:"line last"})]}),r?Object(g.jsxs)("div",{className:"customizing-my-profile",children:[Object(g.jsx)("h5",{children:"CUSTOMIZING MY PROFILE"}),Object(g.jsxs)("div",{style:{height:70},className:"flex-line",children:[Object(g.jsx)("div",{className:"activity-icon",children:Object(g.jsx)(T,{height:50,width:50})}),Object(g.jsxs)("div",{className:"activity-name",children:[Object(g.jsx)("h5",{children:"User Profile"}),Object(g.jsxs)("span",{children:[(~~(w/60)).toFixed().padStart(2,"0"),":",(w-60*~~(w/60)).toFixed().padStart(2,"0")," elapsed"]})]})]})]}):Object(g.jsxs)("div",{className:"note",children:[Object(g.jsx)("h5",{children:"NOTE"}),Object(g.jsx)("textarea",{onChange:function(e){return localStorage.setItem(t.id,e.target.value)},defaultValue:localStorage.getItem(t.id),placeholder:"Click to add a note"})]}),h._id!==t.id&&Object(g.jsx)("input",{onKeyDown:R,placeholder:"Message ".concat(l.username).concat(l.tag),className:"dm-user"})]})},me=function(e){var t=e.size;return Object(g.jsxs)("svg",{height:t,width:t,version:"1.1",id:"crown",x:"0px",y:"0px",viewBox:"0 0 512 512",style:{enableBackground:"new 0 0 512 512"},xmlSpace:"preserve",children:[Object(g.jsx)("circle",{style:{fill:"#F95FF2"},cx:"50.637",cy:"264.44",r:"50.637"}),Object(g.jsx)("circle",{style:{fill:"#AB15A4"},cx:"461.363",cy:"264.44",r:"50.637"}),Object(g.jsx)("polygon",{style:{fill:"#E7C05C"},points:"405.099,416.352 461.363,393.846 495.121,50.637 458.844,76.244 "}),Object(g.jsx)("polygon",{style:{fill:"#FFD875"},points:"375.557,135.033 255.993,50.637 136.434,135.033 16.879,50.637 50.637,416.352 \r 425.391,416.352 458.844,76.244 "}),Object(g.jsx)("circle",{style:{fill:"#D0A842"},cx:256,cy:"264.44",r:"84.396"}),Object(g.jsx)("path",{style:{fill:"#FEDFFD"},d:"M461.363,393.846h-33.758v67.517h33.758c18.645,0,33.758-15.114,33.758-33.758\r C495.121,408.96,480.007,393.846,461.363,393.846z"}),Object(g.jsx)("path",{style:{fill:"#FFF3EE"},d:"M461.363,427.604c0-18.645-15.114-33.758-33.758-33.758H50.637\r c-18.645,0-33.758,15.114-33.758,33.758c0,18.645,15.114,33.758,33.758,33.758h376.967\r C446.249,461.363,461.363,446.249,461.363,427.604z"}),Object(g.jsx)("path",{style:{fill:"#AB15A4"},d:"M256,213.802v101.275c27.966,0,50.637-22.671,50.637-50.637S283.966,213.802,256,213.802z"}),Object(g.jsx)("path",{style:{fill:"#D23ACB"},d:"M272.879,264.44c0-27.966-7.557-50.637-16.879-50.637c-27.966,0-50.637,22.671-50.637,50.637\r s22.671,50.637,50.637,50.637C265.322,315.077,272.879,292.406,272.879,264.44z"}),Object(g.jsxs)("g",{children:[Object(g.jsx)("circle",{style:{fill:"#E7C05C"},cx:"89.673",cy:"317.89",r:"8.44"}),Object(g.jsx)("circle",{style:{fill:"#E7C05C"},cx:"123.431",cy:"351.648",r:"8.44"})]})]})},fe=function(e){var t=e.server,n=e.member,s=p.userCache.has(n.id)?new Oe(p.userCache.get(n.id)):n,a=Object(c.useState)(!1),r=Object(i.a)(a,2),o=r[0],l=r[1],u=Object(c.useContext)(qe).setView;return Object(g.jsxs)("div",{onClick:function(e){l(!0);var c=e.target.getBoundingClientRect().top-40;u(Object(g.jsx)(D.Out,{click:function(){l(!1),u()},children:Object(g.jsx)(be,{user:n,setView:function(){l(!1),u.apply(void 0,arguments)},style:{right:245,top:c,animationName:"reverseShift"},server:t})}))},className:"member ".concat(o&&"member-clicked"," ").concat(!s.online&&"member-offline"),children:[Object(g.jsx)("div",{className:"member-avatar",children:Object(g.jsx)(F,{className:"bruhbruh",status:s.online?"online":"offline",size:32,src:s.displayAvatarURL(90)})}),Object(g.jsxs)("div",{className:"nice-div",children:[Object(g.jsxs)("span",{className:"member-name ".concat((null===t||void 0===t?void 0:t.owner)===n.id&&"owner"),children:[s.username," ",(null===t||void 0===t?void 0:t.owner)===n.id&&Object(g.jsx)(me,{size:16})]}),Object(g.jsx)("span",{className:"is-online",children:s.online?s.customStatus:null})]})]},n.id)},Oe=function(){function e(t){for(var n in Object(h.a)(this,e),t)this[n]=t[n];this.id=t._id}return Object(b.a)(e,[{key:"displayAvatarURL",value:function(e){return"".concat(d.a+this.avatarURL).concat(e?"?width=".concat(e,"&height=").concat(e):"")}},{key:"toJSX",value:function(e,t,n){return Object(g.jsx)(be,{user:this,setView:n,style:e,server:t})}},{key:"fetch",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(Object(u.a)(l.a.mark((function t(){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(d.a,"fetch/").concat(this.id)).then((function(e){return e.json()}));case 2:return n=t.sent,this.avatarURL=n.avatarURL,this.username=n.username,t.abrupt("return",new e(Object.assign({_id:this.id},n)));case 6:case"end":return t.stop()}}),t,this)}))))},{key:"edit",value:function(){var e=Object(u.a)(l.a.mark((function e(t,n,c){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(d.a,"user/edit"),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:this.token},body:JSON.stringify({username:t,data:n,profileColor:c})}).then((function(e){return e.json()})).catch(console.log);case 2:return s=e.sent,this.avatarURL=s.avatarURL,this.username=s.username,e.abrupt("return",s);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,c){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=Object(u.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(d.a,"dm/").concat(this.id),{method:"POST",headers:{Authorization:t.author.token,"Content-Type":"application/json"},body:JSON.stringify({content:t.content,attachment:t.attachment})}).then((function(e){return e.json()}));case 2:return n=e.sent,e.abrupt("return",new ve(n));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"MapMembers",value:function(t){var n,c=t.members,s=t.server,a=t.setView,r=t.me,i=c.filter((function(e){return null===e||void 0===e?void 0:e.online})).length,o=c.length-i,l=[Object(g.jsxs)("h5",{className:"members-title",children:["ONLINE \u2014 ",i]},"online")],u=[Object(g.jsxs)("h5",{className:"members-title",children:["OFFLINE \u2014 ",o]},"offline")],d=c.sort((function(e,t){return e.username.localeCompare(t.username)})),j=Object(m.a)(d);try{for(j.s();!(n=j.n()).done;){var h=n.value,b=new e(Object.assign(h,{view:a})),f=Object(g.jsx)(fe,{member:b,server:s,me:r},b.id);h.online?l.push(f):u.push(f)}}catch(O){j.e(O)}finally{j.f()}return 1===u.length&&(u.length=0),1===l.length&&(l.length=0),l.concat(u)}}]),e}(),ve=(n(67),function(){function e(t,n,c,s){Object(h.a)(this,e),this.author=new Oe(t.author),this.content=t.content,this.attachment=t.attachment,this.timestamp=new Date(t.createdAt),this.createdAt=function(e){var t="".concat("".concat(e.getHours()).padStart(2,"0"),":").concat("".concat(e.getMinutes()).padStart(2,"0")),n=new Date,c=36e5*n.getHours()+6e4*n.getMinutes()+1e3*n.getSeconds()+n.getMilliseconds();return Date.now()-e.getTime()<=c?"Today at ".concat(t):Date.now()-e.getTime()<=c+864e5?"Yesterday at ".concat(t):e.toLocaleDateString()}(new Date(t.createdAt)),this.id=t._id,this.invite=t.invite,this.unsent=t.unsent,this.server=s,this.channel=t.channel,this.Authorization=null===n||void 0===n?void 0:n.token,this.me=n,this.setMessages=t.setMessages,this.onJoin=c,this.failed=t.failed,this.updatedAt=t.updatedAt}return Object(b.a)(e,[{key:"calculateImage",get:function(){return this.attachment.height<300&&this.attachment.width<400?{height:this.attachment.height,width:this.attachment.width}:this.attachment.height>=this.attachment.width||this.attachment.height/this.attachment.width*400>300?{height:300,width:this.attachment.width/this.attachment.height*300}:{width:400,height:this.attachment.height/this.attachment.width*400}}},{key:"displayAttachmentURL",get:function(){var e=this.calculateImage.height!==this.attachment.height&&this.calculateImage.width!==this.attachment.width?"?width=".concat(Math.trunc(this.calculateImage.width),"&height=").concat(Math.trunc(this.calculateImage.height)):"";return d.a+this.attachment.URL+e}},{key:"delete",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(d.a,"channels/").concat(this.channel,"/messages/").concat(this.id),{method:"DELETE",headers:{Authorization:this.Authorization}}).then((function(e){return e.json()}));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"edit",value:function(){var e=Object(u.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(d.a,"channels/").concat(this.channel,"/messages/").concat(this.id),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:this.Authorization},body:JSON.stringify({content:t})}).then((function(e){return e.json()}));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"inviteCode",get:function(){var e,t=null===(e=this.content.match(/(^|\s)server\/.{8}(?=\s|$)/g))||void 0===e?void 0:e[0];return t?t.split("/")[1]:null}}]),e}()),xe=function(e){var t=e.isClicked,n=e.onClick,c=e.channel;return Object(g.jsxs)("div",{onClick:n,className:"channel ".concat(t?"c-clicked":""),children:[Object(g.jsx)(G,{size:25}),Object(g.jsx)("span",{children:c.name})]})},pe=function(e,t,n){var s=Object(c.useState)(0),a=Object(i.a)(s,2),r=a[0],o=a[1];return Object(c.useEffect)((function(){return o(0)}),[e]),e.map((function(e,c){var s=new ge(e,t);return s.toJSX(r===c,(function(){n(s),o(c)}))}))},ge=function(){function e(t,n){Object(h.a)(this,e),this.name=t.name,this.id=t._id,this.server=n}return Object(b.a)(e,[{key:"toJSX",value:function(e,t){return Object(g.jsx)(xe,{isClicked:e,onClick:t,channel:this},this.id)}},{key:"toTitle",value:function(){return Object(g.jsxs)("div",{className:"channel-title",children:[Object(g.jsx)(G,{size:28}),Object(g.jsx)("span",{children:this.name})]})}},{key:"join",value:function(e,t){e.emit("join",{channel:this.id,Authorization:t})}},{key:"fetchMessages",value:function(){var e=Object(u.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!p.channels[this.id]){e.next=2;break}return e.abrupt("return",p.channels[this.id]);case 2:return e.next=4,fetch("".concat(d.a,"channels/").concat(this.id,"/messages"),{headers:{Authorization:t}}).then((function(e){return e.json()})).catch((function(){return[]}));case 4:return n=e.sent,p.at("channels",this.id)(n.messages),e.abrupt("return",n.messages);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=Object(u.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(d.a,"channels/").concat(this.id,"/messages"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:t.author.token},body:JSON.stringify(t)}).then((function(e){return e.json()}));case 2:return n=e.sent,e.abrupt("return",new ve(n));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();ge.LoadChannels=pe;var Ne=ge,ye=function(){return Object(g.jsxs)("div",{className:"member-skeleton",children:[Object(g.jsx)("div",{className:"member-skeleton-pfp"}),Object(g.jsxs)("div",{className:"nice-div",children:[Object(g.jsx)("div",{className:"member-skeleton-name"}),Math.random()>.5&&Object(g.jsx)("div",{className:"member-skeleton-status"})]})]})};function we(e){var t=e.times;return Object(j.a)(Array(t)).map((function(e,t){return Object(g.jsx)(ye,{},t)}))}var ke=function(e){var t=e.size;return Object(g.jsx)("svg",{width:t,height:t,viewBox:"0 0 48 48",fill:"none",children:Object(g.jsx)("path",{d:"M37 18L25 30L13 18",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"})})},Ce=(n(68),function(e){var t=e.server,n=e.quit,s=e.animation,a=Object(c.useState)(),r=Object(i.a)(a,2),o=r[0],l=r[1],u=Object(c.useState)([]),h=Object(i.a)(u,2),b=h[0],m=h[1],f=Object(c.useState)(""),O=Object(i.a)(f,2),v=O[0],x=O[1],p=Object(c.useState)(!1),N=Object(i.a)(p,2),y=N[0],k=N[1],C=Object(c.useContext)(qe).user;Object(c.useEffect)((function(){var e=!0;return fetch("".concat(d.a,"friends"),{headers:{Authorization:C.token}}).then((function(e){return e.json()})).then((function(t){e&&l(t)})),function(){e=!1}}),[C]);return Object(g.jsxs)("div",{className:"invite-people-div ".concat(s),children:[Object(g.jsxs)("div",{className:"part-1",children:[Object(g.jsxs)("h3",{children:["INVITE PEOPLE TO ",t.name.toUpperCase()]}),Object(g.jsx)("input",{onChange:function(e){return x(e.target.value)},placeholder:"Search for friends"}),Object(g.jsx)(w,{onClick:n,size:25})]}),Object(g.jsxs)("div",{className:"part-2",children:[!o&&Object(g.jsx)("p",{className:"searching",children:"SEARCHING FOR FRIENDS"}),o&&!o.some((function(e){return e.username.toLowerCase().includes(v.toLowerCase())}))&&Object(g.jsx)("p",{className:"searching",children:"NO RESULTS WERE FOUND"}),o&&o.map((function(e){var n=new Oe(e);return v&&!n.username.toLowerCase().includes(v.toLowerCase())?null:Object(g.jsxs)("div",{className:"invite-friend",children:[Object(g.jsx)("img",{alt:n.id,width:"34",height:"34",src:n.displayAvatarURL(80)}),Object(g.jsx)("h5",{children:n.username}),Object(g.jsx)("button",{className:"".concat(b.includes(n.id)&&"invited"),onClick:function(){b.includes(n.id)||(m((function(e){return[].concat(Object(j.a)(e),[n.id])})),fetch("".concat(d.a,"dm/").concat(n.id),{method:"POST",headers:{Authorization:C.token,"Content-Type":"application/json"},body:JSON.stringify({content:"server/"+t.invites[0]})}).catch(console.error))},children:b.includes(n.id)?"Sent":"Invite"})]},n.id)}))]}),Object(g.jsxs)("div",{className:"part-3",children:[Object(g.jsx)("h4",{children:"OR, SEND A SERVER INVITE LINK TO A FRIEND"}),Object(g.jsxs)("div",{children:[Object(g.jsx)("button",{className:"".concat(y?"copied":"copy"),onClick:function(){return navigator.clipboard.writeText("server/"+t.invites[0]).then((function(){k(!0),setTimeout((function(){return k(!1)}),5e3)}))},children:y?"Copied":"Copy"}),Object(g.jsx)("input",{readOnly:!0,value:"server/"+t.invites[0]})]})]})]})}),Se=function(e){return new Promise((function(t,n){var c=new FileReader;c.readAsDataURL(e),c.onload=function(){var e=new Image;e.onload=function(){return t(c.result)},e.src=c.result},c.onerror=function(e){return n(e)}}))},Ee=function(e){var t=e.server,n=e.animation,s=e.quit,a=Object(c.useState)(t.displayIcon(100,100)),r=Object(i.a)(a,2),o=r[0],j=r[1],h=Object(c.useState)(""),b=Object(i.a)(h,2),m=b[0],f=b[1],O=Object(c.useContext)(qe).user,v=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.target.files[0],e.next=3,Se(n).catch((function(){return 0}));case 3:(c=e.sent)&&j(c);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(g.jsx)("div",{className:"dark-div ".concat(n),children:Object(g.jsx)(D.Out,{click:s,children:Object(g.jsxs)("div",{className:"edit-server ".concat(n),children:[Object(g.jsxs)("div",{className:"server-edit-icon",children:[Object(g.jsx)("img",{height:"100",width:"100",src:o,alt:"icon"}),Object(g.jsx)("label",{className:"upload-button",htmlFor:"xx3",children:"Upload Image"}),Object(g.jsx)("input",{id:"xx3",name:"upload",className:"upload-file",onChange:v,type:"file"})]}),Object(g.jsxs)("div",{className:"server-info",children:[Object(g.jsx)("h3",{children:"Edit Server"}),Object(g.jsx)("label",{htmlFor:"bruh",children:"SERVER NAME"}),Object(g.jsx)("input",{className:"change-server-name",onChange:function(e){return f(e.target.value)},name:"bruh",defaultValue:t.name}),Object(g.jsx)("button",{onClick:function(){fetch("".concat(d.a,"server/").concat(t.id),{method:"PATCH",body:JSON.stringify({icon:o,name:m}),headers:{"Content-Type":"application/json",Authorization:O.token}})},children:"Save"})]})]})})})},Ae=function(e){var t=e.server,n=e.quit,s=Object(c.useContext)(qe).user,a=Object(c.useState)({name:"",type:"text"}),r=Object(i.a)(a,2),o=r[0],j=r[1],h=Object(c.useState)(""),b=Object(i.a)(h,2),m=b[0],f=b[1],O=function(){f("self-smaller"),setTimeout((function(){return n()}),100)},v=function(){var e=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o.name){e.next=2;break}return e.abrupt("return");case 2:return f("waiting"),e.next=5,fetch("".concat(d.a,"servers/").concat(t.id,"/channels"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:s.token},body:JSON.stringify(o)});case 5:O();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(g.jsx)(M,{children:Object(g.jsxs)("div",{className:"invite-people-div animated-popup ".concat(m),children:[Object(g.jsxs)("div",{style:{textAlign:"center"},className:"part-1",children:[Object(g.jsx)("h3",{style:{fontSize:"20px",marginTop:30},children:"Create Text Channel"}),Object(g.jsx)(w,{onClick:O,size:25})]}),Object(g.jsxs)("div",{className:"check-boxes",children:[Object(g.jsx)("h5",{children:"CHANNEL TYPE"}),Object(g.jsxs)("div",{className:"check",children:[Object(g.jsx)("div",{className:"checker"}),Object(g.jsx)(G,{size:28}),Object(g.jsxs)("div",{className:"channel-type",children:[Object(g.jsx)("h4",{children:"Text Channel"}),Object(g.jsx)("p",{children:"Post images, GIFs, opinions and puns"})]})]}),Object(g.jsx)("h5",{children:"CHANNEL NAME"}),Object(g.jsx)("input",{onChange:function(e){return j((function(t){return{name:e.target.value,type:t.type}}))},style:{marginTop:0,height:35},className:"change-server-name"})]}),Object(g.jsxs)("div",{className:"lower-section",children:[Object(g.jsx)("button",{onClick:O,className:"generic-button cancel",children:"Cancel"}),Object(g.jsx)("button",{onClick:v,className:"generic-button success ".concat(!o.name&&"cant-click"),children:"Create Channel"})]})]})})},Le=function(e){var t,n=e.user,s=e.server,a=e.onJoin,r=Object(c.useContext)(qe).setView,o=new Oe(n),j=Object(c.useState)(),h=Object(i.a)(j,2),b=h[0],m=h[1],O=Object(c.useState)(),v=Object(i.a)(O,2),x=v[0],N=v[1],y=Object(c.useState)([]),k=Object(i.a)(y,2),S=k[0],E=k[1],A=Object(c.useState)([]),L=Object(i.a)(A,2),T=L[0],z=L[1];Object(c.useLayoutEffect)((function(){var e=!0;N();try{var t=new Ne(s.channels[0],s);t&&m(t)}catch(a){var n=new Ne({name:"unknown"});N([]),m(n)}E([]);var c=function(e){return f.memberOnline(E,e)};return s.fetchMembers("no-cache").then((function(t){e&&(E(t),Ke.on("online",c))})),function(){Ke.off("online",c),e=!1}}),[s,o.token]),Object(c.useLayoutEffect)((function(){if(b&&(null===b||void 0===b?void 0:b.id)){var e=!0;p.channels[b.id]||N(),b.join(Ke,o.token),b.fetchMessages(o.token).then((function(t){e&&N(t)}));var t=function(t){e&&t.author._id!==o.id&&b.id===t.channel&&f.message(N,t)},n=function(t){e&&t.channel===b.id&&f.messageDelete(N,t)},c=function(e){return e.channel===b.id&&f.messageEdit(N,e)},s=function(e){return f.memberUpdate(E,N,e)};return Ke.on("message",t),Ke.on("messageDelete",n),Ke.on("messageEdit",c),Ke.on("memberUpdate",s),function(){e=!1,Ke.off("message",t).off("messageDelete",n).off("memberUpdate",s).off("messageEdit",c)}}}),[b,o.id,o.token]);var I=function(e){e.data&&z([e])},U=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(t.target.files[0]).catch((function(){return 0}));case 2:c=e.sent,I({data:c,fileName:null===(n=t.target.files[0])||void 0===n?void 0:n.name}),t.target.value="";case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,c,s,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.clipboardData.items,s=null===(n=c[1])||void 0===n?void 0:n.getAsFile(),e.next=4,ce(s).catch((function(){return 0}));case 4:a=e.sent,I({data:a,fileName:null===s||void 0===s?void 0:s.name});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,c,s,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.stopPropagation(),t.preventDefault(),c=t.dataTransfer.items,s=null===(n=c[0])||void 0===n?void 0:n.getAsFile(),e.next=6,ce(s).catch((function(){return 0}));case 6:a=e.sent,I({data:a,fileName:null===s||void 0===s?void 0:s.name});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=Object(c.useState)(),V=Object(i.a)(B,2),H=V[0],J=V[1];Object(c.useLayoutEffect)((function(){x||p.channels[null===b||void 0===b?void 0:b.id]?J():J(Object(g.jsx)(C,{}))}),[x,b]);var q=Object(c.useState)(),K=Object(i.a)(q,2),W=K[0],X=K[1],Z=function(){X(!1);var e=function(){r(Object(g.jsx)(t,{animation:"smaller"})),setTimeout((function(){return r()}),100)},t=function(t){var n=t.animation;return Object(g.jsx)("div",{className:"dark-div ".concat(n),children:Object(g.jsx)(D.Out,{click:e,children:Object(g.jsx)(Ce,{animation:n,quit:e,server:s})})})};r(Object(g.jsx)(t,{animation:"bigger"}))},$=function(){fetch("".concat(d.a,"leave/").concat(s.id),{method:"PATCH",headers:{Authorization:o.token}})},Q=function(){X(!1),r(Object(g.jsx)(Ae,{server:s,quit:function(){return r()},animation:"bigger"}))},te=function(){X(!1);r(Object(g.jsx)(Ee,{server:s,quit:function e(){r(Object(g.jsx)(Ee,{server:s,quit:e,animation:"smaller"})),setTimeout((function(){return r()}),100)},animation:"bigger"}))};return Object(g.jsxs)("main",{onDragOver:function(e){return e.preventDefault()},onDrop:F,className:"flexible-container",children:[Object(g.jsxs)("section",{className:"left-part",children:[Object(g.jsxs)("header",{onClick:function(){X(!0),r(Object(g.jsx)(M,{quit:function(){return X(!1)},normal:!0,type:1,children:Object(g.jsxs)("div",{className:"server-menu animated-popup",children:[s.owner===n._id&&Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("p",{onClick:te,children:"Server Settings"}),Object(g.jsx)("p",{onClick:Q,children:"Create Channel"})]}),Object(g.jsx)("p",{onClick:Z,className:"invite-people",children:"Invite People"}),s.owner!==n._id&&Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("div",{className:"separator"}),Object(g.jsx)("p",{onClick:$,className:"leave-server",children:"Leave Server"})]})]})}))},className:"server-name ".concat(W&&"server-name-2"),children:[Object(g.jsx)("span",{children:s.name}),Object(g.jsx)(ke,{size:"23"})]}),W,Object(g.jsxs)("div",{className:"channels",children:[Object(g.jsx)("div",{style:{marginBottom:10}}),Object(g.jsx)("h4",{className:"direct-messages",children:"TEXT CHANNELS"}),Ne.LoadChannels((null===s||void 0===s?void 0:s.channels)||[],s,(function(e){b.id!==e.id&&m(e)}))]}),Object(g.jsx)(P,{setView:r})]}),Object(g.jsxs)("section",{className:"messages",children:[Object(g.jsx)("div",{className:"name",children:null===b||void 0===b?void 0:b.toTitle()}),Object(g.jsxs)("div",{className:"messages-main",children:[Object(g.jsxs)("div",{className:"chat",children:[H,Object(g.jsxs)("ul",{className:"fetched-messages",children:[Object(g.jsxs)("div",{className:"dm-start",children:[Object(g.jsx)("div",{className:"dm-avatar channel-icon",children:Object(g.jsx)(G,{size:"50"})}),Object(g.jsx)("h3",{className:"dm-username",children:null===b||void 0===b?void 0:b.name}),Object(g.jsxs)("p",{className:"dumb-text-2",children:["This is the start of ",Object(g.jsxs)("span",{children:["#",null===b||void 0===b?void 0:b.name]})," message history."]})]}),x&&Object(g.jsx)(Y,{server:s,onJoin:a,me:n,messages:x,setView:r,setMessages:N})]})]}),Object(g.jsx)("form",{onSubmit:function(e){return e.preventDefault()},className:"send-message",children:Object(g.jsx)("div",{className:"controll",children:Object(g.jsxs)("div",{className:"message-manager",children:[Object(g.jsx)("ul",{className:"attachment-list ".concat(T.length&&"has-children"),children:Object(g.jsx)(ne,{setAttachments:z,attachments:T})}),Object(g.jsxs)("div",{className:"text-content",children:[Object(g.jsx)("div",{className:"file",children:Object(g.jsxs)("button",{className:"attach-file",children:[Object(g.jsx)("input",{type:"file",onChange:U}),Object(g.jsx)(w,{size:10})]})}),Object(g.jsx)(R,{renderId:null===b||void 0===b?void 0:b.id,placeholder:"Send a message to ".concat(null===b||void 0===b?void 0:b.name),onPaste:_,onKeyDown:function(e){return ee(e,n,b,N,T,z)}})]})]})})})]}),Object(g.jsxs)("div",{className:"users",children:[0===S.length&&Object(g.jsx)("div",{style:{marginTop:20},children:Object(g.jsx)(we,{times:(null===s||void 0===s||null===(t=s.members)||void 0===t?void 0:t.length)||10})}),Object(g.jsx)(Oe.MapMembers,{me:n,setView:r,members:S,server:s})]})]})]})},Re=n(45);var Te=function(){return Object(g.jsxs)("svg",{width:"36",height:"36",version:"1.1",id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 24 24",children:[Object(g.jsxs)("linearGradient",{id:"svg-gradient",gradientUnits:"userSpaceOnUse",x1:"2.8461",y1:"11.7055",x2:"22.1588",y2:"11.7055",children:[Object(g.jsx)("stop",{offset:"0",style:{stopColor:"var(--purple-no-gradient)"}}),Object(g.jsx)("stop",{offset:"1",style:{stopColor:"var(--blue)"}})]}),Object(g.jsx)("path",{className:"st0",d:"M12.5,7.1l-6.9,5.7c0,0,0,0,0,0c0,0,0,0,0,0v5.7c0,0.2,0.1,0.4,0.2,0.5c0.2,0.2,0.3,0.2,0.5,0.2H11v-4.6H14v4.6\r h4.6c0.2,0,0.4-0.1,0.5-0.2c0.2-0.2,0.2-0.3,0.2-0.5v-5.7c0,0,0-0.1,0-0.1L12.5,7.1z M22,11.5l-2.6-2.2V4.4c0-0.1,0-0.2-0.1-0.3\r c-0.1-0.1-0.2-0.1-0.3-0.1h-2.3c-0.1,0-0.2,0-0.3,0.1c-0.1,0.1-0.1,0.2-0.1,0.3v2.3l-2.9-2.4C13.2,4.1,12.9,4,12.5,4\r c-0.4,0-0.7,0.1-0.9,0.3L3,11.5c-0.1,0.1-0.1,0.1-0.1,0.3c0,0.1,0,0.2,0.1,0.3l0.7,0.9C3.7,13,3.8,13,3.9,13.1c0.1,0,0.2,0,0.3-0.1\r l8.3-6.9l8.3,6.9c0.1,0.1,0.1,0.1,0.3,0.1h0c0.1,0,0.2-0.1,0.3-0.1l0.7-0.9c0.1-0.1,0.1-0.2,0.1-0.3C22.1,11.7,22.1,11.6,22,11.5z"})]})},De=(n(98),function(e){var t=e.view,n=e.onCreate,s=e.user,a=Object(c.useState)(""),r=Object(i.a)(a,2),o=r[0],j=r[1],h=function(e){return new Promise((function(t,n){var c=new FileReader;c.readAsDataURL(e),c.onload=function(){return t(c.result)},c.onerror=function(e){return n(e)}}))},b=function(){var e="".concat(s.username,"'s server"),a=Object(c.useState)(e),r=Object(i.a)(a,2),o=r[0],b=r[1],m=Object(c.useState)(""),f=Object(i.a)(m,2),O=f[0],v=f[1],x=Object(c.useState)("bigger"),p=Object(i.a)(x,2),N=p[0],y=p[1],k=function(){var e=Object(u.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h(t.target.files[0]).then((function(e){return v(e)})).catch(console.log);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){j(""),y("self-smaller"),setTimeout((function(){return t()}),100)},S=function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(d.a,"servers"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:s.token},body:JSON.stringify({icon:O,name:o})}).then((function(e){return e.json()}));case 2:t=e.sent,C(),null===n||void 0===n||n(t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(g.jsx)(M,{quit:function(){return j("")},children:Object(g.jsxs)("div",{className:"creator animated-popup ".concat(N),children:[Object(g.jsxs)("div",{className:"view-server",children:[Object(g.jsx)(w,{onClick:C,size:25}),Object(g.jsx)("h2",{children:"Create a new Server"}),Object(g.jsx)("p",{className:"dummy-text",children:"Create a new Server, customize it! Invite your friends to it. And have a good time."}),Object(g.jsxs)("div",{className:"selector",children:[Object(g.jsx)("img",{className:"my-icon",alt:"",src:O}),Object(g.jsx)("input",{onChange:k,className:"select-icon",type:"file"})]})]}),Object(g.jsx)("label",{htmlFor:"server",children:"SERVER NAME"}),Object(g.jsx)("input",{required:!0,name:"server",defaultValue:e,onChange:function(e){return b(e.target.value)},className:"select-server-name"}),Object(g.jsxs)("div",{style:{backgroundColor:"rgb(231, 239, 247)"},className:"lower-section",children:[Object(g.jsx)("button",{style:{color:"black",marginRight:"auto",marginLeft:0},onClick:C,className:"generic-button cancel",children:"Back"}),Object(g.jsx)("button",{onClick:S,className:"generic-button primary",children:"Create"})]})]})})};return Object(g.jsxs)("div",{className:"server-block ".concat(o),children:[Object(g.jsx)("div",{onClick:function(){j("clicked"),t(Object(g.jsx)(b,{}))},className:"server",children:Object(g.jsx)("div",{title:"Add a Server",className:"add-server",children:Object(g.jsx)(w,{size:23})})}),Object(g.jsx)("div",{className:"server-marker"})]})}),Me=(n(99),function(e){var t=e.src,n=e.onChange,s=Object(c.useRef)(),a=Object(c.useRef)(),r={x:0,y:0},o=Object(c.useState)([0,0,1]),l=Object(i.a)(o,2),u=l[0],d=l[1],j=Object(c.useMemo)((function(){return{width:568,height:361}}),[]),h=Object(c.useMemo)((function(){return[0,0]}),[]),b=!1,m=function(){return(a.current.value/100+10)*u[2]*.7};Object(c.useEffect)((function(){var e=!0,c=new Image,r=s.current;return c.onload=function(){var t=Math.min(c.width,c.height),s=t/j.height;r.height=j.height*s,r.width=j.width*s,e&&d([c.width/s,c.height/s,s]);var i=r.getContext("2d");!function e(){if(r&&a.current){var s=a.current.value/100,o=c.width-c.width*s,l=c.height-c.height*s,u=t/2,d=c.width/2-u,j=c.height/2-u,b=Math.min(h[0],d+c.width*(s-1)),m=-1*b<d?b:-1*d;h[0]=m;var f=Math.min(h[1],j+c.height*(s-1)),O=-1*f<j?f:-1*j;h[1]=O;var v=[o+m+(r.width-c.width)/2,l+O+(r.height-c.height)/2];i.clearRect(0,0,r.width,r.height),i.beginPath(),i.drawImage(c,v[0],v[1],c.width*s+1,c.height*s+1),n(r),requestAnimationFrame(e)}}()},c.src=t,function(){return e=!1}}),[t,h,n,j]);var f=function(){return b=!1};return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("div",{className:"cropper",children:[Object(g.jsx)("canvas",{style:Object(y.a)({background:"black"},j),onMouseOut:f,onMouseUp:f,onMouseDown:function(){return b=!0},onMouseMove:function(e){b&&(e.clientX>r.x&&(h[0]+=m()),e.clientX<r.x&&(h[0]-=m()),e.clientY>r.y&&(h[1]+=m()),e.clientY<r.y&&(h[1]-=m()),r.y=e.clientY,r.x=e.clientX)},ref:s}),Object(g.jsx)("div",{style:{width:Math.min(u[0],u[1]),height:Math.min(u[0],u[1])},className:"circle-border"})]}),Object(g.jsx)("input",{className:"zoom-range",defaultValue:100,ref:a,max:200,min:100,type:"range"})]})}),ze=(n(100),function(e){var t=e.src,n=e.onComplete,s=e.cancel,a=Object(c.useState)(),r=Object(i.a)(a,2),o=r[0],l=r[1];return Object(g.jsx)(M,{children:Object(g.jsxs)("div",{className:"edit-image animated-popup",children:[Object(g.jsx)("h2",{children:"Edit Image"}),Object(g.jsx)(Me,{style:{maxHeight:400,maxWidth:400},onChange:l,src:t}),Object(g.jsxs)("div",{className:"lower-section",children:[Object(g.jsx)("button",{style:{marginLeft:10},onClick:function(){return n(t)},className:"skip generic-button cancel",children:"Skip"}),Object(g.jsx)("button",{style:{marginLeft:"auto"},onClick:s,className:"edit-image-cancel generic-button cancel",children:"Cancel"}),Object(g.jsx)("button",{style:{marginRight:1},onClick:function(){n(o.toDataURL("image/webp"))},className:"edit-image-complete generic-button primary",children:"Apply"})]})]})})}),Ie=function(e){for(var t=window.atob(e.split(",")[1]),n=new Array(t.length),c=0;c<t.length;c++)n[c]=t.charCodeAt(c);var s=new Uint8Array(n);return 71===s[0]&&73===s[1]&&70===s[2]&&56===s[3]},Ue=(n(101),function(e){return new Promise((function(t,n){var c=new FileReader;c.readAsDataURL(e),c.onload=function(){var e=new Image;e.onload=function(){return t(c.result)},e.src=c.result},c.onerror=function(e){return n(e)}}))}),_e=function(e){var t=e.user,n=e.onChange,s=Object(c.useContext)(qe).setView,a=Object(c.useState)(t.username),r=Object(i.a)(a,2),o=r[0],l=r[1];return Object(g.jsx)(M,{children:Object(g.jsxs)("div",{style:{width:450,overflow:"hidden",borderRadius:5},className:"edit-username generic-popup animated-popup",children:[Object(g.jsx)("h2",{style:{marginBottom:"0.5em"},children:"Change your username"}),Object(g.jsx)("span",{style:{color:"var(--font-secondary)",marginBottom:"0.6em"},className:"dumb-text-2",children:"Enter a new username and your current password"}),Object(g.jsxs)("form",{style:{display:"flex",flexDirection:"column",width:"100%"},children:[Object(g.jsxs)("div",{className:"content-wrapper",children:[Object(g.jsx)("label",{className:"generic-label",htmlFor:"new-username",children:"USERNAME"}),Object(g.jsx)("input",{onChange:function(e){return l(e.target.value)},autoComplete:"off",style:{marginBottom:"0.8em"},type:"text",defaultValue:t.username,id:"new-username",className:"new-username generic-input"}),Object(g.jsx)("label",{className:"generic-label",htmlFor:"current-password",children:"PASSWORD"}),Object(g.jsx)("input",{autoComplete:"off",type:"password",id:"current-password",className:"generic-input current-password"})]}),Object(g.jsxs)("div",{className:"lower-section",children:[Object(g.jsx)("button",{onClick:function(){return s()},type:"button",className:"generic-button cancel",children:"Cancel"}),Object(g.jsx)("button",{onClick:function(e){e.preventDefault(),n((function(e){return Object.assign({},e,{username:o})})),s()},type:"submit",className:"generic-button primary",children:"Done"})]})]})]})})},Fe=function(e){var t=e.user,n=e.setButton,s=e.onChange,a=e.changes,r=Object(c.useContext)(qe).setView;return Object(g.jsxs)("div",{className:"my-account",children:[Object(g.jsx)("h2",{className:"my-account-header",children:"My Account"}),Object(g.jsxs)("div",{className:"my-settings",children:[Object(g.jsx)("div",{style:{backgroundColor:t.profileColor},className:"profile-color"}),Object(g.jsxs)("div",{className:"section-17",children:[Object(g.jsxs)("div",{className:"section-721",children:[Object(g.jsx)("div",{className:"my-avatar-wrapper",children:Object(g.jsx)(F,{status:"online",size:80,src:t.displayAvatarURL(90)})}),Object(g.jsx)("h5",{className:"username-382",children:a.username||t.username}),Object(g.jsx)("button",{onClick:n(1),style:{marginLeft:"auto"},className:"generic-button primary button-121",children:"Edit User Profile"})]}),Object(g.jsxs)("div",{className:"section-832",children:[Object(g.jsxs)("div",{className:"username-77 flex-line",children:[Object(g.jsxs)("div",{children:[Object(g.jsx)("h5",{className:"field-title",children:"USERNAME"}),Object(g.jsxs)("div",{className:"div-410",children:[Object(g.jsx)("span",{children:a.username||t.username}),Object(g.jsx)("span",{className:"text-info",children:t.tag})]})]}),Object(g.jsx)("button",{onClick:function(){return r(Object(g.jsx)(_e,{onChange:s,user:t}))},style:{color:"var(--font-primary)",marginLeft:"auto"},className:"generic-button secondary",children:"Edit"})]}),Object(g.jsx)("div",{className:"email-10 flex-line",children:Object(g.jsxs)("div",{children:[Object(g.jsx)("h5",{className:"field-title",children:"EMAIL"}),Object(g.jsx)("div",{className:"div-410",children:t.email})]})}),Object(g.jsx)("div",{className:"phone-number-47 flex-line",children:Object(g.jsxs)("div",{children:[Object(g.jsx)("h5",{className:"field-title",children:"PHONE NUMBER"}),Object(g.jsx)("div",{className:"text-info",children:"This app doesn't support phone numbers"})]})})]})]})]})]})},Pe=function(e){var t=e.user,n=e.onChange,s=e.changes,a=Object(c.useContext)(qe),r=a.setView,o=a.user,d=Object(c.useState)(t.displayAvatarURL(90)),j=Object(i.a)(d,2),h=j[0],b=j[1],m=Object(c.useState)(t.profileColor),f=Object(i.a)(m,2),O=f[0],v=f[1],x=Object(c.useRef)(),p=Object(c.useRef)(),N=function(){var e=Object(u.a)(l.a.mark((function e(c){var s,a,i,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=c.target.files[0],e.next=3,Ue(s).catch((function(){return 0}));case 3:if(a=e.sent,c.target.value="",a){e.next=7;break}return e.abrupt("return");case 7:if(!Ie(a)){e.next=10;break}return n((function(e){return Object.assign({},e,{src:a})})),e.abrupt("return",b(a));case 10:a&&(i=function(e){r(),b(e),n((function(t){return Object.assign({},t,{src:e})}))},o=function(){r(),b(t.displayAvatarURL(150))},r(Object(g.jsx)(ze,{src:a,cancel:o,onComplete:i})));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){var e=new Oe(o);s.src||b(e.displayAvatarURL(80)),s.profileColor||v(e.profileColor)}),[s,o]);return Object(g.jsxs)("div",{className:"user-profile",children:[Object(g.jsx)("h2",{className:"my-account-header",children:"User Profile"}),Object(g.jsxs)("div",{className:"section-559",children:[Object(g.jsxs)("div",{className:"section-560",children:[Object(g.jsxs)("div",{className:"section-700",children:[Object(g.jsx)("h5",{className:"preview-2",children:"AVATAR"}),Object(g.jsx)("button",{onClick:function(){var e;return null===(e=x.current)||void 0===e?void 0:e.click()},style:{marginLeft:0},className:"generic-button primary",children:"Change Avatar"})]}),Object(g.jsxs)("div",{className:"user-color",children:[Object(g.jsx)("h5",{className:"preview-2",children:"PROFILE COLOR"}),Object(g.jsxs)("div",{className:"profile-color-selector",children:[Object(g.jsxs)("div",{className:"profile-color-option",children:[Object(g.jsx)("div",{onClick:function(){return n((function(e){return Object.assign({},e,{profileColor:"#000"})}))},className:"default-profileColor"}),Object(g.jsx)("span",{children:"Default"})]}),Object(g.jsxs)("div",{className:"profile-color-option",children:[Object(g.jsx)("div",{onClick:function(){var e;return null===(e=p.current)||void 0===e?void 0:e.click()},style:{backgroundColor:O},className:"custom-profileColor",children:Object(g.jsx)("input",{defaultValue:t.profileColor,onChange:function(e){v(e.target.value),n((function(t){return Object.assign({},t,{profileColor:e.target.value})}))},ref:p,style:{visibility:"hidden"},type:"color"})}),Object(g.jsx)("span",{children:"Custom"})]})]})]})]}),Object(g.jsxs)("div",{className:"section-561",children:[Object(g.jsx)("h5",{className:"preview-2",children:"PREVIEW"}),Object(g.jsx)(be,{onClick:function(){var e;return null===(e=x.current)||void 0===e?void 0:e.click()},editable:!0,style:{position:"relative",animation:"none"},user:Object.assign({},t,{displayAvatarURL:function(){return h},profileColor:O})})]}),Object(g.jsx)("input",{accept:"image/gif,image/png,image/jpeg,image/webp",style:{display:"none"},ref:x,onChange:N,type:"file"})]})]})},Be=function(){var e=Object(c.useContext)(qe).setTheme,t=Object(c.useState)(localStorage.getItem("theme")||"light"),n=Object(i.a)(t,2),s=n[0],a=n[1],r=function(t){return function(){e(t),localStorage.setItem("theme",t),a(t)}};return Object(g.jsxs)("div",{children:[Object(g.jsx)("h2",{className:"my-account-header",children:"Appearance"}),Object(g.jsx)("h5",{className:"preview-2",children:"THEME"}),Object(g.jsxs)("div",{className:"check-list",children:[Object(g.jsxs)("div",{className:"check",onClick:r("dark"),children:[Object(g.jsx)("div",{className:"checker ".concat("dark"!==s&&"unchecked")}),Object(g.jsx)("h5",{className:"generic-header-5",children:"Dark"})]}),Object(g.jsxs)("div",{className:"check",onClick:r("light"),children:[Object(g.jsx)("div",{className:"checker ".concat("light"!==s&&"unchecked")}),Object(g.jsx)("h5",{className:"generic-header-5",children:"Light"})]})]})]})},Ve=function(e){var t=e.componentId,n=e.user,c=e.setButton,s=e.onChange,a=e.changes;switch(t){case 0:return Object(g.jsx)(Fe,{changes:a,onChange:s,setButton:c,user:n});case 1:return Object(g.jsx)(Pe,{changes:a,onChange:s,user:n});case 2:return Object(g.jsx)(Be,{});default:return null}},He=function(){var e=Object(c.useContext)(qe),t=e.setShowSettings,n=e.setUser,s=e.user,a=Object(c.useMemo)((function(){return new Oe(s)}),[s]),r=Object(c.useState)({}),o=Object(i.a)(r,2),l=o[0],u=o[1],d=Object(c.useState)(0),j=Object(i.a)(d,2),h=j[0],b=j[1],m=Object(c.useState)(""),f=Object(i.a)(m,2),O=f[0],v=f[1],x=Object(c.useContext)(Ze),p=function(e){return function(){return!Object.keys(l).length&&b(e)}},N=function(e){return"generic-button ".concat(e===h&&"clicked")};return Object(g.jsxs)("div",{className:"settings ".concat(O),children:[Object(g.jsx)("div",{className:"settings-left",children:Object(g.jsx)("div",{className:"scrollable-content",children:Object(g.jsx)("nav",{className:"navigate-settings",children:Object(g.jsxs)("div",{children:[Object(g.jsx)("h5",{className:"generic-label header-82",children:"USER SETTINGS"}),Object(g.jsx)("button",{onClick:p(0),className:N(0),children:"My Account"}),Object(g.jsx)("button",{onClick:p(1),className:N(1),children:"User Profile"}),Object(g.jsx)("div",{className:"seperator"}),Object(g.jsx)("h5",{className:"generic-label header-82",children:"APP SETTINGS"}),Object(g.jsx)("button",{onClick:p(2),className:N(2),children:"Appearance"}),Object(g.jsx)("button",{onClick:function(){return x(Object(g.jsx)(Xe,{update:x}))},className:"generic-button error",children:"Logout"})]})})})}),Object(g.jsxs)("div",{className:"main-content",children:[Object(g.jsxs)("div",{className:"parameters",children:[Object(g.jsx)(Ve,{changes:l,onChange:u,setButton:p,componentId:h,user:a}),Object(g.jsx)("div",{className:"edit-check",children:Object(g.jsx)("div",{style:{overflow:"hidden"},children:Object(g.jsxs)("div",{className:"confirm-edit ".concat(!!Object.keys(l).length&&"is-edited"),children:[Object(g.jsx)("span",{className:"dumb-text",children:"Careful - you have unsaved changes!"}),Object(g.jsx)("button",{onClick:function(){return u({})},className:"reset generic-button cancel",children:"Reset"}),Object(g.jsx)("button",{className:"generic-button success",onClick:function(){Object.keys(l).length&&a.edit(l.username,l.src,l.profileColor).then((function(e){n(Object.assign({},a,e)),u({})}))},children:"Save Changes"})]})})})]}),Object(g.jsx)("div",{onClick:function(){v("is-being-removed"),t(""),setTimeout((function(){return t(!1)}),140)},className:"return",children:Object(g.jsx)(w,{size:17})})]})]})},Je=function(){return Object(g.jsxs)("svg",{style:{position:"absolute",zIndex:-1e3},children:[Object(g.jsxs)("mask",{viewBox:"0 0 1 1",maskContentUnits:"objectBoundingBox",id:"mask-round-80",children:[Object(g.jsx)("circle",{fill:"white",cx:"0.5",cy:"0.5",r:"0.5"}),Object(g.jsx)("circle",{fill:"black",cx:"0.85",cy:"0.85",r:"0.175"})]}),Object(g.jsxs)("mask",{viewBox:"0 0 1 1",maskContentUnits:"objectBoundingBox",id:"mask-round-32",children:[Object(g.jsx)("circle",{fill:"white",cx:"0.5",cy:"0.5",r:"0.5"}),Object(g.jsx)("circle",{fill:"black",cx:"0.85",cy:"0.85",r:"0.250"})]}),Object(g.jsxs)("mask",{viewBox:"0 0 1 1",maskContentUnits:"objectBoundingBox",id:"mask-round-120",children:[Object(g.jsx)("circle",{fill:"white",cx:"0.5",cy:"0.5",r:"0.5"}),Object(g.jsx)("circle",{fill:"black",cx:"0.8333",cy:"0.8333",r:"0.1666666666"})]})]})},qe=Object(c.createContext)(),Ke=Object(Re.io)(d.a,{transports:["websocket","polling","flashsocket"]}),We=new Audio("./notification.mp3"),Ye=function(e){var t,n=e.user,s=e.update,a=e.dm,r=Object(c.useState)(!1),o=Object(i.a)(r,2),l=o[0],u=o[1],d=Object(c.useState)(n),h=Object(i.a)(d,2),b=h[0],m=h[1],f=Object(c.useState)(),O=Object(i.a)(f,2),v=O[0],x=O[1];null===(t=b.notifications)||void 0===t||t.forEach((function(e){return e.saved=!0}));var y=Object(c.useState)(b.notifications||[]),w=Object(i.a)(y,2),k=w[0],C=w[1],S=Object(c.useState)(b.servers),E=Object(i.a)(S,2),A=E[0],L=E[1];Object(c.useEffect)((function(){Ke.connect(),Ke.emit("online",n.token),Ke.on("disconnect",(function(){s(Object(g.jsx)(Xe,{update:s}))})),Ke.on("notification",(function(e){We.play(),"dm"===e.type&&C((function(t){return[].concat(Object(j.a)(t),[e])}))})),Ke.on("leave",(function(e){x(),m((function(t){return Object.assign(t,{servers:Object(j.a)(t.servers).filter((function(t){return t._id!=="".concat(e._id)}))})})),L((function(t){return Object(j.a)(t).filter((function(t){return t._id!=="".concat(e._id)}))}))})),Ke.on("channelCreate",(function(e){L((function(t){var n=Object(j.a)(t);return n.find((function(t){return t._id===e.server})).channels.push(e),n}))}));var e=p.init();return function(){e(),Ke.off("disconnect").off("notification").off("channelCreate"),Ke.disconnect(),p.clear()}}),[n,s]);var R=Object(c.useState)(localStorage.getItem("theme")||"light"),T=Object(i.a)(R,2),D=T[0],M=T[1],z=Object(c.useState)(Object(g.jsx)(le,{user:b,update:s})),I=Object(i.a)(z,2),U=I[0],_=I[1],F=function(e,t){e.servers.push(t),L(e.servers);var n=new N(t,e);x(n)},P=function(e){return F(b,e)},B=Object(c.useState)(),V=Object(i.a)(B,2),H=V[0],J=V[1];Object(c.useEffect)((function(){var e=function(e){return F(b,e)};return _(v?Object(g.jsx)(Le,{socket:Ke,onJoin:e,update:s,server:v,user:b}):Object(g.jsx)(le,{onJoin:e,dm:a,user:b,update:s})),Ke.on("serverUpdate",(function(e){L((function(t){var n=Object(j.a)(t),c=n.find((function(t){return t._id===e._id.toString()}));return c.icon=e.icon,c.name=e.name,n}))})),function(){return Ke.off("serverUpdate")}}),[v,s,b,a]);var q={setScreen:_,setServer:x,setUser:m,not:[k,C],user:b,setTheme:M,setView:J,setShowSettings:u};return Object(g.jsxs)(qe.Provider,{value:q,children:[Object(g.jsxs)("div",{className:"platform ".concat(l&&"is-showing-settings"," ").concat(D),children:[H,(l||""===l)&&Object(g.jsx)(He,{user:new Oe(b)}),Object(g.jsxs)("div",{className:"screen",children:[Object(g.jsxs)("nav",{className:"navigate",children:[Object(g.jsxs)("div",{style:{marginTop:10,marginBottom:3},className:"server-block ".concat(!v&&"clicked"),children:[Object(g.jsx)("div",{title:"Home",className:"server",children:Object(g.jsx)("div",{onClick:function(){return v&&x()},className:"home-button server-icon ".concat(!v&&"isclicked"),children:Object(g.jsx)(Te,{})})}),Object(g.jsx)("div",{className:"server-marker"})]}),k.map((function(e,t){var n=new Oe(e.user);if(k.findIndex((function(e){return e.user._id===n.id}))!==t)return null;return Object(g.jsxs)("div",{className:"server-block",children:[Object(g.jsxs)("div",{className:"server nt ".concat(!e.saved&&"nta"),children:[Object(g.jsx)("img",{onClick:function(){x(),_(Object(g.jsx)(le,{onJoin:function(e){return P(b)},update:s,dm:{user:n},user:b}))},width:"48",height:"48",alt:"icon",src:n.displayAvatarURL(90),className:"server-icon"}),Object(g.jsx)("div",{className:"notification",children:k.filter((function(e){return e.user._id===n.id})).length})]}),Object(g.jsx)("div",{className:"server-marker"})]},n.id)})),Object(g.jsx)("div",{className:"border-bottom"}),Object(g.jsx)(N.LoadServers,{index:function(){var e=b.servers.find((function(e){return e._id===(null===v||void 0===v?void 0:v.id)}));return b.servers.indexOf(e)}(),me:b,servers:A,click:function(e){(null===v||void 0===v?void 0:v.id)!==e.id&&x(e)},isHome:!v}),Object(g.jsx)(De,{user:b,onCreate:P,view:J})]}),U]})]}),Object(g.jsx)(Je,{})]})};var Ge=function(e){var t=e.update,n=Object(c.useState)(""),s=Object(i.a)(n,2),a=s[0],r=s[1],o=Object(c.useState)(""),j=Object(i.a)(o,2),h=j[0],b=j[1],m=Object(c.useRef)(),f=Object(c.useRef)(),O=Object(c.useRef)(),v=Object(c.useRef)();return Object(g.jsxs)("div",{className:"login signup ".concat(a),children:[Object(g.jsx)("h2",{className:"login-text signup-text",children:"Create an account"}),Object(g.jsxs)("form",{name:"sign-up",children:[Object(g.jsx)("input",{autoComplete:"off",ref:m,className:"login-input username",placeholder:"Username"}),Object(g.jsx)("input",{autoComplete:"email",ref:O,className:"login-input signup-email",placeholder:"Email"}),Object(g.jsx)("input",{autoComplete:"off",ref:f,className:"login-input signup-password",type:"password",placeholder:"Password"}),Object(g.jsx)("input",{autoComplete:"off",type:"password",ref:v,className:"login-input confirm",placeholder:"Confirm password"}),Object(g.jsxs)("p",{className:"no-account",children:["Already have an account? ",Object(g.jsx)("span",{onClick:function(){r("shrink-me"),setTimeout((function(){return t(Object(g.jsx)(Xe,{update:t}))}),200)},children:"login"})]}),Object(g.jsx)("button",{onClick:function(e){e.preventDefault();var n=f.current.value,c=O.current.value;if(f.current.value!==v.current.value)return b("Passwords don't match");fetch("".concat(d.a,"createuser"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:m.current.value,email:c,password:n})}).then((function(e){return e.json()})).catch((function(e){console.log(e),b("Error")})).then(function(){var e=Object(u.a)(l.a.mark((function e(s){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!s.error){e.next=2;break}return e.abrupt("return",b(s.error));case 2:return e.next=4,fetch("".concat(d.a,"user?password=").concat(n,"&email=").concat(c)).then((function(e){return e.json()}));case 4:a=e.sent,t(Object(g.jsx)(Ye,{update:t,user:a}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},className:"button-login sign-up",children:"Create an account"})]}),Object(g.jsx)("p",{className:"error-message",children:h})]})};var Xe=function(){var e=Object(c.useState)(""),t=Object(i.a)(e,2),n=t[0],s=t[1],a=Object(c.useState)(""),r=Object(i.a)(a,2),o=r[0],l=r[1],u=Object(c.useContext)(Ze),j=Object(c.useRef)(),h=Object(c.useRef)();return Object(g.jsxs)("div",{className:"login ".concat(n),children:[Object(g.jsx)("h2",{className:"login-text",children:"Login to continue"}),Object(g.jsxs)("form",{name:"login",children:[Object(g.jsx)("input",{id:"email",ref:h,className:"login-input email",required:!0,autoComplete:"on",type:"email",placeholder:"Email"}),Object(g.jsx)("input",{id:"password",ref:j,autoComplete:"on",required:!0,className:"login-input password",type:"password",placeholder:"Password"}),Object(g.jsxs)("p",{className:"no-account",children:["Don't have an account? ",Object(g.jsx)("span",{onClick:function(){s("expand-me"),setTimeout((function(){return u(Object(g.jsx)(Ge,{update:u}))}),200)},children:"create one"})]}),Object(g.jsx)("button",{type:"submit",onClick:function(e){e.preventDefault(),j.current.value&&h.current.value&&(s("waiting"),fetch("".concat(d.a,"user?password=").concat(j.current.value,"&email=").concat(h.current.value)).then((function(e){return e.json()})).then((function(e){if(e.error)return l(e.error);s("expand-all"),setTimeout((function(){return u(Object(g.jsx)(Ye,{user:e,update:u}))}),300)})).catch((function(e){s(""),l(e.toString())})))},className:"button-login sign-up",children:"Login"})]}),Object(g.jsx)("p",{className:"error-message",children:o})]})},Ze=(n(102),Object(c.createContext)());var $e=function(){var e=Object(c.useState)(Object(g.jsx)(Xe,{})),t=Object(i.a)(e,2),n=t[0],s=t[1];return Object(g.jsx)(Ze.Provider,{value:s,children:Object(g.jsxs)("div",{className:"main",children:[Object(g.jsx)("a",{className:"github-link",href:"https://github.com/uwu404/discord-clone-client",children:"view source code"}),n]})})};r.a.createRoot(document.getElementById("root")).render(Object(g.jsx)($e,{}))},4:function(e){e.exports=JSON.parse('{"a":"https://discordbotyes.herokuapp.com/"}')},53:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){},58:function(e,t,n){},59:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){},63:function(e,t,n){},64:function(e,t,n){},65:function(e,t,n){},66:function(e,t,n){},67:function(e,t,n){},68:function(e,t,n){},98:function(e,t,n){},99:function(e,t,n){}},[[103,1,2]]]);
//# sourceMappingURL=main.e66abdc9.chunk.js.map